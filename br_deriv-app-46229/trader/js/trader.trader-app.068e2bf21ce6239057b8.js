(self.webpackChunk_deriv_trader=self.webpackChunk_deriv_trader||[]).push([["trader-app"],{"./App/Components/Animations/index.js":(t,e,r)=>{"use strict";r.d(e,{s:()=>c,o:()=>p});var o=r("../../../node_modules/prop-types/index.js"),n=r.n(o),i=r("react"),a=r("../../../node_modules/react-pose/dist/react-pose.es.js"),s=a.ZP.div({enter:{y:0,opacity:1,transition:{y:{type:"spring",stiffness:500,damping:15},default:{duration:300}}},exit:{y:35,opacity:0,transition:{duration:0}}}),c=function(t){var e=t.children,r=t.className,o=t.is_visible,n=t.keyname;return o?i.createElement(a.g5,null,i.createElement(s,{className:r,key:n},e)):null};c.propTypes={children:n().node,is_visible:n().bool,keyname:n().string};var l=a.ZP.div({enter:{y:0,opacity:1,transition:{duration:200}},exit:{y:-20,opacity:0,transition:{duration:100}}}),u=a.ZP.div({enter:{y:0,opacity:1,transition:{duration:200}},exit:{y:20,opacity:0,transition:{duration:100}}}),p=function(t){var e=t.children,r=t.className,o=t.keyname,n=t.is_visible;return"bottom"===t.type?i.createElement(a.g5,{flipMove:!1},n&&i.createElement(u,{className:r,key:o},e)):i.createElement(a.g5,{flipMove:!1},n&&i.createElement(l,{className:r,key:o},e))};p.propTypes={children:n().node,is_visible:n().bool,keyname:n().string,type:n().string}},"./App/Components/Elements/ContentLoader/index.js":(t,e,r)=>{"use strict";r.d(e,{rl:()=>s,Ro:()=>c,G_:()=>u});var o=r("../../../node_modules/react-content-loader/dist/react-content-loader.es.js"),n=r("react"),i=r("../../../node_modules/prop-types/index.js"),a=r.n(i),s=function(t){var e=t.speed;return n.createElement(o.ZP,{height:173,width:218,speed:e,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},n.createElement("rect",{x:"43",y:"19",rx:"0",ry:"0",width:"56",height:"8"}),n.createElement("rect",{x:"147",y:"19",rx:"0",ry:"0",width:"56",height:"8"}),n.createElement("rect",{x:"12",y:"50",rx:"0",ry:"0",width:"44",height:"8"}),n.createElement("rect",{x:"13",y:"68",rx:"0",ry:"0",width:"192",height:"8"}),n.createElement("rect",{x:"5",y:"89",rx:"0",ry:"0",width:"208",height:"1"}),n.createElement("rect",{x:"12",y:"104",rx:"0",ry:"0",width:"44",height:"8"}),n.createElement("rect",{x:"12",y:"9",rx:"0",ry:"0",width:"24",height:"24"}),n.createElement("rect",{x:"116",y:"11",rx:"0",ry:"0",width:"24",height:"24"}),n.createElement("rect",{x:"12",y:"118",rx:"0",ry:"0",width:"88",height:"8"}),n.createElement("rect",{x:"116",y:"104",rx:"0",ry:"0",width:"44",height:"8"}),n.createElement("rect",{x:"116",y:"118",rx:"0",ry:"0",width:"88",height:"8"}),n.createElement("rect",{x:"12",y:"139",rx:"0",ry:"0",width:"44",height:"8"}),n.createElement("rect",{x:"12",y:"153",rx:"0",ry:"0",width:"88",height:"8"}),n.createElement("rect",{x:"116",y:"139",rx:"0",ry:"0",width:"44",height:"8"}),n.createElement("rect",{x:"116",y:"153",rx:"0",ry:"0",width:"88",height:"8"}))};s.propTypes={speed:a().number};var c=function(t){var e=t.speed;return n.createElement(o.ZP,{height:64,width:992,speed:e,primaryColor:"var(--general-hover)",secondaryColor:"var(--general-active)"},n.createElement("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"32",height:"32"}),n.createElement("rect",{x:"52",y:"16",rx:"4",ry:"4",width:"32",height:"32"}),n.createElement("rect",{x:"132",y:"28",rx:"4",ry:"4",width:"101",height:"8"}),n.createElement("rect",{x:"273",y:"28",rx:"4",ry:"4",width:"120",height:"8"}),n.createElement("rect",{x:"460",y:"28",rx:"4",ry:"4",width:"46",height:"8"}),n.createElement("rect",{x:"593",y:"28",rx:"4",ry:"4",width:"46",height:"8"}),n.createElement("rect",{x:"726",y:"28",rx:"4",ry:"4",width:"64",height:"8"}),n.createElement("rect",{x:"906",y:"28",rx:"4",ry:"4",width:"64",height:"8"}))};c.propTypes={speed:a().number};var l=r("@deriv/components"),u=function(t){var e=t.speed;return n.createElement(n.Fragment,null,n.createElement(l.MobileWrapper,null,n.createElement(o.ZP,{height:214,width:344,speed:e,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},n.createElement("rect",{x:"148",y:"24",rx:"3",ry:"3",width:"40",height:"4"}),n.createElement("rect",{x:"8",y:"40",rx:"4",ry:"4",width:"328",height:"40"}),n.createElement("rect",{x:"8",y:"88",rx:"4",ry:"4",width:"328",height:"40"}),n.createElement("rect",{x:"8",y:"136",rx:"4",ry:"4",width:"160",height:"70"}),n.createElement("rect",{x:"176",y:"136",rx:"4",ry:"4",width:"160",height:"70"}))),n.createElement(l.DesktopWrapper,null,n.createElement(o.ZP,{height:548,width:240,speed:e,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},n.createElement("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"240",height:"76"}),n.createElement("rect",{x:"0",y:"84",rx:"4",ry:"4",width:"240",height:"132"}),n.createElement("rect",{x:"0",y:"224",rx:"4",ry:"4",width:"240",height:"120"}),n.createElement("rect",{x:"0",y:"352",rx:"4",ry:"4",width:"240",height:"194"}))))};u.propTypes={speed:a().number}},"./App/Components/Elements/PositionsDrawer/PositionsDrawerCard/positions-drawer-card.jsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>b});var o=r("../../../node_modules/classnames/index.js"),n=r.n(o),i=r("../../../node_modules/prop-types/index.js"),a=r.n(i),s=r("react"),c=r("react-router-dom"),l=r("@deriv/components"),u=r("@deriv/shared"),p=r("./Constants/contract.js"),d=r("./Stores/connect.js"),f=r("./Stores/Modules/Contract/Helpers/multiplier.js"),_=r("./Stores/Modules/Contract/Helpers/logic.js"),y=function(t){var e=t.addToast,r=t.className,o=t.display_name,i=t.contract_info,a=t.contract_update,d=t.currency,y=t.current_focus,b=t.getContractById,m=t.is_mobile,h=t.is_sell_requested,g=t.is_unsupported,v=t.is_link_disabled,w=t.profit_loss,O=t.onClickCancel,S=t.onClickSell,k=t.onClickRemove,P=t.onFooterEntered,E=t.onMouseEnter,C=t.onMouseLeave,x=t.removeToast,j=t.result,D=t.setCurrentFocus,T=t.server_time,A=t.should_show_transition,z=t.should_show_cancellation_warning,M=t.status,R=t.toggleCancellationWarning,L=t.toggleUnsupportedContractModal,I=(0,u.isMultiplierContract)(i.contract_type),N=(0,u.isCryptoContract)(i.underlying),U=!I||N&&I,F=!!(0,_.NQ)(i),B=s.createElement("div",{className:"dc-contract-card__content-loader"},s.createElement(l.ContractCard.Loader,{speed:2})),H=s.createElement(l.ContractCard.Header,{contract_info:i,display_name:o,getCardLabels:p.gk,getContractTypeDisplay:p.h8,has_progress_slider:!m&&U,is_mobile:m,is_positions:!0,is_sell_requested:h,onClickSell:S,server_time:T}),W=s.createElement(l.ContractCard.Body,{addToast:e,connectWithContractUpdate:f.tP,contract_info:i,contract_update:a,currency:d,current_focus:y,getCardLabels:p.gk,getContractById:b,onMouseLeave:function(){"function"==typeof C&&C()},is_mobile:m,is_multiplier:I,is_sold:F,has_progress_slider:m&&U,removeToast:x,server_time:T,setCurrentFocus:D,should_show_cancellation_warning:z,status:M,toggleCancellationWarning:R}),V=s.createElement(l.ContractCard.Footer,{contract_info:i,getCardLabels:p.gk,is_multiplier:I,is_positions:!0,is_sell_requested:h,onClickCancel:O,onClickSell:S,onFooterEntered:P,server_time:T,should_show_transition:A}),G=s.createElement(s.Fragment,null,H,W);return s.createElement(l.ContractCard,{contract_info:i,getCardLabels:p.gk,getContractPath:u.getContractPath,is_multiplier:I,is_positions:!0,is_unsupported:g,onClickRemove:k,profit_loss:w,result:j,should_show_result_overlay:!0,toggleUnsupportedContractModal:L},s.createElement("div",{id:"dc_contract_card_".concat(i.contract_id),className:r,onMouseEnter:function(){"function"==typeof E&&E()},onMouseLeave:function(){"function"==typeof C&&C()},onClick:function(){"function"==typeof C&&C()}},g?s.createElement("div",{className:n()("dc-contract-card",{"dc-contract-card--green":!I&&w>0&&!j,"dc-contract-card--red":!I&&w<0&&!j}),onClick:function(){return L(!0)}},i.underlying?G:B):v?s.createElement("div",{className:n()("dc-contract-card",{"dc-contract-card--green":!I&&w>0&&!j,"dc-contract-card--red":!I&&w<0&&!j})},i.underlying?G:B):s.createElement(c.NavLink,{className:n()("dc-contract-card",{"dc-contract-card--green":!I&&w>0&&!j,"dc-contract-card--red":!I&&w<0&&!j}),to:{pathname:"/contract/".concat(i.contract_id),state:{}}},i.underlying?G:B),V))};y.propTypes={addToast:a().func,className:a().string,contract_info:a().object,currency:a().string,current_focus:a().string,current_tick:a().number,duration:a().oneOfType([a().number,a().string]),duration_unit:a().string,exit_spot:a().oneOfType([a().number,a().string]),id:a().number,indicative:a().number,is_loading:a().bool,is_mobile:a().bool,is_sell_requested:a().bool,is_unsupported:a().bool,is_valid_to_sell:a().oneOfType([a().number,a().bool]),onClickRemove:a().func,onClickSell:a().func,onClickCancel:a().func,profit_loss:a().number,result:a().string,sell_time:a().number,setCurrentFocus:a().func,status:a().string,toggleUnsupportedContractModal:a().func,type:a().string};const b=(0,d.$j)((function(t){var e=t.modules,r=t.ui,o=t.client,n=t.common;return{currency:o.currency,server_time:n.server_time,addToast:r.addToast,current_focus:r.current_focus,onClickCancel:e.portfolio.onClickCancel,onClickSell:e.portfolio.onClickSell,onClickRemove:e.portfolio.removePositionById,getContractById:e.contract_trade.getContractById,is_mobile:r.is_mobile,removeToast:r.removeToast,setCurrentFocus:r.setCurrentFocus,should_show_cancellation_warning:r.should_show_cancellation_warning,toggleCancellationWarning:r.toggleCancellationWarning,toggleUnsupportedContractModal:r.toggleUnsupportedContractModal}}))(y)},"./App/Components/Elements/PositionsDrawer/helpers/index.js":(t,e,r)=>{"use strict";r.d(e,{Ew:()=>s,_M:()=>d,Bs:()=>c,rh:()=>l,qm:()=>u});var o=r("@deriv/translations"),n=r("@deriv/shared"),i=r("./Stores/Modules/Trading/Constants/contract.js"),a=r("./Stores/Modules/Contract/Helpers/contract-type.js"),s=function(t,e){if(!t||isNaN(t))return t;var r=String(e?(+t).toFixed(e):t),o=r.indexOf(".");return r.replace(/\d(?=(?:\d{3})+(?:\.|$))/g,(function(t,e){return o<=0||e<o?"".concat(t,","):t}))},c=function(t){return u(t.contract_type)?(0,o.localize)("Target"):(0,o.localize)("Barrier")},l=function(t){return u(t.contract_type)?p(t)[t.contract_type]:s(t.barrier)},u=function(t){return/digit/.test(t.toLowerCase())},p=function(t){return{DIGITDIFF:(0,o.localize)("Not {{barrier}}",{barrier:t.barrier}),DIGITEVEN:(0,o.localize)("Even"),DIGITMATCH:(0,o.localize)("Equals {{barrier}}",{barrier:t.barrier}),DIGITODD:(0,o.localize)("Odd"),DIGITOVER:(0,o.localize)("Over {{barrier}}",{barrier:t.barrier}),DIGITUNDER:(0,o.localize)("Under {{barrier}}",{barrier:t.barrier})}},d=function(t,e){var r,o=t.contract_type,s=t.shortcode,c=(0,a.a)(e),l=(0,n.isHighLow)({shortcode:s}),u=c?["CALL","CALLE","PUT","PUTE"]:null===(r=(0,i.r2)()[e])||void 0===r?void 0:r.trade_types,p=null==u?void 0:u.includes(o);return"high_low"===e?l:p&&!l}},"./App/Components/Elements/chart-loader.jsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>d});var o=r("../../../node_modules/prop-types/index.js"),n=r.n(o),i=r("react"),a=r("../../../node_modules/classnames/index.js"),s=r.n(a),c=r("@deriv/components"),l=function(t){var e=t.className,r=t.id,o=t.is_fullscreen,n=void 0===o||o,a=t.is_slow_loading,l=t.status,u=t.theme,p=u?"barspinner-".concat(u):"barspinner-light";return i.createElement("div",{className:s()("initial-loader",{"initial-loader--fullscreen":n},e)},i.createElement("div",{id:r,className:s()("initial-loader__barspinner","barspinner",p)},Array.from(new Array(5)).map((function(t,e){return i.createElement("div",{key:e,className:"initial-loader__barspinner--rect barspinner__rect barspinner__rect--".concat(e+1," rect").concat(e+1)})}))),a&&l.map((function(t,e){return i.createElement(c.Text,{as:"h3",color:"prominent",size:"xs",align:"center",key:e},t)})))};l.propTypes={id:n().oneOfType([n().string,n().number]),is_slow_loading:n().bool,status:n().array,theme:n().string};const u=l;var p=function(t){var e=t.is_dark;return t.is_visible?i.createElement("div",{className:"chart-container__loader"},i.createElement(u,{theme:e?"dark":"light"})):null};p.propTypes={is_dark:n().bool,is_visible:n().bool};const d=p},"./App/Components/Elements/market-countdown-timer.jsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>S});var o=r("../../../node_modules/classnames/index.js"),n=r.n(o),i=r("react"),a=r("../../../node_modules/prop-types/index.js"),s=r.n(a),c=r("../../../node_modules/moment/moment.js"),l=r.n(c),u=r("@deriv/components"),p=r("@deriv/shared"),d=r("@deriv/translations"),f=r("./Stores/connect.js"),_=r("./Stores/Modules/Trading/Helpers/active-symbols.js");function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function m(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){m(i,o,n,a,s,"next",t)}function s(t){m(i,o,n,a,s,"throw",t)}a(void 0)}))}}var g=function(){var t=h(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.WS.tradingTimes(e);case 2:if(!(r=t.sent).error){t.next=5;break}return t.abrupt("return",{api_initial_load_error:r.error.message});case 5:return t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(t,e){for(var r,o=e.markets,n=0;n<o.length;n++)for(var i=o[n].submarkets,a=0;a<i.length;a++)if(void 0!==(r=i[a].symbols.find((function(e){return e.symbol===t}))))return r},w=function(t){var e=t-Date.now();return e>0?{days:Math.floor(e/864e5),hours:Math.floor(e/36e5%24),minutes:Math.floor(e/1e3/60%60),seconds:Math.floor(e/1e3%60)}:{}},O=function(t){var e=t.active_symbols,r=t.is_main_page,o=t.setIsTimerLoading,a=t.onMarketOpen,s=t.symbol,c=(0,p.useIsMounted)(),f=y(i.useState({}),2),b=f[0],m=f[1],O=y(i.useState(w(null==b?void 0:b.remaining_time_to_open)),2),S=O[0],k=O[1],P=y(i.useState(!0),2),E=P[0],C=P[1];i.useEffect((function(){if(!r||r&&(0,_.pp)(e,s)){C(!0);var t=function(){var e=h(regeneratorRuntime.mark((function e(r,o){var n,i,a,u,p,d,f,_,y,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r>7)){e.next=2;break}return e.abrupt("return",{});case 2:return i=l()(new Date).add(r,"days"),e.next=5,g(i.format("YYYY-MM-DD"));case 5:if((a=e.sent).api_initial_load_error){e.next=25;break}if(u=v(o,a.trading_times),p=u.times,d=p.open,f=p.close,1!==(null==d?void 0:d.length)||"--"!==d[0]||"--"!==f[0]){e.next=12;break}return e.abrupt("return",t(r+1,o));case 12:_=i.toISOString().substring(0,11),y=function(t){return new Date("".concat(_).concat(t,"Z"))},b=0;case 15:if(!(b<(null==d?void 0:d.length))){e.next=24;break}if(!(+y(d[b])-Date.now()>0)){e.next=21;break}if(n=+y(d[b]),!c()||o!==s){e.next=21;break}return e.abrupt("return",m({days_offset:r,opening_time:d[b],remaining_time_to_open:n}));case 21:b++,e.next=15;break;case 24:t(r+1,o);case 25:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t(0,s)}}),[s]),i.useEffect((function(){var t;return null!=b&&b.remaining_time_to_open&&(t=setTimeout((function(){k(w(b.remaining_time_to_open)),new Date(b.remaining_time_to_open)-+new Date<1e3&&(C(!0),r&&a(!1))}),1e3)),function(){t&&clearTimeout(t)}}),[S,b]),i.useEffect((function(){E||o(!1)}),[E]);var x="";if(Object.keys(S).length){var j=(24*S.days+S.hours).toString().padStart(2,"0"),D=S.minutes.toString().padStart(2,"0"),T=S.seconds.toString().padStart(2,"0");x="".concat(j,":").concat(D,":").concat(T)}if(!b||!x)return null;var A=b.opening_time,z=b.days_offset,M=null;if(A){var R=(0,p.convertTimeFormat)(A),L=l()(new Date).add(z,"days"),I=L.format("DD MMM YYYY"),N=L.format("dddd");M=i.createElement(u.Text,{align:"center",as:"p",className:"market-is-closed-overlay__open-date",line_height:"m",color:"prominent",size:r?"s":"xs",weight:"bold"},i.createElement(d.Localize,{i18n_default_text:"{{formatted_opening_time}} (GMT) on {{opening_day}},<0></0> {{opening_date}}.",components:[i.createElement("div",{key:0})],values:{formatted_opening_time:R,opening_day:N,opening_date:I}}))}return E&&C(!1),i.createElement(i.Fragment,null,i.createElement(u.Text,{as:"p",className:n()("market-is-closed-overlay__open-at",{"market-is-closed-overlay__open-at--main-page":r}),line_height:"x",size:r?"xs":"xxs"},i.createElement(d.Localize,{i18n_default_text:"It will reopen at"})),M,i.createElement(u.Text,{align:"center",as:"p",className:n()("market-is-closed-overlay__come-back",{"market-is-closed-overlay__come-back--main-page":r}),line_height:"x",size:r?"xs":"xxs"},i.createElement(d.Localize,{i18n_default_text:"Please come back in"})),i.createElement(u.Text,{as:"p",className:n()("market-is-closed-overlay__timer",{"market-is-closed-overlay__timer--main-page":r}),line_height:"m",color:"prominent",size:r?"s":"xs",weight:"bold"},x),i.createElement("div",{className:"market-is-closed-overlay__separator"}))};O.propTypes={is_main_page:s().bool,setIsTimerLoading:s().func,onMarketOpen:s().func,symbol:s().string.isRequired};const S=(0,f.$j)((function(t){return{active_symbols:t.modules.trade.active_symbols}}))(O)},"./App/Components/Routes/helpers.js":(t,e,r)=>{"use strict";r.d(e,{AH:()=>i,U_:()=>a,uT:()=>s});var o=r("react-router"),n=r("@deriv/shared"),i=function(t){return/^\//.test(t)?t:"/".concat(t||"")},a=function t(e,r){var n;return r.some((function(r){var i;try{i=(0,o.matchPath)(e,r)}catch(t){if(/undefined/.test(t.message))return}return i?(n=r,!0):!!r.routes&&(n=t(e,r.routes))})),n},s=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(t,r){return t.replace(":".concat(r),e[r])}),t)}(n.routes.contract,{contract_id:t})}},"./App/app.jsx":(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>ep});var o=r("../../../node_modules/prop-types/index.js"),n=r.n(o),i=r("react"),a=r("../../../node_modules/react-loadable/lib/index.js"),s=r.n(a),c=r("mobx-react"),l=r("react-router"),u=r("@deriv/components"),p=r("@deriv/shared"),d=r("react-router-dom"),f=r("./App/Components/Routes/helpers.js"),_=r("@deriv/translations"),y=r("./App/Components/Elements/chart-loader.jsx"),b=r("./Modules/Trading/Helpers/digits.js"),m=r("./Stores/connect.js"),h=r("../../../node_modules/classnames/index.js"),g=r.n(h),v=r("../../../node_modules/react-transition-group/esm/CSSTransition.js");const w=function(t){var e=t.error;return i.createElement("div",{className:"portfolio-empty"},i.createElement("div",{className:"portfolio-empty__wrapper"},e?i.createElement(u.Text,{color:"disabled",size:"xs"},e):i.createElement(i.Fragment,null,i.createElement(u.Icon,{icon:"IcPortfolio",className:"portfolio-empty__icon",size:96,color:"disabled"}),i.createElement(u.Text,{color:"disabled",size:"xs"},(0,_.localize)("No open positions")))))};var O=r("./Stores/Modules/Trading/Constants/contract.js"),S=r("./Stores/Modules/Contract/Helpers/contract-type.js"),k=r("./App/Components/Elements/PositionsDrawer/helpers/index.js"),P=r("./App/Components/Elements/PositionsDrawer/PositionsDrawerCard/positions-drawer-card.jsx");function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function j(t,e){return j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},j(t,e)}function D(t,e){return!e||"object"!==E(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function A(){return A=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},A.apply(this,arguments)}var z=function(t){var e=t.row,r=t.measure,o=t.onHoverPosition,n=t.is_new_row,a=(0,p.useNewRowTransition)(n).in_prop;return i.useEffect((function(){r()}),[e.contract_info.is_sold,r]),i.createElement(v.Z,{in:a,timeout:150,classNames:{appear:"dc-contract-card__wrapper--enter",enter:"dc-contract-card__wrapper--enter",enterDone:"dc-contract-card__wrapper--enter-done",exit:"dc-contract-card__wrapper--exit"},onEntered:r,unmountOnExit:!0},i.createElement("div",{className:"dc-contract-card__wrapper"},i.createElement(P.Z,A({},e,{onMouseEnter:function(){o(!0,e)},onMouseLeave:function(){o(!1,e)},onFooterEntered:r,should_show_transition:n}))))},M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(n,t);var e,r,o=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=T(t);if(e){var n=T(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return D(this,r)}}(n);function n(){var t;C(this,n);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=o.call.apply(o,[this].concat(r))).state={},t.filterByContractType=function(e){var r,o=e.contract_type,n=e.shortcode,i=t.props.trade_contract_type,a=(0,S.a)(i),s=(0,p.isHighLow)({shortcode:n}),c=a?["CALL","CALLE","PUT","PUTE"]:null===(r=(0,O.r2)()[i])||void 0===r?void 0:r.trade_types,l=null==c?void 0:c.includes(o);return"high_low"===i?s:l&&!s},t}return e=n,(r=[{key:"componentDidMount",value:function(){this.props.onMount()}},{key:"componentWillReceiveProps",value:function(t){(this.props.symbol&&t.symbol!==this.props.symbol||this.props.trade_contract_type&&t.trade_contract_type!==this.props.trade_contract_type)&&this.list_ref&&this.scrollbar_ref&&(this.list_ref.scrollTo(0),this.scrollbar_ref.scrollToTop())}},{key:"componentWillUnmount",value:function(){this.props.onUnmount()}},{key:"render",value:function(){var t=this,e=this.props,r=e.all_positions,o=e.error,n=e.is_positions_drawer_on,a=e.onHoverPosition,s=e.symbol,c=e.toggleDrawer,l=e.trade_contract_type;this.positions=r.filter((function(t){return t.contract_info&&s===t.contract_info.underlying&&(0,k._M)(t.contract_info,l)}));var f=i.createElement(u.DataList,{data_source:this.positions,rowRenderer:function(t){return i.createElement(z,A({onHoverPosition:a},t))},keyMapper:function(t){return t.id},row_gap:8});return i.createElement(i.Fragment,null,i.createElement("div",{className:g()("positions-drawer__bg",{"positions-drawer__bg--open":n})}),i.createElement("div",{id:"dt_positions_drawer",className:g()("positions-drawer",{"positions-drawer--open":n})},i.createElement("div",{className:"positions-drawer__header"},i.createElement(u.Text,{color:"prominent",weight:"bold",size:"xs"},(0,_.localize)("Recent positions")),i.createElement("div",{id:"dt_positions_drawer_close_icon",className:"positions-drawer__icon-close",onClick:c},i.createElement(u.Icon,{icon:"IcMinusBold"}))),i.createElement("div",{className:"positions-drawer__body",ref:function(e){t.drawer_ref=e}},0===this.positions.length||o?i.createElement(w,{error:o}):f),i.createElement("div",{className:"positions-drawer__footer"},i.createElement(d.NavLink,{id:"dt_positions_drawer_report_button",className:"dc-btn dc-btn--secondary dc-btn__large",to:p.routes.reports},i.createElement(u.Text,{size:"xs",weight:"bold"},(0,_.localize)("Go to Reports"))))))}}])&&x(e.prototype,r),n}(i.Component);M.propTypes={all_positions:c.PropTypes.arrayOrObservableArray,children:n().any,error:n().string,is_mobile:n().bool,is_positions_drawer_on:n().bool,onChangeContractUpdate:n().func,onClickContractUpdate:n().func,onMount:n().func,onUnmount:n().func,symbol:n().string,toggleDrawer:n().func};const R=(0,m.$j)((function(t){var e=t.modules,r=t.ui;return{all_positions:e.portfolio.all_positions,error:e.portfolio.error,onHoverPosition:e.portfolio.onHoverPosition,onMount:e.portfolio.onMount,onUnmount:e.portfolio.onUnmount,symbol:e.trade.symbol,trade_contract_type:e.trade.contract_type,is_mobile:r.is_mobile,is_positions_drawer_on:r.is_positions_drawer_on,toggleDrawer:r.togglePositionsDrawer}}))(M);var L=r("./App/Components/Elements/market-countdown-timer.jsx");function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var N=function(t){var e=t.is_eu,r=t.is_market_available,o=t.is_synthetics_available,n=t.onClick,a=t.onMarketOpen,s=t.symbol,c=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return I(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.useState(!0),2),l=c[0],p=c[1],d=i.createElement(_.Localize,{i18n_default_text:"In the meantime, try our synthetic indices. They simulate real-market volatility and are open 24/7."}),f=(0,_.localize)("Try Synthetic Indices");return o||(d=null,f=(0,_.localize)("See open markets")),i.createElement("div",{className:g()("market-is-closed-overlay",{"market-is-closed-overlay--loading":l})},i.createElement(u.Text,{as:"p",className:"market-is-closed-overlay__main-heading",color:"prominent",weight:"bold"},i.createElement(_.Localize,{i18n_default_text:"This market is closed"})),i.createElement(L.Z,{is_main_page:!0,setIsTimerLoading:p,onMarketOpen:a,symbol:s}),d&&i.createElement(u.Text,{align:"center",as:"p",className:"market-is-closed-overlay__main-message",size:"xs"},d),(!e||e&&r)&&i.createElement(u.Button,{className:"market-is-closed-overlay__button",onClick:n,text:f,primary:!0}))};N.propTypes={is_eu:n().bool,is_market_available:n().bool,is_synthetics_available:n().bool,onClick:n().func,onMarketOpen:n().func,symbol:n().string};const U=N;var F=r("mobx");function B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?B(Object(r),!0).forEach((function(e){W(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function W(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function G(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function X(t,e){return X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},X(t,e)}function J(t,e){return!e||"object"!==V(e)&&"function"!=typeof e?$(t):e}function $(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}var Q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(n,t);var e,r,o=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=K(t);if(e){var n=K(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return J(this,r)}}(n);function n(){var t;Y(this,n);for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return(t=o.call.apply(o,[this].concat(r))).state={is_visible:!1,store:"trade"},t.setVisibility=t.stateVisibility.bind($(t)),t.styles={container:{fontSize:"10px",lineHeight:"15px",position:"absolute",zIndex:1,background:"rgba(0, 0, 0, 0.8)",color:"#ccc",padding:"10px",marginTop:"-10px",display:"none",overflowY:"auto",height:"100%",width:"100%"},prop_name:{color:"yellowgreen"},tabs:{display:"flex",textAlign:"center",marginBottom:"10px"},tab:{fontSize:"18px",border:"1px solid grey",width:"100%",padding:"10px"}},t.componentDidMount=function(){document.addEventListener("keyup",t.setVisibility,!1)},t.componentWillUnmount=function(){document.removeEventListener("keyup",t.setVisibility)},t.renderStoreContent=function(e){var r=G(e,2),o=r[0],n=r[1];return"root_store"!==o&&"function"!=typeof n&&i.createElement("div",{key:o},i.createElement("span",{style:t.styles.prop_name},o,":")," ",n&&"object"===V(n)?JSON.stringify((0,F.toJS)(n),null,1):n)},t}return e=n,(r=[{key:"stateVisibility",value:function(t){t.ctrlKey&&83===t.keyCode&&this.setState({is_visible:!this.state.is_visible})}},{key:"render",value:function(){var t=this,e=this.styles,r=e.container,o=e.tab,n=e.tabs,a=this.state,s=a.is_visible,c=a.store;return i.createElement("code",{id:"state_info",style:H(H({},r),{},{display:s?"block":"none"})},i.createElement("div",{style:n},Object.keys(this.props).map((function(e){return i.createElement("p",{key:e,onClick:function(){return t.setState({store:e})},style:H(H({},o),{},{fontWeight:e===c&&"bold"})},e)}))),this.props[this.state.store].sort().map(this.renderStoreContent))}}])&&Z(e.prototype,r),n}(i.Component);Q.propTypes={entries:n().array};const tt=(0,m.$j)((function(t){var e=t.modules,r=t.client,o=t.ui;return{trade:Object.entries(e.trade),client:Object.entries(r),ui:Object.entries(o),portfolio:Object.entries(e.portfolio)}}))(Q);var et=r("./Modules/Contract/Components/Digits/index.js"),rt=r("./Modules/SmartChart/Components/bottom-widgets.jsx"),ot=r("./Modules/SmartChart/index.js"),nt=function(t){var e=t.updateChartType,r=t.updateGranularity;return i.createElement(i.Fragment,null,i.createElement(u.DesktopWrapper,null,i.createElement(ot.oY,{portalNodeId:"modal_root",onChartType:function(t){return e(t)},onGranularity:function(t){return r(t)}}),i.createElement(ot.as,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),i.createElement(ot.NU,{portalNodeId:"modal_root"}),i.createElement(ot.kO,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),i.createElement(ot.mB,{portalNodeId:"modal_root"})))};nt.propTypes={updateChartType:n().func,updateGranularity:n().func};const it=nt;var at=function(t){var e=t.position,r=t.updateChartType,o=t.updateGranularity;return i.createElement(ot.av,{position:e||(0,p.isMobile)()?"bottom":null},i.createElement(ot.oY,{portalNodeId:"modal_root",onChartType:r,onGranularity:o}),(0,p.isDesktop)()&&i.createElement(ot.as,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),(0,p.isDesktop)()&&i.createElement(ot.kO,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),(0,p.isDesktop)()&&i.createElement(ot.NU,{portalNodeId:"modal_root"}),(0,p.isDesktop)()&&i.createElement(ot.mB,{portalNodeId:"modal_root"}))};at.propTypes={position:n().string,updateChartType:n().func,updateGranularity:n().func};const st=at;var ct=r("./Modules/SmartChart/Components/top-widgets.jsx"),lt=function(t){return t&&function(e){t({target:{name:"symbol",value:e}})}},ut=(0,m.$j)((function(t){var e=t.modules;return{contract_info:e.contract_trade.last_contract.contract_info||{},digits_info:e.contract_trade.last_contract.digits_info||{},display_status:e.contract_trade.last_contract.display_status,is_digit_contract:e.contract_trade.last_contract.is_digit_contract,is_ended:e.contract_trade.last_contract.is_ended,selected_digit:e.trade.last_digit,onDigitChange:e.trade.onChange,underlying:e.trade.symbol,trade_type:e.trade.contract_type}}))((function(t){var e=t.contract_info,r=t.digits,o=t.digits_info,n=t.display_status,a=t.is_digit_contract,s=t.is_ended,c=t.onDigitChange,l=t.selected_digit,u=t.tick,p=t.trade_type,d=t.underlying;return i.createElement(et.Z,{contract_info:e,digits_array:r,digits_info:o,display_status:n,is_digit_contract:a,is_ended:s,onDigitChange:c,is_trade_page:!0,tick:u,trade_type:p,selected_digit:l,underlying:d})})),pt=(0,m.$j)((function(t){var e=t.modules,r=t.ui;return{onSymbolChange:e.trade.onChange,theme:r.is_dark_mode_on?"dark":"light"}}))((function(t){var e,r=t.onSymbolChange,o=t.charts_ref,n=t.theme,a=t.is_digits_widget_active,s=t.open_market,c=t.open;return o&&o.chart&&(e=o.chart.yAxiswidth),i.createElement(ct.Z,{open_market:s,open:c,is_mobile:(0,p.isMobile)(),is_digits_widget_active:a,onSymbolChange:lt(r),theme:n,y_axis_width:e})})),dt=(0,m.$j)((function(t){var e=t.modules;return{updateChartType:e.contract_trade.updateChartType,updateGranularity:e.contract_trade.updateGranularity}}))((function(t){var e=t.updateChartType,r=t.updateGranularity;return i.createElement(st,{updateChartType:e,updateGranularity:r})})),ft=function(t){var e=t.digits,r=t.tick;return i.createElement(rt.Z,{Digits:i.createElement(ut,{digits:e,tick:r})})},_t=((0,m.$j)((function(t){var e=t.modules;return{updateChartType:e.contract_trade.updateChartType,updateGranularity:e.contract_trade.updateGranularity}}))((function(t){var e=t.updateChartType,r=t.updateGranularity;return i.createElement(it,{updateChartType:e,updateGranularity:r})})),s()({loader:function(){return(0,p.isMobile)()?Promise.all([r.e("Modules_Trading_Components_Form_TradeParams_Multiplier_expiration_jsx-Modules_Trading_Compone-90e657"),r.e("screen-small")]).then(r.bind(r,"./Modules/Trading/Components/Form/screen-small.jsx")):Promise.all([r.e("Modules_Trading_Components_Form_TradeParams_Multiplier_expiration_jsx-Modules_Trading_Compone-90e657"),r.e("screen-large")]).then(r.bind(r,"./Modules/Trading/Components/Form/screen-large.jsx"))},loading:function(){return null},render:function(t,e){var r=t.default;return i.createElement(r,e)}})),yt=function(t){var e=t.is_market_closed,r=t.is_trade_enabled;return i.createElement(i.Fragment,null,i.createElement(_t,{is_trade_enabled:r,is_market_closed:(0,p.isMobile)()?void 0:e}))};yt.propTypes={is_market_closed:n().bool,is_trade_enabled:n().bool};const bt=i.memo(yt);var mt=function(t){if(!window.DOMParser)return null;var e=(new window.DOMParser).parseFromString(t,"image/svg+xml").children[0],r=e.attributes,o=r.width,n=r.height;o=1*o.value,n=1*n.value;var i=[];return[].forEach.call(e.children,(function(t){var e=t.attributes,r=e.d,o=e.fill,n=e.stroke;i.push({points:r.value.match(/M|C|H|A|L|V|-?\d*(\.\d+)?/g).filter((function(t){return t})).map((function(t){return-1==="MCHALV".indexOf(t)?1*t:t})),fill:o&&o.value,stroke:n&&n.value})})),{width:o,height:n,paths:i,with_color:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white";return{width:o,height:n,paths:i.map((function(r){var o=r.points,n=r.fill;return{points:o,stroke:r.stroke,fill:"white"!==n?t:e}}))}}}},ht=mt('\n<svg width="15" height="20" viewBox="0 0 15 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7,20 C11.2,14.4 14,10.8659932 14,7 C14,3.13400675 10.8659932,0 7,0 C3.13400675,0 0,3.13400675 0,7 C0,10.8659932 2.8,14.4 7,20 Z" fill="#333333"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="A7 7 4.2 0 6.283185307179586" fill="white" />\n</svg>'),gt=mt('\n<svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2 2L18 2L18 12L2 12Z" fill="white" />\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2,0 L2,1 L19,1 L19,12 L2,12 L2,20 L1,20 L1,0 L2,0 Z M18,8 L15,8 L15,11 L18,11 L18,8 Z M12,8 L9,8 L9,11 L12,11 L12,8 Z M6,8 L3,8 L3,11 L6,11 L6,8 Z M15,5 L12,5 L12,8 L15,8 L15,5 Z M9,5 L6,5 L6,8 L9,8 L9,5 Z M6,2 L3,2 L3,5 L6,5 L6,2 Z M18,2 L15,2 L15,5 L18,5 L18,2 Z M12,2 L9,2 L9,5 L12,5 L12,2 Z" fill="#333333"/>\n</svg>\n'),vt=["epoch_array","price_array"];function wt(t,e){return Et(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||kt(t,e)||St()}function Ot(t){return Et(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||kt(t)||St()}function St(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kt(t,e){if(t){if("string"==typeof t)return Pt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pt(t,e):void 0}}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Et(t){if(Array.isArray(t))return t}function Ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function xt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ct(Object(r),!0).forEach((function(e){jt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ct(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function jt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dt=navigator.userAgent.search("Firefox")>0,Tt=function(t){return function(e){var r=e.epoch_array,o=e.price_array,n=function(t,e){if(null==t)return{};var r,o,n=function(t,e){if(null==t)return{};var r,o,n={},i=Object.keys(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(e,vt);return i.createElement(ot.If,{epoch_array:r,price_array:o,draw_callback:function(e){return t(xt(xt({},e),n))}})}};function At(t){var e=t.status,r=t.profit,o=t.is_dark_theme?{open:"#377cfc",won:"#00a79e",lost:"#cc2e3d",sold:"#ffad3a",fg:"#ffffff",bg:"#0e0e0e"}:{open:"#377cfc",won:"#4bb4b3",lost:"#ec3f3f",sold:"#ffad3a",fg:"#333333",bg:"#ffffff"},n=o[e||"open"];return"open"===e&&r&&(n=o[r>0?"won":"lost"]),n}var zt=function(t){return t?Math.max(Math.min(Math.sqrt(t/18),1.2),.8):1},Mt=[],Rt=function(t,e){if(0===Mt.length)for(var r=255;r>=0;--r)Mt[r]=(r<16?"0":"")+r.toString(16);var o=Math.floor(255*Math.min(Math.max(e-t-10,0)/6,1));return Mt[o]},Lt=function(t,e){var r=e.zoom,o=e.top,n=e.left,i=e.icon;t.save();var a=zt(r);t.translate(n-i.width*a/2,o-i.height*a/2),t.scale(a,a),i.paths.forEach((function(e){var r,o,n=e.points,i=e.fill,a=e.stroke;i&&(t.fillStyle=i),a&&(t.strokeStyle=a),t.beginPath();for(var s=0;s<n.length;s++){var c=void 0,l=void 0,u=void 0,p=void 0,d=void 0,f=void 0,_=void 0;if("M"===n[s])c=n[++s],l=n[++s],t.moveTo(c,l);else if("L"===n[s])c=n[++s],l=n[++s],t.lineTo(c,l);else if("V"===n[s])l=n[++s],t.lineTo(r,l);else if("H"===n[s])c=n[++s],t.lineTo(c,o);else if("Q"===n[s])u=n[++s],d=n[++s],c=n[++s],l=n[++s],t.quadraticCurveTo(u,d,c,l);else if("C"===n[s])u=n[++s],d=n[++s],p=n[++s],f=n[++s],c=n[++s],l=n[++s],t.bezierCurveTo(u,d,p,f,c,l);else if("A"===n[s]){c=n[++s],l=n[++s],_=n[++s];var y=n[++s],b=n[++s];t.arc(c,l,_,y,b)}r=c,o=l}t.closePath(),i&&t.fill(),a&&t.stroke()})),t.scale(1,1),t.restore()},It=function(t){var e=t.ctx,r=t.text,o=t.tick,n=o.zoom,i=o.left,a=o.top,s=zt(n),c=Math.floor(3*s+7);e.font="".concat(c,"px Roboto"),r.split(/\n/).forEach((function(t,r){var o=Math.ceil(e.measureText(t).width);e.fillText(t,i-5-o,a+r*c+1)}))},Nt=function(t){var e=t.ctx,r=t.is_dark_theme,o=t.text,n=t.left,i=t.top,a=t.scale;e.textAlign="center";var s=Math.floor(12*a);e.font="bold ".concat(s,"px BinarySymbols, Roboto"),Dt||(e.shadowColor=r?"rgba(16,19,31,1)":"rgba(255,255,255,1)",e.shadowBlur=12);for(var c=0;c<(Dt?1:5);++c)e.fillText(o,n,i)},Ut=Tt((function(t){var e=t.ctx,r=t.canvas_height,o=Ot(t.points),n=o[0],i=o.slice(1),a=wt(t.prices,1)[0],s=t.is_last_contract,c=t.is_dark_theme,l=t.granularity,u=t.contract_info,p=u.status,d=u.profit,f=u.is_sold,_=u.is_expired,y=u.tick_count,b=e,m=At({is_dark_theme:c,status:p,profit:f?d:null});b.save(),b.strokeStyle=m,b.fillStyle=m;var h=s&&n.visible&&!f,g=zt(n.zoom),v=r/window.devicePixelRatio;if(a&&(a=Math.min(Math.max(a,2),v-32)),h&&(It({ctx:b,text:"Start\nTime",tick:{zom:n.zoom,left:n.left-1*g,top:v-50}}),b.beginPath(),b.setLineDash([3,3]),b.moveTo(n.left-1*g,0),i.length&&a&&(b.lineTo(n.left-1*g,a-34*g),b.moveTo(n.left-1*g,a+4*g)),b.lineTo(n.left-1*g,r),b.stroke()),i.length&&a){var w=i[0],O=i[i.length-1],S=f?Rt(n.left,O.left):"";(n.visible||w.visible||O.visible)&&(b.strokeStyle=m+S,b.beginPath(),b.setLineDash([1,1]),b.moveTo(n.left,a),b.lineTo(w.left,a),b.stroke(),b.beginPath(),b.setLineDash([]),b.moveTo(w.left,a),b.lineTo(O.left,a),b.stroke(),b.strokeStyle=m),s&&0===l&&!f&&(i.filter((function(t){return t.visible})).forEach((function(t){var e=t===O?m:At({status:"fg",is_dark_theme:c});b.fillStyle=e+S,b.beginPath(),b.arc(t.left-1*g,t.top,1.5*g,0,2*Math.PI),b.fill()})),b.fillStyle=m),0===l&&([w,_?O:null].forEach((function(t){t&&t.visible&&(b.strokeStyle=m+S,b.setLineDash([2,2]),b.beginPath(),b.moveTo(t.left-1*g,t.top),b.lineTo(t.left-1*g,a),b.stroke(),b.fillStyle=m+S,b.beginPath(),b.arc(t.left-1*g,t.top,3*g,0,2*Math.PI),b.fill(),t===w&&(b.beginPath(),b.fillStyle=At({status:"bg",is_dark_theme:c})+S,b.arc(t.left-1*g,t.top,2*g,0,2*Math.PI),b.fill()))})),b.strokeStyle=m,b.fillStyle=m),n.visible&&!f&&Nt({ctx:b,scale:g,is_dark_theme:c,text:"".concat(i.length-1,"/").concat(y),left:n.left,top:a-27*g}),n.visible&&Lt(b,{top:a-9*g,left:n.left-1*g,zoom:n.zoom,icon:ht.with_color(m+(f?S:""),At({status:"bg",is_dark_theme:c})+(f?S:""))}),O.visible&&f&&Lt(b,{top:a-9*g,left:O.left+8*g,zoom:O.zoom,icon:gt.with_color(m,At({status:"bg",is_dark_theme:c}))}),b.restore()}else b.restore()})),Ft={AUD:"A$",EUR:"€",GBP:"£",JPY:"¥",USD:"$",BTC:"₿",BCH:"",ETH:"E",ETC:"",LTC:"Ł",UST:"₮"},Bt=Tt((function(t){var e=t.ctx,r=t.canvas_height,o=wt(t.points,4),n=o[0],i=o[1],a=o[2],s=o[3],c=t.is_last_contract,l=wt(t.prices,3),u=l[0],d=l[1],f=l[2],_=t.is_dark_theme,y=t.granularity,b=t.currency,m=t.contract_info,h=m.is_sold,g=m.status,v=m.profit,w=e;0!==y&&(a&&(a.top=d),s&&(s.top=f));var O=At({status:g,profit:v,is_dark_theme:_});w.save(),w.strokeStyle=O,w.fillStyle=O;var S=c&&n.visible&&!h,k=c&&!h&&v&&n.visible&&u,P=zt(n.zoom),E=h?Rt(n.left,i.left):"",C=r/window.devicePixelRatio;if(u&&(u=Math.min(Math.max(u,2),C-32)),S&&(It({ctx:w,text:"Start\nTime",tick:{zom:n.zoom,left:n.left-1*P,top:C-50}}),w.beginPath(),w.setLineDash([3,3]),w.moveTo(n.left-1*P,0),u&&(w.lineTo(n.left-1*P,u-(k?38:20)*P),w.moveTo(n.left-1*P,u+4*P)),w.lineTo(n.left-1*P,r),w.stroke()),u&&a&&(n.visible||i.visible||Math.sign(n.left)!==Math.sign(i.left))&&(w.strokeStyle=O+E,w.beginPath(),w.setLineDash([1,1]),w.moveTo(n.left,u),w.lineTo(a.left,u),w.stroke(),w.beginPath(),w.setLineDash([]),w.moveTo(a.left,u),w.lineTo(i.left,u),w.stroke(),w.strokeStyle=O),[a,s].forEach((function(t){t&&t.visible&&(w.strokeStyle=O+E,w.setLineDash([2,2]),w.beginPath(),w.moveTo(t.left-1*P,t.top),w.lineTo(t.left-1*P,u),w.stroke(),w.fillStyle=O+E,w.beginPath(),w.arc(t.left-1*P,t.top,3*P,0,2*Math.PI),w.fill(),t===a&&(w.beginPath(),w.fillStyle=At({status:"bg",is_dark_theme:_})+E,w.arc(t.left-1*P,t.top,2*P,0,2*Math.PI),w.fill()),w.fillStyle=O,w.strokeStyle=O)})),n&&n.visible&&u&&Lt(w,{top:u-9*P,left:n.left-1*P,zoom:n.zoom,icon:ht.with_color(O+E)}),k){var x=Ft[b]||"",j=(0,p.getDecimalPlaces)(b),D="".concat(v<0?"-":v>0?"+":" ").concat(x).concat(Math.abs(v).toFixed(j));Nt({ctx:w,scale:P,text:D,is_dark_theme:_,left:n.left,top:u-28*P})}i.visible&&Lt(w,{top:u-9*P,left:i.left+8*P,zoom:i.zoom,icon:gt.with_color(O,At({status:"bg",is_dark_theme:_}))}),w.restore()}));const Ht={TickContract:Ut,NonTickContract:Bt,DigitContract:Tt((function(t){var e=t.ctx,r=Ot(t.points),o=r[0],n=r.slice(1),i=wt(t.prices,2),a=i[0],s=i[1],c=t.is_last_contract,l=t.is_dark_theme,u=t.granularity,p=t.contract_info,d=p.status,f=p.profit,_=p.is_sold,y=p.tick_stream,b=p.tick_count,m=e,h=At({is_dark_theme:l,status:d,profit:_?f:null});m.save(),m.strokeStyle=h,m.fillStyle=h;var g=c&&o.visible&&!_,v=zt(o.zoom);if(0!==u&&o&&a&&(o.top=a),g&&(m.beginPath(),m.setLineDash([3,3]),m.moveTo(o.left-1*v,0),n.length&&(m.lineTo(o.left-1*v,o.top-34*v),m.moveTo(o.left-1*v,o.top+4*v)),m.lineTo(o.left-1*v,m.canvas.height),m.stroke()),n.length){var w=n[n.length-1],O=_?Rt(o.left,w.left):"";0!==u&&w&&s&&(w.top=s),o.visible&&o.top&&!_&&Nt({ctx:m,scale:v,is_dark_theme:l,text:"".concat(n.length,"/").concat(b),left:o.left-1*v,top:o.top-27*v}),!o.visible||0!==u&&_||Lt(m,{top:o.top-9*v,left:o.left-1*v,zoom:o.zoom,icon:ht.with_color(h+O,At({status:"bg",is_dark_theme:l})+O)}),n.forEach((function(t,e){if(t===w&&t.visible&&(0===u||t===w)&&(0===u||t!==w||_)){var r=t!==w?At({status:"fg",is_dark_theme:l}):h;m.beginPath(),m.fillStyle=r,m.arc(t.left,t.top,7*v,0,2*Math.PI),m.fill(),m.beginPath(),m.fillStyle=_?h:At({status:"bg",is_dark_theme:l}),m.arc(t.left,t.top,6*v,0,2*Math.PI),m.fill();var o=y[e].tick_display_value.slice(-1);m.fillStyle=_?"white":r,m.textAlign="center",m.shadowBlur=0,m.font="bold ".concat(12*v,"px BinarySymbols, Roboto"),m.fillText(o,t.left,t.top)}})),w.visible&&_&&(m.fillStyle=h,Lt(m,{top:w.top-16*v,left:w.left+8*v,zoom:w.zoom,icon:gt.with_color(h,At({status:"bg",is_dark_theme:l}))})),m.restore()}else m.restore()}))};function Wt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vt(){return Vt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Vt.apply(this,arguments)}function Gt(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function qt(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Gt(i,o,n,a,s,"next",t)}function s(t){Gt(i,o,n,a,s,"throw",t)}a(void 0)}))}}function Yt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||Zt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zt(t,e){if(t){if("string"==typeof t)return Xt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xt(t,e):void 0}}function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var Jt=function(t){var e=t.tick,r=t.digits,o=t.setTick,n=t.setDigits;return i.useEffect((function(){o(e)}),[e]),i.useEffect((function(){n(r)}),[r]),null};const $t=(0,m.$j)((function(t){var e=t.client,r=t.common,o=t.modules,n=t.ui;return{getFirstOpenMarket:o.trade.getFirstOpenMarket,is_eu:e.is_eu,is_synthetics_available:o.trade.is_synthetics_available,network_status:r.network_status,contract_type:o.trade.contract_type,form_components:o.trade.form_components,should_show_active_symbols_loading:o.trade.should_show_active_symbols_loading,is_chart_loading:o.trade.is_chart_loading,is_market_closed:o.trade.is_market_closed,show_digits_stats:o.trade.show_digits_stats,is_trade_enabled:o.trade.is_trade_enabled,prepareTradeStore:o.trade.prepareTradeStore,setMobileDigitView:o.trade.setMobileDigitView,symbol:o.trade.symbol,onMount:o.trade.onMount,onUnmount:o.trade.onUnmount,purchase_info:o.trade.purchase_info,NotificationMessages:n.notification_messages_ui,is_market_unavailable_visible:n.has_only_forward_starting_contracts,should_show_multipliers_onboarding:n.should_show_multipliers_onboarding,onChange:o.trade.onChange,setContractTypes:o.trade.setContractTypes}}))((function(t){var e=t.contract_type,r=t.form_components,o=t.getFirstOpenMarket,n=t.should_show_active_symbols_loading,a=t.is_chart_loading,s=t.is_dark_theme,c=t.is_eu,l=t.is_market_closed,d=t.is_market_unavailable_visible,f=t.is_trade_enabled,_=t.network_status,m=t.NotificationMessages,h=t.onChange,g=t.onMount,v=t.onUnmount,w=t.prepareTradeStore,O=t.setContractTypes,S=t.setMobileDigitView,k=t.show_digits_stats,P=t.should_show_multipliers_onboarding,E=t.symbol,C=t.is_synthetics_available,x=Yt(i.useState([]),2),j=x[0],D=x[1],T=Yt(i.useState({}),2),A=T[0],z=T[1],M=Yt(i.useState(!1),2),L=M[0],I=M[1],N=Yt(i.useState(!1),2),F=N[0],B=N[1],H=Yt(i.useState(null),2),W=H[0],V=H[1],G=Yt(i.useState(null),2),q=G[0],Y=G[1],Z=Yt(i.useState(!1),2),X=Z[0],J=Z[1],$=i.useMemo((function(){return L?{category:"synthetic_index"}:F&&W?{category:W,subcategory:q}:null}),[L,F,W,q]);i.useEffect((function(){if(g(),!C){var t=function(){var t=qt(regeneratorRuntime.mark((function t(){var e,r,n,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=["forex","indices","commodities"],t.next=3,o(r);case 3:if(t.t1=e=t.sent,t.t0=null!==t.t1,!t.t0){t.next=7;break}t.t0=void 0!==e;case 7:if(!t.t0){t.next=11;break}t.t2=e,t.next=12;break;case 11:t.t2={};case 12:n=t.t2,i=n.category,a=n.subcategory,i&&(V(i),Y(a));case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}return function(){return v()}}),[g,v]),i.useEffect((function(){(0,p.isMobile)()&&D([]),I(!1),B(!1)}),[E,D,I]),i.useEffect((function(){var t=function(){var t=qt(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:h({target:{name:"contract_type",value:"multiplier"}});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();!P||a||!C&&l||t()}),[P,a]);var K=i.useCallback((function(t){var e=t.digits,r=t.tick;return i.createElement(Jt,{digits:e,tick:r,setTick:z,setDigits:D})}),[]),Q=function(){var t=qt(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:C?(I(!0),setTimeout((function(){return I(!1)}))):(B(!0),setTimeout((function(){return B(!1)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),et=(0,p.isMobile)()?"mobile-wrapper":"sidebar__container desktop-only";return i.createElement("div",{id:"trade_container",className:"trade-container"},i.createElement(u.DesktopWrapper,null,i.createElement(R,null)),i.createElement(u.Div100vhContainer,{id:"chart_container",className:"chart-container",is_disabled:(0,p.isDesktop)(),height_offset:"259px"},i.createElement(m,null),i.createElement(i.Suspense,{fallback:i.createElement(y.Z,{is_dark:s,is_visible:!E||a})},i.createElement(u.DesktopWrapper,null,i.createElement("div",{className:"chart-container__wrapper"},i.createElement(y.Z,{is_visible:a||n}),i.createElement(ee,{try_synthetic_indices:L,try_open_markets:F,open_market:$}))),i.createElement(u.MobileWrapper,null,i.createElement(y.Z,{is_visible:a||n||(0,b.A)(e)&&!j[0]}),i.createElement(u.SwipeableWrapper,{onChange:function(t){S(0===t),J(0===t)},is_disabled:!k||!f||0===r.length||a||n},k&&i.createElement(ut,{digits:j,tick:A}),i.createElement(ee,{bottomWidgets:k?K:void 0,is_digits_widget_active:k?X:void 0,try_synthetic_indices:L,try_open_markets:F,open_market:$})))),i.createElement(tt,null)),i.createElement("div",{className:et},l&&!d&&i.createElement(U,Vt({is_eu:c,is_synthetics_available:C},c&&W&&{is_market_available:!0},{onClick:Q,onMarketOpen:w,symbol:E})),i.createElement(bt,{is_market_closed:l,is_trade_enabled:f&&r.length>0&&"online"===_.class})))}));var Kt=i.forwardRef((function(t,e){return i.createElement(ot.Xb,Vt({innerRef:e},t))})),Qt=(0,m.$j)((function(t){var e=t.modules,r=t.ui,o=t.client;return{markers_array:e.contract_trade.markers_array,is_digit_contract:e.contract_trade.is_digit_contract,granularity:e.contract_trade.granularity,is_dark_theme:r.is_dark_mode_on,currency:o.currency}}))((function(t){var e=t.markers_array,r=t.is_dark_theme,o=t.granularity,n=t.currency,a=t.config;return e.map((function(t){var e=Ht[t.type];return i.createElement(e,Vt({key:t.key,is_dark_theme:r,granularity:o,currency:n,config:a},t))}))})),te=function(t){var e,r=t.active_symbols,o=t.chart_layout,n=t.chart_type,a=t.chartStateChange,s=t.exportLayout,c=t.extra_barriers,l=void 0===c?[]:c,u=t.end_epoch,d=t.granularity,f=t.has_alternative_source,_=t.is_trade_enabled,y=t.is_socket_opened,b=t.main_barrier,m=t.refToAddTick,h=t.setChartStatus,g=t.settings,v=t.show_digits_stats,w=t.symbol,O=t.wsForget,S=t.wsForgetStream,k=t.wsSendRequest,P=t.wsSubscribe,E=i.useRef(),C=i.useRef();C.current=t;var x=i.useCallback((function(t){var e=t.digits,r=t.tick;return i.createElement(ft,{digits:e,tick:r})}),[]),j=i.useCallback((function(t){var e=Vt({},t),r=C.current,o=r.is_digits_widget_active,n=r.try_synthetic_indices,a=r.try_open_markets,s=r.open_market;return i.createElement(pt,Vt({open_market:s,open:n||a,charts_ref:E,is_digits_widget_active:o},e))}),[]),D=b?[b].concat(function(t){return function(t){if(Array.isArray(t))return Xt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Zt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(l)):l,T=0===d?8:24;return w&&0!==r.length?i.createElement(Kt,(Wt(e={ref:E,initialData:{activeSymbols:r},chartData:{activeSymbols:r},barriers:D,bottomWidgets:v&&(0,p.isDesktop)()?x:t.bottomWidgets,crosshair:(0,p.isMobile)()?0:void 0,crosshairTooltipLeftAllow:560,showLastDigitStats:!!(0,p.isDesktop)()&&v,chartControlsWidgets:null,chartStatusListener:function(t){return h(!t)},chartType:n},"initialData",{activeSymbols:JSON.parse(JSON.stringify(r))}),Wt(e,"chartData",{activeSymbols:JSON.parse(JSON.stringify(r))}),Wt(e,"feedCall",{activeSymbols:!1}),Wt(e,"enabledNavigationWidget",(0,p.isDesktop)()),Wt(e,"enabledChartFooter",!1),Wt(e,"id","trade"),Wt(e,"isMobile",(0,p.isMobile)()),Wt(e,"maxTick",(0,p.isMobile)()?T:void 0),Wt(e,"granularity",d),Wt(e,"requestAPI",k),Wt(e,"requestForget",O),Wt(e,"requestForgetStream",S),Wt(e,"requestSubscribe",P),Wt(e,"settings",g),Wt(e,"stateChangeListener",a),Wt(e,"symbol",w),Wt(e,"topWidgets",_?j:null),Wt(e,"isConnectionOpened",y),Wt(e,"clearChart",!1),Wt(e,"toolbarWidget",dt),Wt(e,"importedLayout",o),Wt(e,"onExportLayout",s),Wt(e,"shouldFetchTradingTimes",!u),Wt(e,"hasAlternativeSource",f),Wt(e,"refToAddTick",m),Wt(e,"getMarketsOrder",(function(t){var e="synthetic_index",r=!!t.find((function(t){return t.market===e}));return t.slice().sort((function(t,e){return t.display_name<e.display_name?-1:1})).map((function(t){return t.market})).reduce((function(t,e){return-1===t.indexOf(e)&&t.push(e),t}),r?[e]:[])})),Wt(e,"yAxisMargin",{top:(0,p.isMobile)()?76:106}),e),i.createElement(Qt,null)):null};te.propTypes={bottomWidgets:n().func,chart_type:n().string,chart_layout:n().any,chartStateChange:n().func,exportLayout:n().func,end_epoch:n().number,granularity:n().number,is_digits_widget_active:n().bool,is_trade_enabled:n().bool,is_socket_opened:n().bool,has_alternative_source:n().bool,main_barrier:n().any,refToAddTick:n().func,setChartStatus:n().func,settings:n().object,symbol:n().string,try_synthetic_indices:n().bool,wsForget:n().func,wsForgetStream:n().func,wsSendRequest:n().func,wsSubscribe:n().func};var ee=(0,m.$j)((function(t){var e=t.modules,r=t.ui,o=t.common;return{is_socket_opened:o.is_socket_opened,granularity:e.contract_trade.granularity,chart_type:e.contract_trade.chart_type,chartStateChange:e.trade.chartStateChange,settings:{assetInformation:!1,countdown:r.is_chart_countdown_visible,isHighestLowestMarkerEnabled:!1,language:o.current_language.toLowerCase(),position:r.is_chart_layout_default?"bottom":"left",theme:r.is_dark_mode_on?"dark":"light"},last_contract:{is_digit_contract:e.contract_trade.last_contract.is_digit_contract,is_ended:e.contract_trade.last_contract.is_ended},is_trade_enabled:e.trade.is_trade_enabled,main_barrier:e.trade.main_barrier_flattened,extra_barriers:e.trade.barriers_flattened,show_digits_stats:e.trade.show_digits_stats,contract_type:e.trade.contract_type,symbol:e.trade.symbol,exportLayout:e.trade.exportLayout,setChartStatus:e.trade.setChartStatus,chart_layout:e.trade.chart_layout,wsForget:e.trade.wsForget,wsForgetStream:e.trade.wsForgetStream,wsSendRequest:e.trade.wsSendRequest,wsSubscribe:e.trade.wsSubscribe,active_symbols:e.trade.active_symbols,has_alternative_source:e.trade.has_alternative_source,refToAddTick:e.trade.refToAddTick}}))(te);function re(){return re=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},re.apply(this,arguments)}var oe,ne=i.lazy((function(){return r.e("contract").then(r.bind(r,"./Modules/Contract/index.js"))})),ie=i.lazy((function(){return Promise.all([r.e("vendors-node_modules_formik_dist_formik_esm_js"),r.e("cfd")]).then(r.bind(r,"./Modules/CFD/index.js"))})),ae=i.lazy((function(){return Promise.resolve().then(r.bind(r,"./Modules/Page404/index.js"))})),se=(0,p.makeLazyLoader)((function(){return r.e("reports").then(r.bind(r,"./Modules/Reports/index.js"))}),(function(){return i.createElement(u.Loading,null)})),ce={component:ae,getTitle:function(){return(0,_.localize)("Error 404")}};const le=function(){return oe||(oe=[{path:p.routes.contract,component:ne,getTitle:function(){return(0,_.localize)("Contract Details")},is_authenticated:!0},{path:p.routes.dxtrade,component:function(t){return i.createElement(ie,re({},t,{platform:"dxtrade"}))},getTitle:function(){return(0,_.localize)("Deriv X")},is_authenticated:!1},{path:p.routes.mt5,component:function(t){return i.createElement(ie,re({},t,{platform:"mt5"}))},getTitle:function(){return(0,_.localize)("MT5")},is_authenticated:!1},{path:p.routes.reports,component:se("Reports"),is_authenticated:!0,getTitle:function(){return(0,_.localize)("Reports")},icon_component:"IcReports",routes:[{path:p.routes.positions,component:se("OpenPositions"),getTitle:function(){return(0,_.localize)("Open positions")},icon_component:"IcOpenPositions",default:!0},{path:p.routes.profit,component:se("ProfitTable"),getTitle:function(){return(0,_.localize)("Profit table")},icon_component:"IcProfitTable"},{path:p.routes.statement,component:se("Statement"),getTitle:function(){return(0,_.localize)("Statement")},icon_component:"IcStatement"}]},{path:p.routes.trade,component:$t,getTitle:function(){return(0,_.localize)("Trader")},exact:!0}]).push(ce),oe};var ue=["active_class","to","children"];function pe(){return pe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},pe.apply(this,arguments)}var de=function(t){var e=t.active_class,r=t.to,o=t.children,n=function(t,e){if(null==t)return{};var r,o,n=function(t,e){if(null==t)return{};var r,o,n={},i=Object.keys(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(t,ue),a=(0,f.AH)(r),s=(0,f.U_)(a,le());if(!s)throw new Error("Route not found: ".concat(r));return r?i.createElement(d.NavLink,pe({to:a,activeClassName:e||"active",exact:s.exact},n),o):i.createElement("a",n,o)};de.propTypes={active_class:n().string,children:n().oneOfType([n().object,n().array,n().string]),to:n().string};const fe=de;var _e=r("./Modules/Page404/index.js");function ye(){return ye=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},ye.apply(this,arguments)}const be=function(t){return i.createElement(d.Route,{exact:t.exact,path:t.path,render:function(e){var r,o=null,n=(0,p.removeBranchName)(location.pathname).replace(/\/$/,""),a=function(e){var r;return""===e||(null!==(r=t.path)&&void 0!==r&&r.includes(":")?e.substring(0,e.lastIndexOf("/")+1)===t.path.substring(0,t.path.indexOf(":")):t.path===e||!(!t.routes||!t.routes.find((function(t){return e===t.path}))))}(n);if(t.component===d.Redirect){var s=t.to;t.path===p.routes.index&&(s=e.location.pathname.toLowerCase().replace(t.path,"")),o=i.createElement(d.Redirect,{to:s})}else if(a&&t.is_authenticated&&!t.is_logging_in&&!t.is_logged_in)(0,p.redirectToLogin)(t.is_logged_in,(0,_.getLanguage)());else{var c=t.routes?t.routes.find((function(t){return t.default})):{},l=!(0,p.isEmptyObject)(c);o=i.createElement(i.Fragment,null,l&&n===t.path&&i.createElement(d.Redirect,{to:c.path}),a?i.createElement(t.component,ye({},e,{routes:t.routes})):i.createElement(_e.default,null))}var u=(null===(r=t.getTitle)||void 0===r?void 0:r.call(t))||"";return document.title="".concat(u," | ").concat(p.default_title),o}})};function me(){return me=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},me.apply(this,arguments)}const he=function(t){return i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(d.Switch,null,le().map((function(e,r){return i.createElement(be,me({key:r},e,t))}))))};var ge=function(t,e){return t.some((function(t){return!!(0,l.matchPath)(e,{path:t,exact:!0})}))},ve=function(t){var e=t.path_from,r=t.path_to,o=t.action,n=t.match_patterns,i=t.callback;return"PUSH"!==o&&"POP"!==o||i(n.some((function(t){return ge(t.from,e)&&ge(t.to,r)}))),!0},we=s()({loader:function(){return r.e("error-component").then(r.bind(r,"./App/Components/Elements/Errors/index.js"))},loading:u.UILoader,render:function(t,e){var r=t.default;return i.createElement(r,e)}}),Oe=function(t){var e=t.clearPortfolio,r=t.error,o=t.has_error,n=t.history,a=t.is_logged_in,s=t.is_logging_in,c=t.passthrough,l=t.setPromptHandler,u=t.setTradeMountingPolicy;return i.useEffect((function(){return l&&l(!0,(function(t,r){return ve({path_from:n.location.pathname,path_to:t.pathname,match_patterns:[{from:le().flatMap((function(t){return t.routes?t.routes.map((function(t){return t.path})):[t.path]})).filter((function(t){return t&&t!==p.routes.mt5})),to:[p.routes.mt5]}],action:r,callback:function(t){t&&e()}}),ve({path_from:n.location.pathname,path_to:t.pathname,match_patterns:[{from:[p.routes.contract],to:[p.routes.trade]},{from:[p.routes.trade],to:[p.routes.contract]}],action:r,callback:u})})),function(){null==l||l(!1)}}),[]),i.useEffect((function(){return function(){return e()}}),[e]),o?i.createElement(we,r):i.createElement(he,{is_logged_in:a,is_logging_in:s,passthrough:c})};Oe.propTypes={error:c.PropTypes.objectOrObservableObject,has_error:n().bool,history:n().object,is_logged_in:n().bool,is_logging_in:n().bool,passthrough:n().object,setPromptHandler:n().func,setTradeMountingPolicy:n().func};const Se=(0,l.withRouter)((0,m.$j)((function(t){var e=t.client,r=t.common,o=t.modules,n=t.ui;return{clearPortfolio:o.portfolio.clearTable,error:r.error,has_error:r.has_error,is_logged_in:e.is_logged_in,is_logging_in:e.is_logging_in,setPromptHandler:n.setPromptHandler,setTradeMountingPolicy:o.trade.setSkipPrePostLifecycle}}))(Oe));var ke=r("../../../node_modules/react-transition-group/esm/TransitionGroup.js"),Pe=r("./Stores/Modules/Trading/Helpers/active-symbols.js"),Ee=r("./Stores/Modules/Contract/Helpers/multiplier.js"),Ce=r("./Stores/Modules/Contract/Helpers/logic.js"),xe=r("./App/Components/Elements/ContentLoader/index.js"),je=r("./Constants/contract.js"),De=r("./Modules/Reports/Helpers/market-underlying.js");function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function Ae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ze(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Me(t,e){return Me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Me(t,e)}function Re(t,e){return!e||"object"!==Te(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Le(t){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Le(t)}var Ie=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Me(t,e)}(n,t);var e,r,o=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Le(t);if(e){var n=Le(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Re(this,r)}}(n);function n(){var t;Ae(this,n);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=o.call.apply(o,[this].concat(r))).handleClick=function(e){t.props.is_unsupported&&(e.preventDefault(),t.props.onClick())},t}return e=n,(r=[{key:"render",value:function(){var t=this.props,e=t.is_visible,r="won"===t.result;return i.createElement(i.Fragment,null,i.createElement(v.Z,{in:e,timeout:250,classNames:{enter:"positions-modal-card__result--enter",enterDone:"positions-modal-card__result--enter-done",exit:"positions-modal-card__result--exit"},unmountOnExit:!0},i.createElement("div",{className:"positions-modal-card__caption-wrapper"},i.createElement("span",{className:g()("positions-modal-card__caption",{"positions-modal-card__caption--won":r,"positions-modal-card__caption--lost":!r})},r?i.createElement(i.Fragment,null,(0,_.localize)("Won"),i.createElement(u.Icon,{icon:"IcCheckmarkCircle",className:"positions-modal-card__icon",color:"green"})):i.createElement(i.Fragment,null,(0,_.localize)("Lost"),i.createElement(u.Icon,{icon:"IcCrossCircle",className:"positions-modal-card__icon",color:"red"}))))))}}])&&ze(e.prototype,r),n}(i.PureComponent);Ie.propTypes={is_unsupported:n().bool,is_visible:n().bool,onClick:n().func,result:n().string};const Ne=Ie;var Ue=function(t){var e,r=t.active_symbols,o=t.addToast,n=t.className,a=t.contract_info,s=t.contract_update,c=t.currency,l=t.current_focus,d=t.current_tick,f=t.getContractById,y=t.id,b=t.indicative,m=t.is_loading,h=t.is_mobile,w=t.is_sell_requested,O=t.is_unsupported,S=t.onClickRemove,k=t.onClickSell,P=t.profit_loss,E=t.onClickCancel,C=t.removeToast,x=t.result,j=t.sell_price,D=t.server_time,T=t.setCurrentFocus,A=t.should_show_cancellation_warning,z=t.status,M=t.toggleCancellationWarning,R=t.togglePositions,L=t.toggleUnsupportedContractModal,I=t.type,N=i.createElement("div",{className:"positions-modal-card__content-loader"},i.createElement(xe.rl,{speed:2})),U=(0,p.isMultiplierContract)(a.contract_type),F=(0,p.isCryptoContract)(a.underlying),B=!U||F&&U,H=!!(0,Ce.NQ)(a),W=P>=0?"won":"lost",V=(0,p.hasContractEntered)(a)&&(0,p.isOpen)(a),G=(0,Pe.rh)(r,(0,De.cS)(a.shortcode).underlying),q=i.createElement(i.Fragment,null,i.createElement("div",{className:g()("positions-modal-card__grid","positions-modal-card__grid-header")},i.createElement("div",{className:"positions-modal-card__underlying-name"},i.createElement(u.Icon,{icon:a.underlying?"IcUnderlying".concat(a.underlying):"IcUnknown",size:34}),i.createElement(u.Text,{size:"xxs",className:"positions-modal-card__symbol",weight:"bold"},a.display_name)),i.createElement("div",{className:"positions-modal-card__type"},i.createElement(u.ContractCard.ContractTypeCell,{getContractTypeDisplay:je.h8,is_high_low:(0,p.isHighLow)({shortcode:a.shortcode}),multiplier:a.multiplier,type:I})),i.createElement(v.Z,{in:V,timeout:250,classNames:{enter:"positions-modal-card__sell-button--enter",enterDone:"positions-modal-card__sell-button--enter-done",exit:"positions-modal-card__sell-button--exit"},unmountOnExit:!0},i.createElement("div",{className:"positions-modal-card__sell-button"},i.createElement(u.ContractCard.Sell,{contract_info:a,is_sell_requested:w,getCardLabels:je.gk,onClickSell:k})))),i.createElement(u.CurrencyBadge,{currency:null!==(e=null==a?void 0:a.currency)&&void 0!==e?e:""}),i.createElement("div",{className:g()("positions-modal-card__grid","positions-modal-card__grid-body")},i.createElement("div",{className:g()("positions-modal-card__grid-profit-payout")},i.createElement("div",{className:g()("positions-modal-card__profit-loss","positions-modal-card__profit-loss-label")},x?(0,_.localize)("Profit/Loss:"):(0,_.localize)("Potential profit/loss:")),i.createElement("div",{className:g()("positions-modal-card__indicative","positions-modal-card__indicative-label")},x?(0,_.localize)("Payout:"):(0,_.localize)("Indicative price:")),i.createElement("div",{className:g()("positions-modal-card__profit-loss",{"positions-modal-card__profit-loss--is-crypto":(0,p.isCryptocurrency)(c),"positions-modal-card__profit-loss--negative":P<0,"positions-modal-card__profit-loss--positive":P>0})},i.createElement(u.Money,{amount:Math.abs(P),currency:c}),i.createElement("div",{className:g()("positions-modal-card__indicative--movement",{"positions-modal-card__indicative--movement-complete":!!x})},"profit"===z&&i.createElement(u.Icon,{icon:"IcProfit"}),"loss"===z&&i.createElement(u.Icon,{icon:"IcLoss"}))),i.createElement("div",{className:"positions-modal-card__indicative"},i.createElement(u.Money,{amount:j||b,currency:c}),i.createElement("div",{className:g()("positions-modal-card__indicative--movement",{"positions-modal-card__indicative--movement-complete":!!x})},"profit"===z&&i.createElement(u.Icon,{icon:"IcProfit"}),"loss"===z&&i.createElement(u.Icon,{icon:"IcLoss"})))),i.createElement("div",{className:g()("positions-modal-card__grid-price-payout")},i.createElement("div",{className:"positions-modal-card__purchase-price"},i.createElement(u.Text,{size:"xxxs",className:"positions-modal-card__purchase-label"},(0,_.localize)("Purchase price:")),i.createElement(u.Text,{weight:"bold",size:"xxs",className:"positions-modal-card__purchase-value"},i.createElement(u.Money,{amount:a.buy_price,currency:c}))),i.createElement("div",{className:"positions-modal-card__payout-price"},i.createElement(u.Text,{size:"xxxs",className:"positions-modal-card__payout-label"},(0,_.localize)("Potential payout:")),i.createElement(u.Text,{weight:"bold",size:"xxs",className:"positions-modal-card__payout-value"},a.payout?i.createElement(u.Money,{amount:a.payout,currency:c}):i.createElement("strong",null,"-i")))),x||a.is_sold?i.createElement(Ne,{contract_id:y,is_unsupported:O,is_visible:!!a.is_sold,onClickRemove:S,onClick:function(){return L(!0)},result:x||W}):i.createElement(u.ProgressSliderMobile,{className:"positions-modal-card__progress",current_tick:d,getCardLabels:je.gk,is_loading:m,start_time:a.date_start,expiry_time:a.date_expiry,server_time:D,ticks_count:a.tick_count}))),Y=i.createElement(u.ContractCard.Header,{contract_info:a,display_name:G,getCardLabels:je.gk,getContractTypeDisplay:je.h8,has_progress_slider:!h&&B,is_mobile:h,is_sell_requested:w,onClickSell:k,server_time:D}),Z=i.createElement(u.ContractCard.Body,{addToast:o,connectWithContractUpdate:Ee.tP,contract_info:a,contract_update:s,currency:c,current_focus:l,getCardLabels:je.gk,getContractById:f,is_mobile:h,is_multiplier:U,has_progress_slider:h&&B&&!H,removeToast:C,server_time:D,setCurrentFocus:T,should_show_cancellation_warning:A,status:z,toggleCancellationWarning:M}),X=i.createElement(u.ContractCard.Footer,{contract_info:a,getCardLabels:je.gk,is_multiplier:U,is_sell_requested:w,onClickCancel:E,onClickSell:k,server_time:D,status:z}),J=i.createElement(i.Fragment,null,i.createElement(u.ContractCard,{contract_info:a,getCardLabels:je.gk,is_multiplier:U,profit_loss:P,should_show_result_overlay:!1},Y,Z,X)),$=U?J:q;return i.createElement("div",{id:"dt_drawer_card_".concat(y),className:g()("positions-modal-card__wrapper",n)},O?i.createElement("div",{className:g()("positions-modal-card"),onClick:function(){return L(!0)}},a.underlying?$:N):i.createElement(i.Fragment,null,i.createElement(fe,{onClick:R,className:g()("positions-modal-card",{"positions-modal-card--multiplier":U}),to:(0,p.getContractPath)(y)},a.underlying?$:N)))};Ue.propTypes={className:n().string,contract_info:n().object,currency:n().string,current_focus:n().string,current_tick:n().number,duration:n().oneOfType([n().number,n().string]),duration_unit:n().string,exit_spot:n().oneOfType([n().number,n().string]),id:n().number,indicative:n().number,is_loading:n().bool,is_mobile:n().bool,is_sell_requested:n().bool,is_unsupported:n().bool,is_valid_to_sell:n().oneOfType([n().number,n().bool]),onClickRemove:n().func,onClickSell:n().func,onClickCancel:n().func,profit_loss:n().number,result:n().string,sell_time:n().number,server_time:n().object,setCurrentFocus:n().func,status:n().string,togglePositions:n().func,toggleUnsupportedContractModal:n().func,type:n().string};const Fe=(0,m.$j)((function(t){var e=t.common,r=t.ui,o=t.modules;return{active_symbols:o.trade.active_symbols,addToast:r.addToast,current_focus:r.current_focus,getContractById:o.contract_trade.getContractById,is_mobile:r.is_mobile,removeToast:r.removeToast,server_time:e.server_time,setCurrentFocus:r.setCurrentFocus,should_show_cancellation_warning:r.should_show_cancellation_warning,toggleCancellationWarning:r.toggleCancellationWarning,updateLimitOrder:o.contract_trade.updateLimitOrder}}))(Ue);var Be=function(t){var e=t.positions_count,r=t.is_open,o=t.togglePositions,n=g()("positions-toggle",{"positions-toggle--active":r,"positions-toggle--has-count":e>0});return i.createElement("a",{id:"dt_positions_toggle",className:n,onClick:o,"data-count":e},i.createElement(u.Icon,{icon:"IcPortfolio",className:"positions-toggle__icon"}))};Be.propTypes={is_positions_drawer_on:n().bool,positions_count:n().number,togglePositionsDrawer:n().func};const He=Be;function We(){return We=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},We.apply(this,arguments)}const Ve=(0,m.$j)((function(t){var e=t.modules,r=t.ui;return{symbol:e.trade.symbol,trade_contract_type:e.trade.contract_type,onClickRemove:e.portfolio.removePositionById,togglePositionsDrawer:r.togglePositionsDrawer,is_positions_drawer_on:r.is_positions_drawer_on}}))((function(t){var e=t.active_positions_count,r=t.all_positions,o=t.currency,n=t.disableApp,a=t.enableApp,s=t.error,c=t.is_empty,l=t.is_positions_drawer_on,d=t.onClickSell,f=t.onClickRemove,y=t.onClickCancel,b=t.symbol,m=t.togglePositionsDrawer,h=t.toggleUnsupportedContractModal,g=t.trade_contract_type,O=[],S=function(){O.slice(0,5).map((function(t){var e=t.contract_info;null!=e&&e.is_sold&&f(e.contract_id)})),m()};O=r.filter((function(t){return t.contract_info&&b===t.contract_info.underlying&&(0,k._M)(t.contract_info,g)}));var P=i.createElement(i.Fragment,null,i.createElement(ke.Z,{component:"div"},O.slice(0,5).map((function(t){return i.createElement(v.Z,{appear:!0,key:t.id,in:!0,timeout:150,classNames:{appear:"dc-contract-card__wrapper--enter",enter:"dc-contract-card__wrapper--enter",enterDone:"dc-contract-card__wrapper--enter-done",exit:"dc-contract-card__wrapper--exit"},unmountOnExit:!0},i.createElement(Fe,We({onClickSell:d,onClickCancel:y,onClickRemove:f,key:t.id,currency:o,toggleUnsupportedContractModal:h,togglePositions:m},t)))}))));return i.createElement(i.Fragment,null,i.createElement(He,{is_open:l,togglePositions:m,positions_count:e}),i.createElement(u.Modal,{is_open:l,toggleModal:S,id:"dt_mobile_positions",is_vertical_top:!0,has_close_icon:!0,enableApp:a,disableApp:n,width:"calc(100vw - 32px)"},i.createElement(u.Div100vhContainer,{className:"positions-modal",height_offset:"48px"},i.createElement("div",{className:"positions-modal__header"},i.createElement(u.Text,{size:"xxxs",className:"positions-modal__title"},i.createElement(u.Icon,{icon:"IcPortfolio",className:"positions-modal__title-icon"}),(0,_.localize)("Recent positions")),i.createElement("div",{className:"positions-modal__close-btn",onClick:S},i.createElement(u.Icon,{icon:"IcMinusBold"}))),i.createElement("div",{className:"positions-modal__body"},c||s?i.createElement(w,{error:s}):P),i.createElement("div",{className:"positions-modal__footer"},i.createElement(fe,{onClick:S,className:"dc-btn dc-btn--secondary dc-btn__large positions-modal__footer-btn",to:p.routes.positions},i.createElement("span",{className:"dc-btn__text"},(0,_.localize)("Go to Reports")))))))}));function Ge(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}var qe=function(t){var e=t.disableApp,r=t.enableApp,o=t.onMountCashier,n=t.onMountPositions,a=t.onPositionsCancel,s=t.onPositionsRemove,c=t.onPositionsSell,l=t.onUnmountPositions,d=t.populateHeaderExtensions,f=t.setAccountSwitchListener,_=t.store,y=i.useRef();y.current=t;var b=location.pathname!==p.routes.mt5,h=i.useCallback((function(){var t=y.current,o=t.is_logged_in,n=t.is_positions_empty,l=t.active_positions_count,p=t.positions,f=t.positions_currency,h=t.positions_error,g=o&&b&&i.createElement(u.MobileWrapper,null,i.createElement(m.z1,{store:_},i.createElement(Ve,{active_positions_count:l,all_positions:p,currency:f,disableApp:e,is_empty:n,enableApp:r,error:h,onClickSell:c,onClickRemove:s,onClickCancel:a})));d(g)}),[e,r,a,s,c,d,_,b]);return i.useEffect((function(){var t=function(){var t,e=(t=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,p.isMobile)()||!b){t.next=10;break}return e=_.client,t.next=4,(0,F.when)((function(){return!e.is_populating_account_list}));case 4:if(!y.current.is_logged_in){t.next=10;break}return t.next=7,p.WS.wait("authorize");case 7:n(),o(!0),f();case 10:h();case 11:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Ge(i,o,n,a,s,"next",t)}function s(t){Ge(i,o,n,a,s,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}();return t(),function(){(0,p.isMobile)()&&l(),d(null)}}),[o,n,l,h,d,f,_,b]),i.useEffect((function(){h()})),null};qe.propTypes={is_logged_in:n().bool,populateHeaderExtensions:n().func};const Ye=(0,m.$j)((function(t){var e=t.client,r=t.modules,o=t.ui;return{positions_currency:e.currency,is_logged_in:e.is_logged_in,positions:r.portfolio.all_positions,positions_error:r.portfolio.error,is_positions_empty:r.portfolio.is_empty,onPositionsSell:r.portfolio.onClickSell,onPositionsRemove:r.portfolio.removePositionById,onPositionsCancel:r.portfolio.onClickCancel,onMountCashier:r.cashier.onMountCommon,onMountPositions:r.portfolio.onMount,onUnmountPositions:r.portfolio.onUnmount,active_positions_count:r.portfolio.active_positions_count,disableApp:o.disableApp,enableApp:o.enableApp,populateHeaderExtensions:o.populateHeaderExtensions,toggleUnsupportedContractModal:o.toggleUnsupportedContractModal,setAccountSwitchListener:r.cashier.setAccountSwitchListener}}))(qe);var Ze=function(t){var e=t.active_positions_count,r=t.is_logged_in,o=t.is_positions_drawer_on,n=t.location,a=t.populateFooterExtensions,s=t.togglePositionsDrawer;i.useEffect((function(){return l()})),i.useEffect((function(){return function(){return a([])}}),[]);var c=function(){return i.createElement(He,{is_open:o,togglePositions:s,positions_count:e})},l=function(){var t=n.pathname===p.routes.trade;a(r&&t?[{position:"left",Component:c}]:[])};return null};Ze.propTypes={active_positions_count:n().number,is_logged_in:n().bool,is_positions_drawer_on:n().bool,location:n().object,populateFooterExtensions:n().func,togglePositionsDrawer:n().func};const Xe=(0,m.$j)((function(t){var e=t.client,r=t.modules,o=t.ui;return{active_positions_count:r.portfolio.active_positions_count,is_logged_in:e.is_logged_in,is_positions_drawer_on:o.is_positions_drawer_on,populateFooterExtensions:o.populateFooterExtensions,togglePositionsDrawer:o.togglePositionsDrawer}}))((0,d.withRouter)(Ze));var Je=s()({loader:function(){return r.e("settings-chart").then(r.bind(r,"./App/Containers/SettingsModal/settings-chart.jsx"))},loading:u.UILoader}),$e=function(t){var e=t.populateSettingsExtensions,r=t.store;return i.useEffect((function(){return function(){return e(null)}}),[]),i.useEffect((function(){return function(){var t=[{icon:"IcChart",label:(0,_.localize)("Charts"),value:function(t){return function(t,e){return i.createElement(m.z1,{store:e},i.createElement(Je,t))}(t,r)}}];e(t)}()})),null};$e.propTypes={populateSettingsExtensions:n().func,store:n().object};const Ke=(0,m.$j)((function(t){return{populateSettingsExtensions:t.ui.populateSettingsExtensions}}))($e);var Qe=r("./Modules/Trading/Containers/toast-popup.jsx"),tr=r("../../../node_modules/extend/index.js"),er=r.n(tr),rr=function(t){var e=t.label,r=t.line_style,o=t.marker_config,n=t.status;return o?i.createElement("div",{className:g()("chart-marker-line__wrapper","chart-marker-line--".concat(r))},e===o.LINE_END.content_config.label&&i.createElement(u.Icon,{icon:"IcContractExitTimeCircle",className:"chart-marker-line__icon",color:"lost"===n?"red":"green",size:24}),e===o.LINE_START.content_config.label&&i.createElement(u.Icon,{icon:"IcContractStartTimeCircle",className:"chart-marker-line__icon chart-marker-line__icon--time",color:"secondary",size:24})):i.createElement("div",null)};rr.propTypes={label:n().string,line_style:n().string,marker_config:n().object,status:n().oneOf(["won","lost"])};const or=(0,c.observer)(rr);var nr=function(t){var e=t.className,r=t.spot_count;return i.createElement("div",{className:g()("chart-spot",e)},r)};nr.propTypes={className:n().string,spot_count:n().oneOfType([n().number,n().string])};const ir=(0,c.observer)(nr);function ar(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var sr=function(t){var e=t.align_label,r=t.has_hover_toggle,o=t.spot_className,n=t.spot_count,a=t.spot_epoch,s=t.spot_value,c=t.status,l=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ar(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ar(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.useState(!r),2),d=l[0],f=l[1],_=function(){f(!d)},y=i.createElement(ir,{className:o,spot_count:n});return r&&(y=i.createElement("div",{className:"marker-hover-container",onMouseEnter:_,onMouseLeave:_},y)),i.createElement("div",{className:"chart-spot-label"},d&&i.createElement("div",{className:"chart-spot-label__info-container"},i.createElement("div",{className:"chart-spot-label__time-value-container chart-spot-label__time-value-container--".concat(e)},i.createElement("div",{className:"chart-spot-label__time-container"},i.createElement(u.Icon,{icon:"IcClockOutline",height:10,width:10,className:"chart-spot-label__time-icon"}),i.createElement(u.Text,{as:"p",color:"prominent",size:"xxxs"},(0,p.toMoment)(+a).format("HH:mm:ss"))),i.createElement("div",{className:g()("chart-spot-label__value-container",{"chart-spot-label__value-container--won":"won"===c,"chart-spot-label__value-container--lost":"lost"===c})},i.createElement("p",null,(0,p.addComma)(s))))),y)};sr.defaultProps={align_label:"top"},sr.propTypes={align_label:n().oneOf(["top","bottom"]),has_hover_toggle:n().bool,spot_className:n().string,spot_count:n().oneOfType([n().number,n().string]),spot_epoch:n().oneOfType([n().number,n().string]),spot_value:n().oneOfType([n().number,n().string]),status:n().oneOf(["won","lost"])};const cr=(0,c.observer)(sr);var lr,ur,pr={LINE_END:{type:"LINE_END",marker_config:{ContentComponent:or,className:"chart-marker-line"},content_config:{line_style:"dash",label:(0,_.localize)("End Time")}},LINE_PURCHASE:{type:"LINE_PURCHASE",marker_config:{ContentComponent:or,className:"chart-marker-line"},content_config:{line_style:"solid",label:(0,_.localize)("Purchase Time")}},LINE_START:{type:"LINE_START",marker_config:{ContentComponent:or,className:"chart-marker-line"},content_config:{line_style:"solid",label:(0,_.localize)("Start Time")}},SPOT_ENTRY:{type:"SPOT_ENTRY",marker_config:{ContentComponent:ir},content_config:{className:"chart-spot__entry"}},SPOT_SELL:{type:"SPOT_SELL",marker_config:{ContentComponent:ir},content_config:{className:"chart-spot__sell"}},SPOT_EXIT:{type:"SPOT_EXIT",marker_config:{ContentComponent:cr},content_config:{spot_className:"chart-spot__spot"}},SPOT_MIDDLE:{type:"SPOT_MIDDLE",marker_config:{ContentComponent:cr},content_config:{spot_className:"chart-spot__spot"}}},dr=function(t,e,r,o){return er()(!0,{},pr[t],{marker_config:{x:+e,y:r},content_config:o})},fr=function(t,e){return(0,p.isDigitContract)(t.contract_type)?e+1:e},_r=function(t){if(!t.entry_tick_time)return!1;var e=pr.SPOT_ENTRY.type,r={},o=t.entry_tick_display_value;return(0,p.isDigitContract)(t.contract_type)&&(e=pr.SPOT_MIDDLE.type,r={spot_value:"".concat(o),spot_epoch:"".concat(t.entry_tick_time),spot_count:1}),dr(e,t.entry_tick_time,o,r)},yr=function(t,e,r){if(!t.exit_tick_time)return!1;var o,n,i=(0,p.isUserSold)(t);e&&(o=fr(t,r),n=e.align_label);var a=t.exit_tick_display_value,s=!i||(0,p.isMultiplierContract)(t.contract_type),c=s?pr.SPOT_EXIT.type:pr.SPOT_SELL.type,l=s?{spot_value:"".concat(a),spot_epoch:"".concat(t.exit_tick_time),status:"".concat(+t.profit>=0?"won":"lost"),align_label:n,spot_count:o}:{};return dr(c,+t.exit_tick_time,+a,l)};function br(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mr(t){return function(t){if(Array.isArray(t))return hr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return hr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var gr,vr,wr,Or,Sr,kr,Pr,Er,Cr,xr,jr,Dr,Tr,Ar,zr,Mr,Rr,Lr=(br(lr={},pr.SPOT_ENTRY.type,_r),br(lr,pr.SPOT_EXIT.type,yr),lr),Ir=(br(ur={},pr.LINE_START.type,(function(t){return!!t.date_start&&dr(pr.LINE_START.type,+t.date_start,null,{marker_config:pr})})),br(ur,pr.LINE_END.type,(function(t){var e=(0,Ce.NQ)(t);return!!e&&dr(pr.LINE_END.type,+e,null,{status:"".concat(t.profit>=0?"won":"lost"),marker_config:pr})})),br(ur,pr.LINE_PURCHASE.type,(function(t){return!(!t.purchase_time||!t.date_start||+t.purchase_time==+t.date_start)&&dr(pr.LINE_PURCHASE.type,+t.purchase_time)})),ur),Nr=function(t,e,r){if(e>0&&r.length){var o=r[e-1];+t>+o.tick&&(t.align_label="top"),+t.tick<+o.tick&&(t.align_label="bottom"),+t.tick==+o.tick&&(t.align_label=o.align_label)}return t},Ur={CALL:"ABOVE",PUT:"BELOW",CALLE:"ABOVE",PUTE:"BELOW",EXPIRYRANGE:"BETWEEN",EXPIRYMISS:"OUTSIDE",RANGE:"BETWEEN",UPORDOWN:"OUTSIDE",ONETOUCH:"NONE_SINGLE",NOTOUCH:"NONE_SINGLE",ASIANU:"ABOVE",ASIAND:"BELOW",MULTUP:"ABOVE",MULTDOWN:"BELOW"},Fr={1:"NONE_SINGLE",2:"NONE_DOUBLE"},Br="#999999",Hr="#6E6E6E",Wr="solid",Vr=function(t){return t in Ur},Gr=function(t,e){var r=t.findIndex((function(t){return t.key===e}));r>-1&&t.splice(r,1)};function qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Yr(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function Zr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xr(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Jr(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var $r=(gr=F.action.bound,vr=F.action.bound,wr=F.action.bound,Or=F.action.bound,Sr=function(){function t(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.color,a=n.line_style,s=n.not_draggable;Zr(this,t),Yr(this,"color",kr,this),Yr(this,"lineStyle",Pr,this),Yr(this,"shade",Er,this),Yr(this,"shadeColor",Cr,this),Yr(this,"high",xr,this),Yr(this,"low",jr,this),Yr(this,"relative",Dr,this),Yr(this,"draggable",Tr,this),Yr(this,"hidePriceLines",Ar,this),Yr(this,"hideBarrierLine",zr,this),Yr(this,"hideOffscreenLine",Mr,this),Yr(this,"title",Rr,this),this.onChartBarrierChange=void 0,this.color=i,this.lineStyle=a||Wr,this.onChange=this.onBarrierChange,this.onChartBarrierChange="function"==typeof o?o.bind(this):function(){},this.high=+e||0,r&&(this.low=+r),this.shade=this.default_shade;var c=!!e;this.relative=!c||/^[+-]/.test(e),this.draggable=!s&&c,this.hidePriceLines=!c}var e,r;return e=t,r=[{key:"updateBarriers",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r||(this.relative=/^[+-]/.test(t)),this.high=+t||void 0,this.low=+e||void 0}},{key:"updateBarrierShade",value:function(t,e){this.shade=t&&Ur[e]||this.default_shade}},{key:"onBarrierChange",value:function(t){var e=t.high,r=t.low;this.updateBarriers(e,r,!0),this.onChartBarrierChange.apply(this,function(t){return function(t){if(Array.isArray(t))return qr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return qr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.filter((function(t){return null!=t})).map((function(e){return"".concat(t&&!/^[+-]/.test(e)?"+":"").concat(e)}))}(this.relative,e,r)))}},{key:"updateBarrierColor",value:function(t){this.color=t?Hr:Br}},{key:"barrier_count",get:function(){return(void 0!==this.high)+(void 0!==this.low)}},{key:"default_shade",get:function(){return Fr[this.barrier_count]}}],r&&Xr(e.prototype,r),t}(),kr=Jr(Sr.prototype,"color",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pr=Jr(Sr.prototype,"lineStyle",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Er=Jr(Sr.prototype,"shade",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cr=Jr(Sr.prototype,"shadeColor",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xr=Jr(Sr.prototype,"high",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jr=Jr(Sr.prototype,"low",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr=Jr(Sr.prototype,"relative",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tr=Jr(Sr.prototype,"draggable",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar=Jr(Sr.prototype,"hidePriceLines",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=Jr(Sr.prototype,"hideBarrierLine",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr=Jr(Sr.prototype,"hideOffscreenLine",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=Jr(Sr.prototype,"title",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jr(Sr.prototype,"updateBarriers",[gr],Object.getOwnPropertyDescriptor(Sr.prototype,"updateBarriers"),Sr.prototype),Jr(Sr.prototype,"updateBarrierShade",[vr],Object.getOwnPropertyDescriptor(Sr.prototype,"updateBarrierShade"),Sr.prototype),Jr(Sr.prototype,"onBarrierChange",[wr],Object.getOwnPropertyDescriptor(Sr.prototype,"onBarrierChange"),Sr.prototype),Jr(Sr.prototype,"updateBarrierColor",[Or],Object.getOwnPropertyDescriptor(Sr.prototype,"updateBarrierColor"),Sr.prototype),Jr(Sr.prototype,"barrier_count",[F.computed],Object.getOwnPropertyDescriptor(Sr.prototype,"barrier_count"),Sr.prototype),Jr(Sr.prototype,"default_shade",[F.computed],Object.getOwnPropertyDescriptor(Sr.prototype,"default_shade"),Sr.prototype),Sr),Kr={STOP_OUT:"stop_out",TAKE_PROFIT:"take_profit",STOP_LOSS:"stop_loss"},Qr=function(t){var e=t.barriers,r=t.contract_type,o=t.contract_info,n=void 0===o?{}:o;if(t.is_over&&function(t,e){return(0,p.isMultiplierContract)(t)&&e.limit_order}(r,n)){var i=Object.values(Kr),a=Object.keys(n.limit_order).some((function(t){return t===Kr.STOP_LOSS&&n.limit_order[t].value}));i.forEach((function(t){var r=n.limit_order[t];if(r&&r.value){var o=e.find((function(e){return e.key===t}));if(o){if(o.high===+r.value)return;o.onChange({high:r.value})}else{var i={key:t,title:"".concat(r.display_name),color:t===Kr.TAKE_PROFIT?"#4bb4b3":"#ff6444",draggable:!1,lineStyle:t===Kr.STOP_OUT?"dotted":Wr,hidePriceLines:a&&t===Kr.STOP_OUT,hideOffscreenLine:!0,showOffscreenArrows:!0,isSingleBarrier:!0,opacityOnOverlap:t===Kr.STOP_OUT&&.15};o=new $r(r.value),Object.assign(o,i),e.push(o)}}else Gr(e,t)}))}else Object.values(Kr).forEach((function(t){return Gr(e,t)}))};var to,eo,ro,oo,no,io,ao,so,co,lo,uo,po,fo,_o,yo,bo,mo,ho,go,vo,wo,Oo,So,ko,Po,Eo,Co,xo,jo,Do,To,Ao,zo=r("./Stores/base-store.js");function Mo(t){return Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(t)}function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Lo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Io(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function No(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Uo(t,e){return Uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Uo(t,e)}function Fo(t,e){return!e||"object"!==Mo(e)&&"function"!=typeof e?Bo(t):e}function Bo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ho(t){return Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ho(t)}function Wo(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}function Vo(t){return function(t){if(Array.isArray(t))return Go(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Go(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Go(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Go(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var qo,Yo,Zo,Xo,Jo,$o,Ko,Qo,tn,en,rn,on,nn,an,sn,cn,ln,un,pn,dn,fn,_n,yn,bn,mn,hn,gn,vn,wn=(to=F.observable.ref,eo=F.observable.ref,ro=F.observable.ref,oo=F.observable.shallow,no=F.observable.shallow,io=F.observable.ref,ao=F.action.bound,so=F.action.bound,co=F.action.bound,lo=F.action.bound,uo=F.action.bound,po=F.action.bound,fo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uo(t,e)}(n,t);var e,r,o=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Ho(t);if(e){var n=Ho(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Fo(this,r)}}(n);function n(t,e){var r,i=e.contract_id;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Io(r=o.call(this,{root_store:t,validation_rules:{has_contract_update_stop_loss:{trigger:"contract_update_stop_loss"},contract_update_stop_loss:{rules:[["req",{condition:function(t){return!t.contract_update_stop_loss},message:(0,_.localize)("Please enter a stop loss amount.")}],["custom",{func:function(t,e,r){var o=(0,p.getTotalProfit)(r.contract_info);return!(o<0&&-t>o)},message:(0,_.localize)("Please enter a stop loss amount that's higher than the current potential loss.")}],["custom",{func:function(t,e,r){return t<(0,Ce.f)(r)+1},message:(0,_.localize)("Invalid stop loss. Stop loss cannot be more than stake.")}]]},has_contract_update_take_profit:{trigger:"contract_update_take_profit"},contract_update_take_profit:{rules:[["req",{condition:function(t){return!t.contract_update_take_profit},message:(0,_.localize)("Please enter a take profit amount.")}],["custom",{func:function(t,e,r){var o=(0,p.getTotalProfit)(r.contract_info);return!(o>0&&+t<o)},message:(0,_.localize)("Please enter a take profit amount that's higher than the current potential profit.")}]]}}}),"digits_info",_o,Bo(r)),Io(r,"sell_info",yo,Bo(r)),Io(r,"contract_config",bo,Bo(r)),Io(r,"display_status",mo,Bo(r)),Io(r,"is_ended",ho,Bo(r)),Io(r,"is_digit_contract",go,Bo(r)),Io(r,"error_message",vo,Bo(r)),Io(r,"contract_info",wo,Bo(r)),Io(r,"is_static_chart",Oo,Bo(r)),Io(r,"end_time",So,Bo(r)),Io(r,"contract_update_take_profit",ko,Bo(r)),Io(r,"contract_update_stop_loss",Po,Bo(r)),Io(r,"has_contract_update_take_profit",Eo,Bo(r)),Io(r,"has_contract_update_stop_loss",Co,Bo(r)),Io(r,"contract_update_history",xo,Bo(r)),r.contract_update_config={},Io(r,"margin",jo,Bo(r)),Io(r,"barriers_array",Do,Bo(r)),Io(r,"markers_array",To,Bo(r)),Io(r,"marker",Ao,Bo(r)),r.is_ongoing_contract=!1,r.cacheProposalOpenContractResponse=function(t){var e=t.proposal_open_contract.contract_id;p.WS.storage.set({proposal_open_contract:1,contract_id:e},t)},r.createBarriersArray=function(t,e){var r=[];if(t){var o=t.contract_type,n=t.barrier,i=t.entry_spot,a=t.high_barrier,s=t.low_barrier;if(Vr(o)&&(n||a||i)){var c=new $r(n||a||i,s,null,{color:e?Hr:Br,line_style:Wr,not_draggable:!0});c.updateBarrierShade(!0,o),r=[c]}}return r},r.root_store=t,r.contract_id=i,r}return e=n,r=[{key:"populateConfig",value:function(t){var e=this.contract_info;this.contract_info=t,this.end_time=(0,Ce.NQ)(this.contract_info),this.updateBarriersArray(t,this.root_store.ui.is_dark_mode_on),this.markers_array=function(t){var e=[];if(t){var r,o=(0,Ce.NQ)(t),n=(0,Ce.aG)(t.date_start,o);if(t.tick_count){var i,a=function(t){var e=(0,p.unique)(t.tick_stream,"epoch").map(Nr),r=[];return e.forEach((function(e,o){var n,i=0===o&&+e.epoch!==t.exit_tick_time,a=o>0&&+e.epoch!=+t.exit_tick_time,s=+e.epoch==+t.exit_tick_time||fr(t,o)===t.tick_count;i?n=_r(t):a?n=function(t,e,r){var o=fr(t,r),n=e.tick_display_value,i=dr(pr.SPOT_MIDDLE.type,+e.epoch,+n,{spot_value:"".concat(n),spot_epoch:"".concat(e.epoch),align_label:e.align_label,spot_count:o});return i.type="".concat(i.type,"_").concat(r),(0,p.isMobile)()&&o>1?null:i}(t,e,o):s&&(e.align_label="top",n=yr(t,e,o)),n&&r.push(n)})),r}(t);(i=e).push.apply(i,mr(a))}else if("candle"!==n){var s,c=Object.keys(Lr).map((function(e){return Lr[e](t)}));(s=e).push.apply(s,mr(c))}var l=Object.keys(Ir).map((function(e){return Ir[e](t)}));(r=e).push.apply(r,mr(l)),e=e.filter((function(t){return!!t}))}return e.forEach((function(e){var r=t.contract_id;e.react_key="".concat(r,"-").concat(e.type)})),e}(this.contract_info),this.marker=function(t){if(!t||(0,p.isMultiplierContract)(t.contract_type))return null;var e=t.transaction_ids,r=t.tick_stream,o=t.contract_id,n=t.date_start,i=t.date_expiry,a=t.entry_tick,s=t.exit_tick,c=t.entry_tick_time,l=t.exit_tick_time,u=t.contract_type,d=t.tick_count,f=t.barrier_count,_=t.barrier,y=t.high_barrier,b=t.low_barrier,m=r?r.map((function(t){return t.epoch})):[],h=(0,p.isDigitContract)(u),g=[];if(h?g=[]:1==+f&&_?g=[+_]:2==+f&&y&&b&&(g=[+b,+y]),a&&g.push(a),s&&g.push(s),!n)return null;if(!e)return{type:h?"DigitContract":"TickContract",contract_info:(0,F.toJS)(t),key:"".concat(o,"-date_start"),epoch_array:[n],price_array:g};if(d>=1)return(0,p.isDigitContract)(u)?{contract_info:(0,F.toJS)(t),type:"DigitContract",key:"".concat(o,"-date_start"),epoch_array:[n].concat(Vo(m)),price_array:g}:{contract_info:(0,F.toJS)(t),type:"TickContract",key:"".concat(o,"-date_start"),epoch_array:[n].concat(Vo(m)),price_array:g};if(!d){var v=[n,(0,Ce.NQ)(t)||i];return c&&v.push(c),l&&v.push(l),{contract_info:(0,F.toJS)(t),type:"NonTickContract",key:"".concat(o,"-date_start"),epoch_array:v,price_array:g}}return null}(this.contract_info),this.contract_config=(0,Ce.f6)(this.contract_info),this.display_status=(0,p.getDisplayStatus)(this.contract_info),this.is_ended=(0,p.isEnded)(this.contract_info),this.is_digit_contract=(0,p.isDigitContract)(this.contract_info.contract_type),!this.contract_info.barrier&&e.barrier&&this.is_digit_contract&&(this.contract_info.barrier=e.barrier),this.is_digit_contract&&(0,F.extendObservable)(this.digits_info,(0,p.getDigitInfo)(this.digits_info,this.contract_info)),(0,p.isMultiplierContract)(this.contract_info.contract_type)&&t.contract_id&&t.limit_order&&this.populateContractUpdateConfig(this.contract_info)}},{key:"populateContractUpdateConfig",value:function(t){var e=(0,Ce.W9)(t);if(!(0,p.isEqualObject)(this.contract_update_config,e)){Object.assign(this,e),this.contract_update_config=e;var r=t.contract_update,o=t.error;r&&!o&&(this.contract_info.limit_order=Object.assign(this.contract_info.limit_order||{},r))}}},{key:"populateContractUpdateHistory",value:function(t){var e=t.contract_update_history;this.root_store.modules.contract_replay.contract_store.contract_update_history=e.sort((function(t,e){return e.order_date-t.order_date}))}},{key:"updateBarriersArray",value:function(t,e){if(this.barriers_array.length){var r=this.barriers_array[0];if(t){var o=t.contract_type,n=t.barrier,i=t.high_barrier,a=t.low_barrier;Vr(o)&&(n||i)&&(r.updateBarriers(n||i,a),r.updateBarrierColor(e)),t.contract_id&&t.contract_id===this.root_store.modules.contract_replay.contract_id&&Qr({barriers:this.barriers_array,contract_info:t,contract_type:o,is_over:!0})}}else this.barriers_array=this.createBarriersArray(t,e)}},{key:"clearContractUpdateConfigValues",value:function(){Object.assign(this,(0,Ce.W9)(this.contract_info)),this.validation_errors.contract_update_stop_loss=[],this.validation_errors.contract_update_take_profit=[]}},{key:"onChange",value:function(t){var e=t.name,r=t.value;this[e]=r,this.validateProperty(e,this[e])}},{key:"updateLimitOrder",value:function(){var t=this,e=function(t){var e,r,o,n,i=t.has_contract_update_stop_loss,a=t.has_contract_update_take_profit,s=t.contract_update_stop_loss,c=t.contract_update_take_profit,l=t.contract_info,u={},p=a?+c:null;Math.abs(null===(e=l.limit_order)||void 0===e||null===(r=e.take_profit)||void 0===r?void 0:r.order_amount)!==Math.abs(p)&&(u.take_profit=p);var d=i?+s:null;return Math.abs(null===(o=l.limit_order)||void 0===o||null===(n=o.stop_loss)||void 0===n?void 0:n.order_amount)!==Math.abs(d)&&(u.stop_loss=d),u}(this);p.WS.contractUpdate(this.contract_id,e).then((function(e){e.error?t.root_store.common.setServicesError(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ro(Object(r),!0).forEach((function(e){Lo(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({type:e.msg_type},e.error)):(t.populateContractUpdateConfig(e),t.root_store.ui.is_history_tab_active&&p.WS.contractUpdateHistory(t.contract_id).then(t.populateContractUpdateHistory),t.root_store.modules.portfolio.populateContractUpdate(e,t.contract_id))}))}}],r&&No(e.prototype,r),n}(zo.Z),_o=Wo(fo.prototype,"digits_info",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.observable.object({})}}),yo=Wo(fo.prototype,"sell_info",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.observable.object({})}}),bo=Wo(fo.prototype,"contract_config",[to],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),mo=Wo(fo.prototype,"display_status",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"purchased"}}),ho=Wo(fo.prototype,"is_ended",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),go=Wo(fo.prototype,"is_digit_contract",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vo=Wo(fo.prototype,"error_message",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),wo=Wo(fo.prototype,"contract_info",[eo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.observable.object({})}}),Oo=Wo(fo.prototype,"is_static_chart",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),So=Wo(fo.prototype,"end_time",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ko=Wo(fo.prototype,"contract_update_take_profit",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Po=Wo(fo.prototype,"contract_update_stop_loss",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Eo=Wo(fo.prototype,"has_contract_update_take_profit",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Co=Wo(fo.prototype,"has_contract_update_stop_loss",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xo=Wo(fo.prototype,"contract_update_history",[ro],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),jo=Wo(fo.prototype,"margin",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Do=Wo(fo.prototype,"barriers_array",[oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),To=Wo(fo.prototype,"markers_array",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ao=Wo(fo.prototype,"marker",[io],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wo(fo.prototype,"populateConfig",[ao],Object.getOwnPropertyDescriptor(fo.prototype,"populateConfig"),fo.prototype),Wo(fo.prototype,"populateContractUpdateConfig",[so],Object.getOwnPropertyDescriptor(fo.prototype,"populateContractUpdateConfig"),fo.prototype),Wo(fo.prototype,"populateContractUpdateHistory",[co],Object.getOwnPropertyDescriptor(fo.prototype,"populateContractUpdateHistory"),fo.prototype),Wo(fo.prototype,"clearContractUpdateConfigValues",[lo],Object.getOwnPropertyDescriptor(fo.prototype,"clearContractUpdateConfigValues"),fo.prototype),Wo(fo.prototype,"onChange",[uo],Object.getOwnPropertyDescriptor(fo.prototype,"onChange"),fo.prototype),Wo(fo.prototype,"updateLimitOrder",[po],Object.getOwnPropertyDescriptor(fo.prototype,"updateLimitOrder"),fo.prototype),fo),On=function(t,e){return{key:"contract_sold",header:(0,_.localize)("Contract sold"),message:i.createElement(_.Localize,{i18n_default_text:"Contract was sold for <0 />.",components:[i.createElement(u.Money,{key:e,amount:e,currency:t,show_currency:!0})]}),type:"contract_sold",size:"small",should_hide_close_btn:!0,is_auto_close:!0}},Sn=function(){return{key:"contract_sold",header:(0,_.localize)("Contract cancelled"),message:i.createElement(_.Localize,{i18n_default_text:"Contract was cancelled."}),type:"contract_sold",size:"small",should_hide_close_btn:!0,is_auto_close:!0}};function kn(t){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn(t)}function Pn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function En(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Pn(Object(r),!0).forEach((function(e){Cn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Cn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xn(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function jn(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){xn(i,o,n,a,s,"next",t)}function s(t){xn(i,o,n,a,s,"throw",t)}a(void 0)}))}}function Dn(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function Tn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function An(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function zn(t,e){return zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},zn(t,e)}function Mn(t,e){return!e||"object"!==kn(e)&&"function"!=typeof e?Rn(t):e}function Rn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ln(t){return Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ln(t)}function In(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var Nn,Un,Fn,Bn,Hn,Wn,Vn,Gn,qn,Yn,Zn,Xn,Jn,$n,Kn,Qn,ti=(qo=F.observable.ref,Yo=F.observable.ref,Zo=F.action.bound,Xo=F.action.bound,Jo=F.action.bound,$o=F.action.bound,Ko=F.action.bound,Qo=F.action.bound,tn=F.action.bound,en=F.action.bound,rn=F.action.bound,on=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zn(t,e)}(n,t);var e,r,o=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Ln(t);if(e){var n=Ln(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Mn(this,r)}}(n);function n(){var t;Tn(this,n);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return Dn(t=o.call.apply(o,[this].concat(r)),"chart_state",nn,Rn(t)),Dn(t,"contract_store",an,Rn(t)),Dn(t,"is_market_closed",sn,Rn(t)),Dn(t,"is_sell_requested",cn,Rn(t)),Dn(t,"has_error",ln,Rn(t)),Dn(t,"error_message",un,Rn(t)),Dn(t,"error_code",pn,Rn(t)),Dn(t,"is_chart_loading",dn,Rn(t)),Dn(t,"is_chart_scaling",fn,Rn(t)),Dn(t,"is_forward_starting",_n,Rn(t)),Dn(t,"margin",yn,Rn(t)),Dn(t,"contract_id",bn,Rn(t)),Dn(t,"indicative_status",mn,Rn(t)),Dn(t,"contract_info",hn,Rn(t)),Dn(t,"is_static_chart",gn,Rn(t)),t.is_ongoing_contract=!1,t.prev_indicative=0,Dn(t,"contract_update",vn,Rn(t)),t.should_forget_first=!1,t.handleSubscribeProposalOpenContract=function(){var e=jn(regeneratorRuntime.mark((function e(r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.WS.storage.has({proposal_open_contract:1,contract_id:r});case 2:if(!e.sent){e.next=6;break}return p.WS.storage.proposalOpenContract({contract_id:r}).then(o),e.abrupt("return");case 6:if(!t.should_forget_first){e.next=10;break}return e.next=9,p.WS.forgetAll("proposal_open_contract");case 9:t.should_forget_first=!1;case 10:t.subscriber=p.WS.subscribeProposalOpenContract(r,o);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t.subscribeProposalOpenContract=function(){p.WS.wait("authorize").then((function(){t.handleSubscribeProposalOpenContract(t.contract_id,t.populateConfig)}))},t.forgetProposalOpenContract=function(){t.subscriber&&(t.subscriber.unsubscribe(),delete t.subscriber)},t.setAccountSwitcherListener=function(e,r){t.onSwitchAccount((function(){return t.accountSwitcherListener(e,r)}))},t.accountSwitcherListener=function(e,r){return t.has_error?(t.removeErrorMessage(),t.onMount(e)):r.push(p.routes.reports),Promise.resolve()},t.removeAccountSwitcherListener=function(){t.disposeSwitchAccount()},t}return e=n,(r=[{key:"onMount",value:function(t){var e=this;t&&(this.contract_id=t,this.contract_store=new wn(this.root_store,{contract_id:t}),this.subscribeProposalOpenContract(),p.WS.storage.activeSymbols("brief"),p.WS.setOnReconnect((function(){e.root_store.client.is_switching||e.subscribeProposalOpenContract()})))}},{key:"onUnmount",value:function(){this.forgetProposalOpenContract(this.contract_id,this.populateConfig),this.contract_id=null,this.is_ongoing_contract=!1,this.is_static_chart=!1,this.is_chart_loading=!0,this.contract_info={},this.indicative_status=null,this.prev_indicative=0,this.chart_state="",this.root_store.ui.toggleHistoryTab(!1),p.WS.removeOnReconnect()}},{key:"populateConfig",value:function(t){if(this.switch_account_listener){if("error"in t){var e=t.error,r=e.code,o=e.message;return this.has_error=!0,this.is_chart_loading=!1,this.error_message=o,void(this.error_code=r)}if((0,p.isEmptyObject)(t.proposal_open_contract))return this.has_error=!0,this.error_message=(0,_.localize)("Sorry, you can't view this contract because it doesn't belong to this account."),this.should_forget_first=!0,void(this.is_chart_loading=!1);if(+t.proposal_open_contract.contract_id===this.contract_id){this.contract_info=t.proposal_open_contract,this.contract_update=t.proposal_open_contract.limit_order;var n=this.prev_indicative,i=+this.contract_info.bid_price;this.indicative_status=i>n?"profit":i<n?"loss":null,this.prev_indicative=i;var a=!!this.contract_info.is_forward_starting||(0,p.isForwardStarting)(this.contract_info.shortcode,this.contract_info.purchase_time);this.is_forward_starting=a,this.contract_store.populateConfig(this.contract_info);var s=this.contract_store.end_time;this.updateMargin((s||this.contract_info.date_expiry)-this.contract_info.date_start),s||(this.is_ongoing_contract=!0),s&&(this.is_ongoing_contract?this.is_static_chart=!1:this.is_static_chart=!0),this.contract_info.is_sold&&this.contract_store.cacheProposalOpenContractResponse(t)}}}},{key:"updateMargin",value:function(t){var e=this.contract_store.contract_config.granularity;this.margin=Math.floor(e?3*e:Math.max(300,30*t/3600||0))}},{key:"chartStateChange",value:function(t,e){var r=this;this.chart_state=t;switch(t){case"INITIAL":this.is_chart_scaling=!1,this.is_chart_loading||(this.is_chart_loading=!0);break;case"READY":setTimeout((0,F.action)((function(){return r.is_chart_scaling=!0})),10);break;case"SCROLL_TO_LEFT":setTimeout((0,F.action)((function(){r.is_chart_loading=!1})),20);break;case"MARKET_STATE_CHANGE":e&&"isClosed"in e&&(this.is_market_closed=e.isClosed)}}},{key:"onClickCancel",value:function(t){var e=this;t&&p.WS.cancelContract(t).then((function(t){t.error?e.root_store.common.setServicesError(En({type:t.msg_type},t.error)):e.root_store.ui.addNotificationMessage(Sn())}))}},{key:"onClickSell",value:function(t){var e=this.contract_info.bid_price;t&&e&&(this.is_sell_requested=!0,p.WS.sell(t,e).then(this.handleSell))}},{key:"handleSell",value:function(t){t.error?(this.is_sell_requested=!1,this.root_store.common.setServicesError(En({type:t.msg_type},t.error))):!t.error&&t.sell&&(this.is_sell_requested=!1,this.sell_info={sell_price:t.sell.sold_for,transaction_id:t.sell.transaction_id},this.root_store.ui.addNotificationMessage(On(this.root_store.client.currency,t.sell.sold_for)))}},{key:"removeErrorMessage",value:function(){this.error_message="",this.has_error=!1}}])&&An(e.prototype,r),n}(zo.Z),nn=In(on.prototype,"chart_state",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),an=In(on.prototype,"contract_store",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{contract_info:{}}}}),sn=In(on.prototype,"is_market_closed",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),cn=In(on.prototype,"is_sell_requested",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ln=In(on.prototype,"has_error",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),un=In(on.prototype,"error_message",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),pn=In(on.prototype,"error_code",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),dn=In(on.prototype,"is_chart_loading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),fn=In(on.prototype,"is_chart_scaling",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_n=In(on.prototype,"is_forward_starting",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),yn=In(on.prototype,"margin",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=In(on.prototype,"contract_id",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=In(on.prototype,"indicative_status",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=In(on.prototype,"contract_info",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.observable.object({})}}),gn=In(on.prototype,"is_static_chart",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vn=In(on.prototype,"contract_update",[Yo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.observable.object({})}}),In(on.prototype,"onMount",[Zo],Object.getOwnPropertyDescriptor(on.prototype,"onMount"),on.prototype),In(on.prototype,"onUnmount",[Xo],Object.getOwnPropertyDescriptor(on.prototype,"onUnmount"),on.prototype),In(on.prototype,"populateConfig",[Jo],Object.getOwnPropertyDescriptor(on.prototype,"populateConfig"),on.prototype),In(on.prototype,"updateMargin",[$o],Object.getOwnPropertyDescriptor(on.prototype,"updateMargin"),on.prototype),In(on.prototype,"chartStateChange",[Ko],Object.getOwnPropertyDescriptor(on.prototype,"chartStateChange"),on.prototype),In(on.prototype,"onClickCancel",[Qo],Object.getOwnPropertyDescriptor(on.prototype,"onClickCancel"),on.prototype),In(on.prototype,"onClickSell",[tn],Object.getOwnPropertyDescriptor(on.prototype,"onClickSell"),on.prototype),In(on.prototype,"handleSell",[en],Object.getOwnPropertyDescriptor(on.prototype,"handleSell"),on.prototype),In(on.prototype,"removeErrorMessage",[rn],Object.getOwnPropertyDescriptor(on.prototype,"removeErrorMessage"),on.prototype),on),ei={key:"switch_to_tick_chart",header:(0,_.localize)("This chart display is not ideal for tick contracts"),message:i.createElement(_.Localize,{i18n_default_text:"Please change the chart duration to tick for a better trading experience."}),type:"info"};function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function oi(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function ni(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ii(t,e){return ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ii(t,e)}function ai(t,e){return!e||"object"!==ri(e)&&"function"!=typeof e?si(t):e}function si(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ci(t){return ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ci(t)}function li(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var ui,pi,di,fi,_i,yi,bi,mi,hi,gi,vi,wi,Oi,Si,ki,Pi,Ei,Ci,xi,ji,Di,Ti,Ai,zi,Mi,Ri,Li,Ii,Ni,Ui,Fi=(Nn=F.observable.shallow,Un=F.action.bound,Fn=F.action.bound,Bn=F.action.bound,Hn=F.action.bound,Wn=F.action.bound,Vn=F.action.bound,Gn=F.action.bound,qn=F.action.bound,Yn=F.action.bound,Zn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(n,t);var e,r,o=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=ci(t);if(e){var n=ci(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return ai(this,r)}}(n);function n(t){var e,r=t.root_store;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),oi(e=o.call(this,{root_store:r}),"contracts",Xn,si(e)),e.contracts_map={},oi(e,"has_error",Jn,si(e)),oi(e,"error_message",$n,si(e)),oi(e,"granularity",Kn,si(e)),oi(e,"chart_type",Qn,si(e)),e.applicable_contracts=function(){var t=e.root_store.modules.trade,r=t.symbol,o=t.contract_type;if(!o||!r)return[];var n=(0,O.r2)()[o].trade_types,i=(0,S.a)(o);return i&&(n=["CALLE","PUTE","CALL","PUT"]),e.contracts.filter((function(t){return t.contract_info.underlying===r})).filter((function(t){var e=t.contract_info;return!((0,p.isMultiplierContract)(e.contract_type)&&(0,p.isEnded)(t.contract_info))})).filter((function(t){var e=t.contract_info,r=-1!==n.indexOf(e.contract_type);return r&&e.barrier&&e.entry_tick&&i?"".concat(+e.entry_tick)==="".concat(+e.barrier)?"rise_fall"===o||"rise_fall_equal"===o:"high_low"===o:r}))},e.onSwitchAccount(e.accountSwitchListener),e}return e=n,r=[{key:"updateChartType",value:function(t){p.LocalStore.set("contract_trade.chart_type",t),this.chart_type=t}},{key:"updateGranularity",value:function(t){0===t&&-1===["mountain","line","colored_line","spline","baseline"].indexOf(this.chart_type)&&(this.chart_type="mountain"),p.LocalStore.set("contract_trade.granularity",t),this.granularity=t,0===this.granularity&&this.root_store.ui.removeNotificationMessage(ei)}},{key:"markers_array",get:function(){var t=this.applicable_contracts().map((function(t){return t.marker})).filter((function(t){return t})).map((function(t){return(0,F.toJS)(t)}));return t.length&&(t[t.length-1].is_last_contract=!0),t}},{key:"addContract",value:function(t){var e=t.barrier,r=t.contract_id,o=t.contract_type,n=t.start_time,i=t.longcode,a=t.underlying,s=t.is_tick_contract,c=t.limit_order,l=void 0===c?{}:c;if(!this.contracts_map[r]){var u=new wn(this.root_store,{contract_id:r});u.populateConfig({date_start:n,barrier:e,contract_type:o,longcode:i,underlying:a,limit_order:l}),this.contracts.push(u),this.contracts_map[r]=u,s&&0!==this.granularity&&(0,p.isDesktop)()&&this.root_store.ui.addNotificationMessage(ei)}}},{key:"removeContract",value:function(t){var e=t.contract_id;this.contracts=this.contracts.filter((function(t){return t.contract_id!==e})),delete this.contracts_map[e]}},{key:"accountSwitchListener",value:function(){return this.has_error&&this.clearError(),Promise.resolve()}},{key:"onUnmount",value:function(){this.disposeSwitchAccount()}},{key:"updateProposal",value:function(t){if("error"in t)return this.has_error=!0,void(this.error_message=t.error.message);if(t.proposal_open_contract){var e=+t.proposal_open_contract.contract_id,r=this.contracts_map[e];r.populateConfig(t.proposal_open_contract),t.proposal_open_contract.is_sold&&(this.root_store.ui.removeNotificationMessage(ei),r.cacheProposalOpenContractResponse(t))}}},{key:"last_contract",get:function(){var t=this.applicable_contracts(),e=t.length;return e>0?t[e-1]:{}}},{key:"clearError",value:function(){this.error_message="",this.has_error=!1}},{key:"getContractById",value:function(t){return this.contracts_map[t]||this.root_store.modules.contract_replay.contract_store}}],r&&ni(e.prototype,r),n}(zo.Z),Xn=li(Zn.prototype,"contracts",[Nn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Jn=li(Zn.prototype,"has_error",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$n=li(Zn.prototype,"error_message",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Kn=li(Zn.prototype,"granularity",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return+p.LocalStore.get("contract_trade.granularity")||0}}),Qn=li(Zn.prototype,"chart_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.LocalStore.get("contract_trade.chart_type")||"mountain"}}),li(Zn.prototype,"updateChartType",[Un],Object.getOwnPropertyDescriptor(Zn.prototype,"updateChartType"),Zn.prototype),li(Zn.prototype,"updateGranularity",[Fn],Object.getOwnPropertyDescriptor(Zn.prototype,"updateGranularity"),Zn.prototype),li(Zn.prototype,"markers_array",[F.computed],Object.getOwnPropertyDescriptor(Zn.prototype,"markers_array"),Zn.prototype),li(Zn.prototype,"addContract",[Bn],Object.getOwnPropertyDescriptor(Zn.prototype,"addContract"),Zn.prototype),li(Zn.prototype,"removeContract",[Hn],Object.getOwnPropertyDescriptor(Zn.prototype,"removeContract"),Zn.prototype),li(Zn.prototype,"accountSwitchListener",[Wn],Object.getOwnPropertyDescriptor(Zn.prototype,"accountSwitchListener"),Zn.prototype),li(Zn.prototype,"onUnmount",[Vn],Object.getOwnPropertyDescriptor(Zn.prototype,"onUnmount"),Zn.prototype),li(Zn.prototype,"updateProposal",[Gn],Object.getOwnPropertyDescriptor(Zn.prototype,"updateProposal"),Zn.prototype),li(Zn.prototype,"last_contract",[F.computed],Object.getOwnPropertyDescriptor(Zn.prototype,"last_contract"),Zn.prototype),li(Zn.prototype,"clearError",[qn],Object.getOwnPropertyDescriptor(Zn.prototype,"clearError"),Zn.prototype),li(Zn.prototype,"getContractById",[Yn],Object.getOwnPropertyDescriptor(Zn.prototype,"getContractById"),Zn.prototype),Zn),Bi=r("./Stores/Modules/CFD/cfd-store.js"),Hi=r("../../../node_modules/lodash.throttle/index.js"),Wi=r.n(Hi),Vi=r("../../../node_modules/mobx-utils/mobx-utils.module.js"),Gi=r("./Constants/index.js"),qi=function(t){return!!(0,Gi.n2)()[t.contract_type]||!!t.is_forward_starting},Yi=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,o=parseFloat(t.buy_price),n=parseFloat(t.payout),i=(0,Pe.rh)(e,(0,De.cS)(t.shortcode).underlying),a=t.transaction_id||t.transaction_ids&&t.transaction_ids.buy;return{contract_info:t,details:t.longcode.replace(/\n/g,"<br />"),display_name:i,id:t.contract_id,indicative:isNaN(r)||!r?0:r,payout:n,purchase:o,reference:+a,type:t.contract_type,is_unsupported:qi(t),contract_update:t.limit_order}},Zi=r("./Stores/Modules/Portfolio/Helpers/details.js");function Xi(t){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xi(t)}function Ji(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function $i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Ki(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$i(Object(r),!0).forEach((function(e){Qi(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Qi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ta(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function ea(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){ta(i,o,n,a,s,"next",t)}function s(t){ta(i,o,n,a,s,"throw",t)}a(void 0)}))}}function ra(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function oa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function na(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ia(t,e){return ia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ia(t,e)}function aa(t,e){return!e||"object"!==Xi(e)&&"function"!=typeof e?sa(t):e}function sa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ca(t){return ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ca(t)}function la(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var ua=(ui=F.observable.shallow,pi=F.observable.shallow,di=F.observable.shallow,fi=F.action.bound,_i=F.action.bound,yi=F.action.bound,bi=F.action.bound,mi=F.action.bound,hi=F.action.bound,gi=F.action.bound,vi=F.action.bound,wi=F.action.bound,Oi=F.action.bound,Si=F.action.bound,ki=F.action.bound,Pi=F.action.bound,Ei=F.action.bound,Ci=F.action.bound,xi=F.action.bound,ji=F.action.bound,Di=F.action.bound,Ti=F.action.bound,Ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ia(t,e)}(a,t);var e,r,o,n,i=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=ca(t);if(e){var n=ca(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return aa(this,r)}}(a);function a(){var t;oa(this,a);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return ra(t=i.call.apply(i,[this].concat(r)),"positions",zi,sa(t)),ra(t,"all_positions",Mi,sa(t)),t.positions_map={},ra(t,"is_loading",Ri,sa(t)),ra(t,"error",Li,sa(t)),t.getPositionById=(0,Vi.kq)((function(e){return t.positions.find((function(t){return+t.id==+e}))})),t.responseQueue=[],ra(t,"active_positions",Ii,sa(t)),ra(t,"initializePortfolio",Ni,sa(t)),t.deepClone=function(t){return JSON.parse(JSON.stringify(t))},t.proposalOpenContractQueueHandler=function(e){t.responseQueue.push(e),t.throttledUpdatePositions()},ra(t,"populateResultDetails",Ui,sa(t)),t.updatePositions=function(){t.responseQueue.forEach((function(e){return t.proposalOpenContractHandler(e)})),t.responseQueue=[],t.setActivePositions()},t.throttledUpdatePositions=Wi()(t.updatePositions,500),t}return e=a,r=[{key:"clearTable",value:function(){this.positions=[],this.positions_map={},this.is_loading=!1,this.error="",this.updatePositions(),this.has_subscribed_to_poc_and_transaction&&p.WS.forgetAll("proposal_open_contract","transaction"),this.has_subscribed_to_poc_and_transaction=!1}},{key:"portfolioHandler",value:function(t){var e=this;this.is_loading=!1,"error"in t?this.error=t.error.message:(this.error="",t.portfolio.contracts&&(this.positions=t.portfolio.contracts.map((function(t){return Yi(t,e.root_store.modules.trade.active_symbols)})).sort((function(t,e){return e.reference-t.reference})),this.positions.forEach((function(t){e.positions_map[t.id]=t})),this.updatePositions()))}},{key:"onBuyResponse",value:function(t){var e={contract_id:t.contract_id,longcode:t.longcode,contract_type:t.contract_type};this.pushNewPosition(e)}},{key:"transactionHandler",value:(n=ea(regeneratorRuntime.mark((function t(e){var r,o,n,i,a,s,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("error"in e&&(this.error=e.error.message),e.transaction){t.next=3;break}return t.abrupt("return");case 3:if(r=e.transaction,o=r.contract_id,n=r.action,i=r.longcode,"buy"!==n){t.next=8;break}this.onBuyResponse({contract_id:o,longcode:i,contract_type:""}),t.next=14;break;case 8:if("sell"!==n){t.next=14;break}if(a=this.getPositionIndexById(o),this.positions[a]){t.next=12;break}return t.abrupt("return");case 12:this.positions[a].is_loading=!0,s=p.WS.subscribeProposalOpenContract(o,(function(t){c.updateContractTradeStore(t),c.updateContractReplayStore(t),c.populateResultDetails(t),s.unsubscribe()}));case 14:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"updateContractTradeStore",value:function(t){var e=this.root_store.modules.contract_trade,r=!(0,p.isEmptyObject)(t.proposal_open_contract),o=!!t.error;(r||o)&&r&&(e.addContract(this.deepClone(t.proposal_open_contract)),e.updateProposal(this.deepClone(t)))}},{key:"updateContractReplayStore",value:function(t){var e,r=this.root_store.modules.contract_replay;r.contract_id===(null===(e=t.proposal_open_contract)||void 0===e?void 0:e.contract_id)&&r.populateConfig(t)}},{key:"updateTradeStore",value:function(t,e,r){var o=this.root_store.modules.trade;r||o.setPurchaseSpotBarrier(t,e),o.updateLimitOrderBarriers(t,e)}},{key:"proposalOpenContractHandler",value:function(t){if("error"in t)return this.updateContractTradeStore(t),void this.updateContractReplayStore(t);var e=t.proposal_open_contract,r=this.positions_map[e.contract_id];if(r){this.updateContractTradeStore(t),this.updateContractReplayStore(t);var o=Yi(e,this.root_store.modules.trade.active_symbols,r.indicative);Object.assign(r,o);var n=r.indicative,i=+e.bid_price,a=+e.profit;if(e.barrier&&(r.barrier=+e.barrier),e.entry_spot&&(r.entry_spot=+e.entry_spot),r.indicative=i,r.profit_loss=a,r.is_valid_to_sell=(0,p.isValidToSell)(e),r.contract_info=e,e.tick_count){var s=r.current_tick>(0,p.getCurrentTick)(e)?r.current_tick:(0,p.getCurrentTick)(e);r.current_tick=s}r.status=i>n?"profit":i<n?"loss":null,this.hovered_position_id===r.id&&(1===r.contract_info.is_sold?this.updateTradeStore(!1,r):this.updateTradeStore(!0,r,!0)),1===r.contract_info.is_sold&&this.populateResultDetails(t)}}},{key:"onClickCancel",value:function(t){var e=this,r=this.getPositionIndexById(t);this.positions[r].is_sell_requested||(this.positions[r].is_sell_requested=!0,t&&p.WS.cancelContract(t).then((function(t){t.error?e.root_store.common.setServicesError(Ki({type:t.msg_type},t.error)):e.root_store.ui.addNotificationMessage(Sn())})))}},{key:"onClickSell",value:function(t){var e=this.getPositionIndexById(t);if(!this.positions[e].is_sell_requested){var r=this.positions[e].contract_info.bid_price;this.positions[e].is_sell_requested=!0,t&&"number"==typeof r&&p.WS.sell(t,r).then(this.handleSell)}}},{key:"handleSell",value:function(t){if(t.error){var e=this.getPositionIndexById(t.echo_req.sell);this.positions[e].is_sell_requested=!1,"InvalidToken"!==t.error.code&&this.root_store.common.setServicesError(Ki({type:t.msg_type},t.error))}else!t.error&&t.sell&&(this.root_store.modules.contract_trade.sell_info={sell_price:t.sell.sold_for,transaction_id:t.sell.transaction_id},this.root_store.ui.addNotificationMessage(On(this.root_store.client.currency,t.sell.sold_for)))}},{key:"populateContractUpdate",value:function(t,e){var r=t.contract_update,o=this.getPositionById(e);o&&(Object.assign(o.contract_update,r),this.updatePositions())}},{key:"pushNewPosition",value:function(t){var e=Yi(t,this.root_store.modules.trade.active_symbols);this.positions_map[e.id]||(this.positions.unshift(e),this.positions_map[e.id]=e,this.updatePositions())}},{key:"removePositionById",value:function(t){var e=this.getPositionIndexById(t);this.positions.splice(e,1),delete this.positions_map[t],this.updatePositions(),this.root_store.modules.contract_trade.removeContract({contract_id:t})}},{key:"accountSwitcherListener",value:(o=ea(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializePortfolio(!0);case 2:return t.abrupt("return",Promise.resolve());case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"onHoverPosition",value:function(t,e){var r=this.root_store.modules.trade.symbol;e.contract_info.underlying===r&&!(0,p.isEnded)(e.contract_info)&&(0,p.isMultiplierContract)(e.type)&&(this.hovered_position_id=t?e.id:null,this.updateTradeStore(t,e))}},{key:"preSwitchAccountListener",value:function(){return this.clearTable(),Promise.resolve()}},{key:"logoutListener",value:function(){return this.clearTable(),Promise.resolve()}},{key:"networkStatusChangeListener",value:function(t){this.is_loading=!t}},{key:"onMount",value:function(){var t=this;this.onPreSwitchAccount(this.preSwitchAccountListener),this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),this.onLogout(this.logoutListener),0!==this.positions.length||this.has_subscribed_to_poc_and_transaction||(this.root_store.client.is_logged_in?this.initializePortfolio():(0,F.reaction)((function(){return t.root_store.client.is_logged_in}),(function(){t.root_store.client.is_logged_in&&t.initializePortfolio()})))}},{key:"onUnmount",value:function(){this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout()}},{key:"getPositionIndexById",value:function(t){return this.positions.findIndex((function(e){return+e.id==+t}))}},{key:"totals",get:function(){var t=0,e=0,r=0;return this.positions.forEach((function(o){t+=+o.indicative,e+=+o.payout,r+=+o.purchase})),{indicative:t,payout:e,purchase:r}}},{key:"setActivePositions",value:function(){this.active_positions=this.positions.filter((function(t){return!(0,Ce.NQ)(t.contract_info)})),this.all_positions=function(t){return function(t){if(Array.isArray(t))return Ji(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ji(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ji(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.positions)}},{key:"is_active_empty",get:function(){return!this.is_loading&&0===this.active_positions.length}},{key:"active_positions_count",get:function(){return this.active_positions.length||0}},{key:"is_empty",get:function(){return!this.is_loading&&0===this.all_positions.length}}],r&&na(e.prototype,r),a}(zo.Z),zi=la(Ai.prototype,"positions",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Mi=la(Ai.prototype,"all_positions",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ri=la(Ai.prototype,"is_loading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Li=la(Ai.prototype,"error",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ii=la(Ai.prototype,"active_positions",[di],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ni=la(Ai.prototype,"initializePortfolio",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var t=this;return function(){var e=ea(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t.has_subscribed_to_poc_and_transaction||r)&&t.clearTable(),t.is_loading=!0,e.next=4,p.WS.wait("authorize");case 4:p.WS.portfolio().then(t.portfolioHandler),p.WS.subscribeProposalOpenContract(null,t.proposalOpenContractQueueHandler),p.WS.subscribeTransaction(t.transactionHandler),t.has_subscribed_to_poc_and_transaction=!0;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),la(Ai.prototype,"clearTable",[_i],Object.getOwnPropertyDescriptor(Ai.prototype,"clearTable"),Ai.prototype),la(Ai.prototype,"portfolioHandler",[yi],Object.getOwnPropertyDescriptor(Ai.prototype,"portfolioHandler"),Ai.prototype),la(Ai.prototype,"onBuyResponse",[bi],Object.getOwnPropertyDescriptor(Ai.prototype,"onBuyResponse"),Ai.prototype),la(Ai.prototype,"transactionHandler",[mi],Object.getOwnPropertyDescriptor(Ai.prototype,"transactionHandler"),Ai.prototype),la(Ai.prototype,"proposalOpenContractHandler",[hi],Object.getOwnPropertyDescriptor(Ai.prototype,"proposalOpenContractHandler"),Ai.prototype),la(Ai.prototype,"onClickCancel",[gi],Object.getOwnPropertyDescriptor(Ai.prototype,"onClickCancel"),Ai.prototype),la(Ai.prototype,"onClickSell",[vi],Object.getOwnPropertyDescriptor(Ai.prototype,"onClickSell"),Ai.prototype),la(Ai.prototype,"handleSell",[wi],Object.getOwnPropertyDescriptor(Ai.prototype,"handleSell"),Ai.prototype),Ui=la(Ai.prototype,"populateResultDetails",[Oi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var t=this;return function(e){var r=e.proposal_open_contract,o=t.getPositionIndexById(r.contract_id);t.positions[o]&&(t.positions[o].contract_info=r,t.positions[o].duration=(0,Zi.Cc)(r),t.positions[o].duration_unit=(0,Zi.BX)((0,Zi.H3)(r)),t.positions[o].exit_spot=r.exit_tick||r.current_spot,t.positions[o].is_valid_to_sell=(0,p.isValidToSell)(r),t.positions[o].result=(0,p.getDisplayStatus)(r),t.positions[o].profit_loss=+r.profit,t.positions[o].sell_time=(0,Ce.NQ)(r)||r.current_spot_time,t.positions[o].sell_price=r.sell_price,t.positions[o].status="complete",t.positions[o].contract_info.barrier&&t.positions[o].contract_info.entry_spot||(t.positions[o].contract_info.barrier=t.positions[o].barrier,t.positions[o].contract_info.entry_spot=t.positions[o].entry_spot),(0,p.isUserSold)(r)&&(t.positions[o].exit_spot="-"),t.positions[o].is_loading=!1)}}}),la(Ai.prototype,"populateContractUpdate",[Si],Object.getOwnPropertyDescriptor(Ai.prototype,"populateContractUpdate"),Ai.prototype),la(Ai.prototype,"pushNewPosition",[ki],Object.getOwnPropertyDescriptor(Ai.prototype,"pushNewPosition"),Ai.prototype),la(Ai.prototype,"removePositionById",[Pi],Object.getOwnPropertyDescriptor(Ai.prototype,"removePositionById"),Ai.prototype),la(Ai.prototype,"onHoverPosition",[Ei],Object.getOwnPropertyDescriptor(Ai.prototype,"onHoverPosition"),Ai.prototype),la(Ai.prototype,"logoutListener",[Ci],Object.getOwnPropertyDescriptor(Ai.prototype,"logoutListener"),Ai.prototype),la(Ai.prototype,"networkStatusChangeListener",[xi],Object.getOwnPropertyDescriptor(Ai.prototype,"networkStatusChangeListener"),Ai.prototype),la(Ai.prototype,"onMount",[ji],Object.getOwnPropertyDescriptor(Ai.prototype,"onMount"),Ai.prototype),la(Ai.prototype,"onUnmount",[Di],Object.getOwnPropertyDescriptor(Ai.prototype,"onUnmount"),Ai.prototype),la(Ai.prototype,"totals",[F.computed],Object.getOwnPropertyDescriptor(Ai.prototype,"totals"),Ai.prototype),la(Ai.prototype,"setActivePositions",[Ti],Object.getOwnPropertyDescriptor(Ai.prototype,"setActivePositions"),Ai.prototype),la(Ai.prototype,"is_active_empty",[F.computed],Object.getOwnPropertyDescriptor(Ai.prototype,"is_active_empty"),Ai.prototype),la(Ai.prototype,"active_positions_count",[F.computed],Object.getOwnPropertyDescriptor(Ai.prototype,"active_positions_count"),Ai.prototype),la(Ai.prototype,"is_empty",[F.computed],Object.getOwnPropertyDescriptor(Ai.prototype,"is_empty"),Ai.prototype),Ai),pa=r("../../../node_modules/lodash.debounce/index.js"),da=r.n(pa);function fa(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function _a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?fa(Object(r),!0).forEach((function(e){ya(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fa(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ya(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ba=function(t,e){var r=(0,p.toMoment)().startOf("day").unix();return e&&r>e?e:(0,p.epochToMoment)(r).add(1,"d").subtract(1,"s").unix()},ma=function(t,e,r,o){return(0,p.toMoment)().startOf("day").unix()>o?r:t&&e?e:r},ha=function(t,e,r,o){return(0,p.toMoment)().startOf("day").unix()>o?!!t||e:e?r||t:!!t||!1};const ga=function(t,e,r){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return _a(_a({},ha(t,o,r,e)&&{date_from:ma(o,r,t,e)}),(e||o)&&{date_to:ba(0,e)})};function va(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function wa(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?va(Object(r),!0).forEach((function(e){Oa(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):va(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Oa(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Sa,ka,Pa,Ea,Ca,xa,ja,Da,Ta,Aa,za,Ma,Ra,La,Ia,Na,Ua,Fa,Ba;function Ha(t){return Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(t)}function Wa(t){return function(t){if(Array.isArray(t))return Va(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Va(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Va(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Va(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Ga(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function qa(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Ga(i,o,n,a,s,"next",t)}function s(t){Ga(i,o,n,a,s,"throw",t)}a(void 0)}))}}function Ya(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function Za(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xa(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ja(t,e){return Ja=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ja(t,e)}function $a(t,e){return!e||"object"!==Ha(e)&&"function"!=typeof e?Ka(t):e}function Ka(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qa(t){return Qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qa(t)}function ts(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var es,rs,os,ns,is,as,ss,cs,ls,us,ps,ds,fs,_s,ys,bs,ms,hs,gs,vs,ws,Os,Ss,ks=(Sa=F.action.bound,ka=F.action.bound,Pa=F.action.bound,Ea=F.action.bound,Ca=F.action.bound,xa=F.action.bound,ja=F.action.bound,Da=F.action.bound,Ta=F.action.bound,Aa=F.action.bound,za=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ja(t,e)}(a,t);var e,r,o,n,i=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Qa(t);if(e){var n=Qa(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return $a(this,r)}}(a);function a(){var t;Za(this,a);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return Ya(t=i.call.apply(i,[this].concat(r)),"data",Ma,Ka(t)),Ya(t,"date_from",Ra,Ka(t)),Ya(t,"date_to",La,Ka(t)),Ya(t,"error",Ia,Ka(t)),Ya(t,"has_loaded_all",Na,Ka(t)),Ya(t,"is_loading",Ua,Ka(t)),Ya(t,"filtered_date_range",Fa,Ka(t)),Ya(t,"client_loginid",Ba,Ka(t)),t.fetchOnScroll=da()((function(e){e<1500&&t.fetchNextBatch()}),150),t}return e=a,r=[{key:"total_profit",get:function(){return this.data.reduce((function(t,e){var r=Number(parseFloat(e.buy_price));return t+(Number(parseFloat(e.sell_price))-r)}),0)}},{key:"is_empty",get:function(){return!this.is_loading&&0===this.data.length}},{key:"has_selected_date",get:function(){return!(!this.date_from&&!this.date_to)}},{key:"shouldFetchNextBatch",value:function(){return!this.has_loaded_all&&!this.is_loading}},{key:"fetchNextBatch",value:(n=qa(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.shouldFetchNextBatch()){t.next=2;break}return t.abrupt("return");case 2:return this.is_loading=!0,t.next=5,p.WS.profitTable(50,this.data.length,ga(this.date_from,this.date_to,0,!1));case 5:e=t.sent,this.profitTableResponseHandler(e);case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"profitTableResponseHandler",value:function(t){var e=this;if("error"in t)this.error=t.error.message;else{var r=t.profit_table.transactions.map((function(t){return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o="DD MMM YYYY HH:mm:ss",n="".concat((0,p.toMoment)(+t.purchase_time).format(o)),i=t.purchase_time,a="".concat((0,p.toMoment)(+t.sell_time).format(o)),s=parseFloat(t.payout),c=parseFloat(t.sell_price),l=parseFloat(t.buy_price),u=(0,p.formatMoney)(e,Number(c-l),!0),d=(0,Pe.rh)(r,(0,De.cS)(t.shortcode).underlying);return wa(wa({},t),{payout:s,sell_price:c,buy_price:l,profit_loss:u,sell_time:a,purchase_time:n,display_name:d,purchase_time_unix:i})}(t,e.root_store.client.currency,e.root_store.modules.trade.active_symbols)}));this.data=[].concat(Wa(this.data),Wa(r)),this.has_loaded_all=r.length<50,this.is_loading=!1}}},{key:"handleScroll",value:function(t){var e=t.target,r=e.scrollTop,o=e.scrollHeight-(r+e.clientHeight);this.fetchOnScroll(o)}},{key:"networkStatusChangeListener",value:function(t){this.is_loading=!t}},{key:"onMount",value:(o=qa(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.assertHasValidCache(this.client_loginid,this.clearDateFilter,p.WS.forgetAll.bind(null,"proposal")),this.client_loginid=this.root_store.client.loginid,this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),t.next=6,p.WS.wait("authorize");case 6:this.clearTable(),this.fetchNextBatch();case 8:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"onUnmount",value:function(){this.disposeSwitchAccount(),p.WS.forgetAll("proposal")}},{key:"totals",get:function(){var t=0;return this.data.forEach((function(e){t+=parseFloat(e.profit_loss.replace(/,/g,""))})),{profit_loss:t.toString()}}},{key:"accountSwitcherListener",value:function(){var t=this;return new Promise((function(e){return t.clearTable(),t.clearDateFilter(),e(t.fetchNextBatch())}))}},{key:"clearTable",value:function(){this.data=[],this.has_loaded_all=!1,this.is_loading=!1}},{key:"clearDateFilter",value:function(){this.date_from=null,this.date_to=(0,p.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix()}},{key:"handleDateChange",value:function(t){var e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.date_range;this.filtered_date_range=n,this.date_from=null!==(e=null==t?void 0:t.from)&&void 0!==e?e:t.is_batch?null:this.date_from,this.date_to=null!==(r=null==t?void 0:t.to)&&void 0!==r?r:this.date_to,this.clearTable(),this.fetchNextBatch()}}],r&&Xa(e.prototype,r),a}(zo.Z),Ma=ts(za.prototype,"data",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ra=ts(za.prototype,"date_from",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),La=ts(za.prototype,"date_to",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,p.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix()}}),Ia=ts(za.prototype,"error",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Na=ts(za.prototype,"has_loaded_all",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ua=ts(za.prototype,"is_loading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fa=ts(za.prototype,"filtered_date_range",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ba=ts(za.prototype,"client_loginid",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ts(za.prototype,"total_profit",[F.computed],Object.getOwnPropertyDescriptor(za.prototype,"total_profit"),za.prototype),ts(za.prototype,"is_empty",[F.computed],Object.getOwnPropertyDescriptor(za.prototype,"is_empty"),za.prototype),ts(za.prototype,"has_selected_date",[F.computed],Object.getOwnPropertyDescriptor(za.prototype,"has_selected_date"),za.prototype),ts(za.prototype,"fetchNextBatch",[Sa],Object.getOwnPropertyDescriptor(za.prototype,"fetchNextBatch"),za.prototype),ts(za.prototype,"profitTableResponseHandler",[ka],Object.getOwnPropertyDescriptor(za.prototype,"profitTableResponseHandler"),za.prototype),ts(za.prototype,"handleScroll",[Pa],Object.getOwnPropertyDescriptor(za.prototype,"handleScroll"),za.prototype),ts(za.prototype,"networkStatusChangeListener",[Ea],Object.getOwnPropertyDescriptor(za.prototype,"networkStatusChangeListener"),za.prototype),ts(za.prototype,"onMount",[Ca],Object.getOwnPropertyDescriptor(za.prototype,"onMount"),za.prototype),ts(za.prototype,"onUnmount",[xa],Object.getOwnPropertyDescriptor(za.prototype,"onUnmount"),za.prototype),ts(za.prototype,"totals",[F.computed],Object.getOwnPropertyDescriptor(za.prototype,"totals"),za.prototype),ts(za.prototype,"accountSwitcherListener",[ja],Object.getOwnPropertyDescriptor(za.prototype,"accountSwitcherListener"),za.prototype),ts(za.prototype,"clearTable",[Da],Object.getOwnPropertyDescriptor(za.prototype,"clearTable"),za.prototype),ts(za.prototype,"clearDateFilter",[Ta],Object.getOwnPropertyDescriptor(za.prototype,"clearDateFilter"),za.prototype),ts(za.prototype,"handleDateChange",[Aa],Object.getOwnPropertyDescriptor(za.prototype,"handleDateChange"),za.prototype),za);function Ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Es(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ps(Object(r),!0).forEach((function(e){Cs(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ps(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Cs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xs(t){return xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(t)}function js(t){return function(t){if(Array.isArray(t))return Ds(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ds(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ds(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ds(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Ts(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function As(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Ts(i,o,n,a,s,"next",t)}function s(t){Ts(i,o,n,a,s,"throw",t)}a(void 0)}))}}function zs(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function Ms(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rs(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ls(t,e){return Ls=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ls(t,e)}function Is(t,e){return!e||"object"!==xs(e)&&"function"!=typeof e?Ns(t):e}function Ns(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Us(t){return Us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Us(t)}function Fs(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var Bs=(es=F.action.bound,rs=F.action.bound,os=F.action.bound,ns=F.action.bound,is=F.action.bound,as=F.action.bound,ss=F.action.bound,cs=F.action.bound,ls=F.action.bound,us=F.action.bound,ps=F.action.bound,ds=F.action.bound,fs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ls(t,e)}(s,t);var e,r,o,n,i,a=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Us(t);if(e){var n=Us(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Is(this,r)}}(s);function s(){var t;Ms(this,s);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return zs(t=a.call.apply(a,[this].concat(r)),"data",_s,Ns(t)),zs(t,"is_loading",ys,Ns(t)),zs(t,"has_loaded_all",bs,Ns(t)),zs(t,"date_from",ms,Ns(t)),zs(t,"date_to",hs,Ns(t)),zs(t,"error",gs,Ns(t)),zs(t,"action_type",vs,Ns(t)),zs(t,"filtered_date_range",ws,Ns(t)),zs(t,"client_loginid",Os,Ns(t)),zs(t,"account_statistics",Ss,Ns(t)),t.fetchOnScroll=da()((function(e){e<1500&&t.fetchNextBatch()}),150),t}return e=s,r=[{key:"is_empty",get:function(){return!this.is_loading&&0===this.data.length}},{key:"has_selected_date",get:function(){return!(!this.date_from&&!this.date_to)}},{key:"clearTable",value:function(){this.data=[],this.has_loaded_all=!1,this.is_loading=!1}},{key:"clearDateFilter",value:function(){this.date_from=null,this.date_to=(0,p.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),this.partial_fetch_time=0}},{key:"shouldFetchNextBatch",value:function(t){if(!t&&(this.has_loaded_all||this.is_loading))return!1;var e=(0,p.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix();return!(this.date_to<e)||!t&&this.partial_fetch_time}},{key:"fetchNextBatch",value:(i=As(regeneratorRuntime.mark((function t(){var e,r,o,n=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.length>0&&void 0!==n[0]&&n[0],this.shouldFetchNextBatch(e)){t.next=3;break}return t.abrupt("return");case 3:return this.is_loading=!0,r=ga(this.date_from,this.date_to,this.partial_fetch_time,e),"all"!==this.action_type&&(r.action_type=this.action_type),t.next=8,p.WS.statement(100,e?void 0:this.data.length,r);case 8:o=t.sent,this.statementHandler(o,e);case 10:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"statementHandler",value:function(t,e){var r=this;if("error"in t)this.error=t.error.message;else{var o=t.statement.transactions.map((function(t){return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o="DD MMM YYYY HH:mm:ss",n=(0,p.toMoment)(t.transaction_time).format(o),i=parseFloat(t.payout),a=parseFloat(t.amount),s=parseFloat(t.balance_after),c=!0,l=["buy","sell"].includes(t.action_type)?t.shortcode:null,u=l?(0,Pe.rh)(r,(0,De.cS)(l).underlying):"";return Es({action:(0,_.localize)((0,p.toTitleCase)(t.action_type)),date:n,display_name:u,refid:t.transaction_id,payout:isNaN(i)?"-":(0,p.formatMoney)(e,i,c),amount:isNaN(a)?"-":(0,p.formatMoney)(e,a,c),balance:isNaN(s)?"-":(0,p.formatMoney)(e,s,c),desc:t.longcode.replace(/\n/g,"<br />"),id:t.contract_id,app_id:t.app_id,shortcode:l,action_type:t.action_type,purchase_time:t.purchase_time,transaction_time:t.transaction_time},t.withdrawal_details&&{withdrawal_details:t.withdrawal_details,longcode:t.longcode})}(t,r.root_store.client.currency,r.root_store.modules.trade.active_symbols)}));this.data=e?[].concat(js(o),js(this.data)):[].concat(js(this.data),js(o)),this.has_loaded_all=!e&&o.length<100,this.is_loading=!1,o.length>0&&(this.partial_fetch_time=(0,p.toMoment)().unix())}}},{key:"handleDateChange",value:function(t){var e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.date_range;this.filtered_date_range=n,this.date_from=null!==(e=null==t?void 0:t.from)&&void 0!==e?e:t.is_batch?null:this.date_from,this.date_to=null!==(r=null==t?void 0:t.to)&&void 0!==r?r:this.date_to,this.clearTable(),this.fetchNextBatch()}},{key:"handleFilterChange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action_type=t,this.clearTable(),this.fetchNextBatch()}},{key:"handleScroll",value:function(t){var e=t.target,r=e.scrollTop,o=e.scrollHeight-(r+e.clientHeight);this.fetchOnScroll(o)}},{key:"loadAccountStatistics",value:(n=As(regeneratorRuntime.mark((function t(){var e,r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.account_statistics={},!(e=this.root_store.client).standpoint.iom&&!e.standpoint.malta){t.next=8;break}return t.next=6,p.WS.accountStatistics();case 6:r=t.sent,(0,F.runInAction)((function(){r.error?o.account_statistics={}:o.account_statistics=r.account_statistics}));case 8:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"accountSwitcherListener",value:function(){var t=this;return new Promise((function(e){return t.clearTable(),t.clearDateFilter(),t.loadAccountStatistics(),e(t.fetchNextBatch())}))}},{key:"networkStatusChangeListener",value:function(t){this.is_loading=!t}},{key:"onMount",value:(o=As(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.assertHasValidCache(this.client_loginid,this.clearDateFilter,this.clearTable,p.WS.forgetAll.bind(null,"proposal")),this.client_loginid=this.root_store.client.loginid,this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),t.next=6,p.WS.wait("authorize");case 6:this.fetchNextBatch(!0),this.loadAccountStatistics();case 8:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"onUnmount",value:function(){this.disposeSwitchAccount(),p.WS.forgetAll("proposal")}}],r&&Rs(e.prototype,r),s}(zo.Z),_s=Fs(fs.prototype,"data",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ys=Fs(fs.prototype,"is_loading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bs=Fs(fs.prototype,"has_loaded_all",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ms=Fs(fs.prototype,"date_from",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hs=Fs(fs.prototype,"date_to",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,p.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix()}}),gs=Fs(fs.prototype,"error",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),vs=Fs(fs.prototype,"action_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"all"}}),ws=Fs(fs.prototype,"filtered_date_range",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Os=Fs(fs.prototype,"client_loginid",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ss=Fs(fs.prototype,"account_statistics",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Fs(fs.prototype,"is_empty",[F.computed],Object.getOwnPropertyDescriptor(fs.prototype,"is_empty"),fs.prototype),Fs(fs.prototype,"has_selected_date",[F.computed],Object.getOwnPropertyDescriptor(fs.prototype,"has_selected_date"),fs.prototype),Fs(fs.prototype,"clearTable",[es],Object.getOwnPropertyDescriptor(fs.prototype,"clearTable"),fs.prototype),Fs(fs.prototype,"clearDateFilter",[rs],Object.getOwnPropertyDescriptor(fs.prototype,"clearDateFilter"),fs.prototype),Fs(fs.prototype,"fetchNextBatch",[os],Object.getOwnPropertyDescriptor(fs.prototype,"fetchNextBatch"),fs.prototype),Fs(fs.prototype,"statementHandler",[ns],Object.getOwnPropertyDescriptor(fs.prototype,"statementHandler"),fs.prototype),Fs(fs.prototype,"handleDateChange",[is],Object.getOwnPropertyDescriptor(fs.prototype,"handleDateChange"),fs.prototype),Fs(fs.prototype,"handleFilterChange",[as],Object.getOwnPropertyDescriptor(fs.prototype,"handleFilterChange"),fs.prototype),Fs(fs.prototype,"handleScroll",[ss],Object.getOwnPropertyDescriptor(fs.prototype,"handleScroll"),fs.prototype),Fs(fs.prototype,"loadAccountStatistics",[cs],Object.getOwnPropertyDescriptor(fs.prototype,"loadAccountStatistics"),fs.prototype),Fs(fs.prototype,"accountSwitcherListener",[ls],Object.getOwnPropertyDescriptor(fs.prototype,"accountSwitcherListener"),fs.prototype),Fs(fs.prototype,"networkStatusChangeListener",[us],Object.getOwnPropertyDescriptor(fs.prototype,"networkStatusChangeListener"),fs.prototype),Fs(fs.prototype,"onMount",[ps],Object.getOwnPropertyDescriptor(fs.prototype,"onMount"),fs.prototype),Fs(fs.prototype,"onUnmount",[ds],Object.getOwnPropertyDescriptor(fs.prototype,"onUnmount"),fs.prototype),fs),Hs=r("./_common/base/server_time.js"),Ws=r.n(Hs);function Vs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Gs(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Vs(Object(r),!0).forEach((function(e){qs(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vs(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function qs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ys(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}var Zs=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,r,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.WS.buy(Gs({proposal_id:e,price:r},o&&{passthrough:o})));case 1:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Ys(i,o,n,a,s,"next",t)}function s(t){Ys(i,o,n,a,s,"throw",t)}a(void 0)}))});return function(t,r,o){return e.apply(this,arguments)}}(),Xs=r("./Stores/Modules/Trading/Helpers/contract-type.js");function Js(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}var $s=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Xs.Z.buildContractTypesConfig(e);case 2:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Js(i,o,n,a,s,"next",t)}function s(t){Js(i,o,n,a,s,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}(),Ks=r("./Stores/Modules/Trading/Helpers/start-date.js");function Qs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return tc(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tc(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function ec(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function rc(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var oc=function(){return{stop_loss:{rules:[["req",{condition:function(t){return t.has_stop_loss&&!t.stop_loss},message:(0,_.localize)("Please enter a stop loss amount.")}]]},take_profit:{rules:[["req",{condition:function(t){return t.has_take_profit&&!t.take_profit},message:(0,_.localize)("Please enter a take profit amount.")}]]}}};var nc=r("./Stores/Modules/Trading/Helpers/duration.js"),ic=function(t){var e=t.contract_types_list,r=t.contract_type;return Xs.Z.getContractType(e,r)},ac=function(t){return Xs.Z.getContractValues(t)};function sc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return cc(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cc(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function lc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function uc(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?lc(Object(r),!0).forEach((function(e){pc(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lc(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function pc(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var dc=function(t){var e=(0,nc.QJ)(t);return uc({contract_expiry_type:e},t.contract_expiry_type!==e&&Xs.Z.getBarriers(t.contract_type,e))},fc=function(t){var e=(0,nc.QJ)(t),r=t.duration,o=t.duration_min_max,n=t.duration_unit;return uc({},_c({contract_expiry_type:e,duration:r,duration_min_max:o,duration_unit:n}))},_c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.contract_expiry_type,r=t.duration,o=t.duration_min_max,n=t.duration_unit,i=(0,nc.P7)(o,e,n),a=sc(i,2),s=a[0],c=a[1];return r<s?{duration:s}:r>c?{duration:c}:{}};function yc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function bc(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?yc(Object(r),!0).forEach((function(e){mc(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yc(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function mc(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hc(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}var gc=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var r,o,n,i,a,s,c,l,u,p,d,f,_,y,b,m,h,g,v,w,O,S,k,P,E;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.contract_type,o=e.duration_unit,n=e.expiry_time,i=e.start_date,a=e.symbol,s=e.root_store.common.server_time,c=e.start_time,l=e.expiry_date,u=e.expiry_type,c=c||s.clone().add(6,"minute").format("HH:mm"),p=Xs.Z.getStartType(i),d=p.contract_start_type,f=Xs.Z.getSessions(r,i),_=f.sessions,y=Xs.Z.getStartTime(_,i,c),c=y.start_time,b=Xs.Z.getDurationUnitsList(r,d),m=b.duration_units_list,h=Xs.Z.getDurationUnit(o,r,d),g=Xs.Z.getExpiryType(m,u),u=g.expiry_type,v=Xs.Z.getExpiryDate(m,l,u,i),l=v.expiry_date,t.next=19,Xs.Z.getTradingTimes(l,a);case 19:return w=t.sent,O={market_open_times:w.open},S={market_close_times:w.close},k=S.market_close_times,P=Xs.Z.getExpiryTime(l,n,u,k,_,i,c),E=Xs.Z.getDurationMinMax(r,d),t.abrupt("return",bc(bc(bc(bc(bc(bc(bc(bc(bc(bc(bc({},p),b),E),h),f),y),v),P),g),O),S));case 26:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){hc(i,o,n,a,s,"next",t)}function s(t){hc(i,o,n,a,s,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}();function vc(t){return function(t){if(Array.isArray(t))return wc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return wc(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wc(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Oc(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}var Sc,kc,Pc,Ec,Cc,xc,jc,Dc,Tc,Ac,zc,Mc,Rc,Lc,Ic,Nc,Uc,Fc,Bc,Hc,Wc,Vc,Gc,qc,Yc,Zc,Xc,Jc,$c,Kc,Qc,tl,el,rl,ol,nl,il,al,sl,cl,ll,ul,pl,dl,fl,_l,yl,bl,ml,hl,gl,vl,wl,Ol,Sl,kl,Pl,El,Cl,xl,jl,Dl,Tl,Al,zl,Ml,Rl,Ll,Il,Nl,Ul,Fl,Bl,Hl,Wl,Vl,Gl,ql,Yl,Zl,Xl,Jl,$l,Kl,Ql,tu,eu,ru,ou,nu,iu,au,su,cu,lu,uu,pu,du,fu,_u,yu,bu,mu,hu,gu,vu,wu,Ou,Su,ku,Pu,Eu,Cu,xu,ju=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,r){var o,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.getSnapshot(),n=Du(e,r),i=0;case 3:if(!(i<n.length)){t.next=13;break}return t.t0=Object,t.t1=o,t.next=8,n[i](o);case 8:t.t2=t.sent,t.t0.assign.call(t.t0,t.t1,t.t2);case 10:i++,t.next=3;break;case 13:return t.abrupt("return",o);case 14:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Oc(i,o,n,a,s,"next",t)}function s(t){Oc(i,o,n,a,s,"throw",t)}a(void 0)}))});return function(t,r){return e.apply(this,arguments)}}(),Du=function(t,e){return[Xs.Z.getContractCategories,ic].concat(vc(/\b(symbol|contract_type)\b/.test(Object.keys(e))||!t.contract_type?[ac]:[]),[gc,dc],vc(/\b(symbol|contract_type)\b/.test(Object.keys(e))||!t.contract_type?[fc]:[]))},Tu=r("./Stores/Modules/Trading/Helpers/proposal.js"),Au=r("./Stores/Modules/Trading/Helpers/barrier.js");function zu(t){return zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(t)}function Mu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function Ru(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Lu(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ru(Object(r),!0).forEach((function(e){Iu(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ru(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Iu(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nu(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function Uu(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Nu(i,o,n,a,s,"next",t)}function s(t){Nu(i,o,n,a,s,"throw",t)}a(void 0)}))}}function Fu(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function Bu(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Hu(t,e){return Hu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Hu(t,e)}function Wu(t,e){return!e||"object"!==zu(e)&&"function"!=typeof e?Vu(t):e}function Vu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gu(t){return Gu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gu(t)}function qu(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var Yu,Zu={},Xu=(Sc=F.observable.ref,kc=F.observable.ref,Pc=F.action.bound,Ec=F.action.bound,Cc=F.action.bound,xc=F.action.bound,jc=F.action.bound,Dc=F.action.bound,Tc=F.action.bound,Ac=F.action.bound,zc=F.action.bound,Mc=F.action.bound,Rc=F.action.bound,Lc=F.action.bound,Ic=F.action.bound,Nc=F.action.bound,Uc=F.action.bound,Fc=F.action.bound,Bc=F.action.bound,Hc=F.action.bound,Wc=F.action.bound,Vc=F.action.bound,Gc=F.action.bound,qc=F.action.bound,Yc=F.action.bound,Zc=F.action.bound,Xc=F.action.bound,Jc=F.action.bound,$c=F.action.bound,Kc=F.action.bound,Qc=F.action.bound,tl=F.action.bound,el=F.action.bound,rl=F.action.bound,ol=F.action.bound,nl=F.action.bound,il=F.action.bound,al=F.action.bound,sl=F.action.bound,cl=F.action.bound,ll=F.action.bound,ul=F.action.bound,pl=F.action.bound,dl=F.action.bound,fl=F.action.bound,_l=F.action.bound,yl=F.action.bound,bl=F.action.bound,ml=F.action.bound,hl=F.action.bound,gl=F.action.bound,vl=F.action.bound,wl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hu(t,e)}(v,t);var e,r,o,n,i,a,s,c,l,u,d,f,y,m,h,g=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Gu(t);if(e){var n=Gu(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Wu(this,r)}}(v);function v(t){var e,r=t.root_store;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),Fu(e=g.call(this,{root_store:r,local_storage_properties:["amount","currency","barrier_1","barrier_2","basis","contract_start_type","contract_type","duration","duration_unit","expiry_date","expiry_type","has_take_profit","has_stop_loss","has_cancellation","is_equal","last_digit","multiplier","start_date","start_time","symbol","stop_loss","take_profit","is_trade_params_expanded"],store_name:"trade_store",validation_rules:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ec(Object(r),!0).forEach((function(e){rc(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ec(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({amount:{rules:[["req",{message:(0,_.localize)("Amount is a required field.")}],["number",{min:0,type:"float"}]]},barrier_1:{rules:[["req",{condition:function(t){return t.barrier_count&&t.form_components.indexOf("barrier")>-1},message:(0,_.localize)("Barrier is a required field.")}],["barrier",{condition:function(t){return t.barrier_count}}],["custom",{func:function(t,e,r,o){return!(r.barrier_count>1)||+t>+o.barrier_2},message:(0,_.localize)("Higher barrier must be higher than lower barrier.")}],["custom",{func:function(t,e,r,o){return!/^[+-]/.test(o.barrier_1)||0!=+o.barrier_1},message:(0,_.localize)("Barrier cannot be zero.")}]],trigger:"barrier_2"},barrier_2:{rules:[["req",{condition:function(t){return t.barrier_count>1&&t.form_components.indexOf("barrier")>-1},message:(0,_.localize)("Barrier is a required field.")}],["barrier",{condition:function(t){return t.barrier_count}}],["custom",{func:function(t,e,r,o){return/^[+-]/g.test(o.barrier_1)&&/^[+-]/g.test(t)||/^(?![+-])/g.test(o.barrier_1)&&/^(?![+-])/g.test(t)},message:(0,_.localize)("Both barriers should be relative or absolute")}],["custom",{func:function(t,e,r,o){return+o.barrier_1>+t},message:(0,_.localize)("Lower barrier must be lower than higher barrier.")}]],trigger:"barrier_1"},duration:{rules:[["req",{message:(0,_.localize)("Duration is a required field.")}]]},start_date:{trigger:"start_time"},expiry_date:{trigger:"expiry_time"},start_time:{rules:[["custom",{func:function(t,e,r){return"spot"===r.contract_start_type||(0,p.isTimeValid)(t)},message:(0,_.localize)('Please enter the start time in the format "HH:MM".')}],["custom",{func:function(t,e,r){return"spot"===r.contract_start_type||(0,p.isHourValid)(t)},message:(0,_.localize)("Hour must be between 0 and 23.")}],["custom",{func:function(t,e,r){return"spot"===r.contract_start_type||(0,p.isMinuteValid)(t)},message:(0,_.localize)("Minute must be between 0 and 59.")}],["custom",{func:function(t,e,r){if("spot"===r.contract_start_type)return!0;if(!(0,p.isTimeValid)(t))return!1;var o=(0,p.toMoment)(r.start_date),n=o.clone(),i=Qs(t.split(":"),2),a=i[0],s=i[1];return(0,Ks.Y)(r.sessions,n.hour(a).minute(s),o)},message:(0,_.localize)("Start time cannot be in the past.")}]]},expiry_time:{rules:[["custom",{func:function(t,e,r){return"spot"===r.contract_start_type||(0,p.isTimeValid)(t)},message:(0,_.localize)('Please enter the start time in the format "HH:MM".')}],["custom",{func:function(t,e,r){return"spot"===r.contract_start_type||(0,p.isHourValid)(t)},message:(0,_.localize)("Hour must be between 0 and 23.")}],["custom",{func:function(t,e,r){return"spot"===r.contract_start_type||(0,p.isMinuteValid)(t)},message:(0,_.localize)("Minute must be between 0 and 59.")}],["custom",{func:function(t,e,r){if("spot"===r.contract_start_type)return!0;if(!(0,p.isTimeValid)(t))return!1;var o=(0,p.toMoment)(r.start_date),n=o.clone(),i=Qs(t.split(":"),2),a=i[0],s=i[1];return(0,Ks.Y)(r.sessions,n.hour(a).minute(s),o)},message:(0,_.localize)("Expiry time cannot be in the past.")}]]}},oc())}),"is_trade_component_mounted",Ol,Vu(e)),Fu(e,"is_purchase_enabled",Sl,Vu(e)),Fu(e,"is_trade_enabled",kl,Vu(e)),Fu(e,"is_equal",Pl,Vu(e)),Fu(e,"has_equals_only",El,Vu(e)),Fu(e,"symbol",Cl,Vu(e)),Fu(e,"is_market_closed",xl,Vu(e)),Fu(e,"previous_symbol",jl,Vu(e)),Fu(e,"active_symbols",Dl,Vu(e)),Fu(e,"form_components",Tl,Vu(e)),Fu(e,"contract_expiry_type",Al,Vu(e)),Fu(e,"contract_start_type",zl,Vu(e)),Fu(e,"contract_type",Ml,Vu(e)),Fu(e,"contract_types_list",Rl,Vu(e)),Fu(e,"trade_types",Ll,Vu(e)),Fu(e,"amount",Il,Vu(e)),Fu(e,"basis",Nl,Vu(e)),Fu(e,"basis_list",Ul,Vu(e)),Fu(e,"currency",Fl,Vu(e)),Fu(e,"duration",Bl,Vu(e)),Fu(e,"duration_unit",Hl,Vu(e)),Fu(e,"duration_units_list",Wl,Vu(e)),Fu(e,"duration_min_max",Vl,Vu(e)),Fu(e,"expiry_date",Gl,Vu(e)),Fu(e,"expiry_time",ql,Vu(e)),Fu(e,"expiry_type",Yl,Vu(e)),Fu(e,"barrier_1",Zl,Vu(e)),Fu(e,"barrier_2",Xl,Vu(e)),Fu(e,"barrier_count",Jl,Vu(e)),Fu(e,"main_barrier",$l,Vu(e)),Fu(e,"barriers",Kl,Vu(e)),Fu(e,"start_date",Ql,Vu(e)),Fu(e,"start_dates_list",tu,Vu(e)),Fu(e,"start_time",eu,Vu(e)),Fu(e,"sessions",ru,Vu(e)),Fu(e,"market_open_times",ou,Vu(e)),Fu(e,"market_close_times",nu,Vu(e)),Fu(e,"last_digit",iu,Vu(e)),Fu(e,"is_mobile_digit_view_selected",au,Vu(e)),Fu(e,"proposal_info",su,Vu(e)),Fu(e,"purchase_info",cu,Vu(e)),Fu(e,"is_chart_loading",lu,Vu(e)),Fu(e,"should_show_active_symbols_loading",uu,Vu(e)),Fu(e,"multiplier",pu,Vu(e)),Fu(e,"multiplier_range_list",du,Vu(e)),Fu(e,"stop_loss",fu,Vu(e)),Fu(e,"take_profit",_u,Vu(e)),Fu(e,"has_stop_loss",yu,Vu(e)),Fu(e,"has_take_profit",bu,Vu(e)),Fu(e,"has_cancellation",mu,Vu(e)),Fu(e,"commission",hu,Vu(e)),Fu(e,"cancellation_price",gu,Vu(e)),Fu(e,"stop_out",vu,Vu(e)),Fu(e,"expiration",wu,Vu(e)),Fu(e,"hovered_contract_type",Ou,Vu(e)),Fu(e,"cancellation_duration",Su,Vu(e)),Fu(e,"cancellation_range_list",ku,Vu(e)),Fu(e,"is_trade_params_expanded",Pu,Vu(e)),e.addTickByProposal=function(){return null},e.debouncedProposal=da()(e.requestProposal,500),e.proposal_requests={},e.is_purchasing_contract=!1,e.initial_barriers=void 0,e.is_initial_barrier_applied=!1,Fu(e,"should_skip_prepost_lifecycle",Eu,Vu(e)),Fu(e,"clearContracts",Cu,Vu(e)),e.setMainBarrier=function(t){if(t){var r=t.contract_type,o=t.barrier,n=t.high_barrier,i=t.low_barrier;if(Vr(r)){var a=e.root_store.ui.is_dark_mode_on?Hr:Br;e.main_barrier=new $r(o||n,i,e.onChartBarrierChange,{color:a})}else e.main_barrier=null}},Fu(e,"onPurchase",xu,Vu(e)),e.disablePurchaseButtons=function(){var t=document.getElementsByClassName("trade-container__price-info"),e=document.getElementsByClassName("btn-purchase");[].forEach.bind(e,(function(t){t.classList.add("btn-purchase--disabled")}))(),[].forEach.bind(t,(function(t){t.classList.add("trade-container__price-info--fade")}))()},e.prev_chart_layout=null,e.wsSubscribe=function(t,e){if(1===t.subscribe){var r=JSON.stringify(t),o=p.WS.subscribeTicksHistory(t,e);Zu[r]=o}},e.wsForget=function(t){var e=JSON.stringify(t);Zu[e]&&(Zu[e].unsubscribe(),delete Zu[e])},e.wsForgetStream=function(t){p.WS.forgetStream(t)},e.wsSendRequest=function(t){return t.time?Ws().timePromise().then((function(t){return t?{msg_type:"time",time:t.unix()}:p.WS.time()})):t.active_symbols?p.WS.activeSymbols("brief"):t.trading_times?p.WS.tradingTimes(t.trading_times):p.WS.storage.send(t)},e.refToAddTick=function(t){e.addTickByProposal=t},(0,F.reaction)((function(){return[e.contract_expiry_type,e.duration_min_max,e.duration_unit,e.expiry_type]}),(function(){e.changeDurationValidationRules()})),(0,F.reaction)((function(){return e.is_equal}),(function(){e.onAllowEqualsChange()})),(0,F.reaction)((function(){return e.symbol}),(function(){var t=(0,nc.I7)(e.symbol,e.expiry_type);t&&(e.expiry_date=t)})),(0,F.reaction)((function(){return e.duration_unit}),(function(){e.contract_expiry_type="t"===e.duration_unit?"tick":"intraday"})),(0,F.reaction)((function(){return[e.has_stop_loss,e.has_take_profit]}),(function(){e.has_stop_loss||(e.validation_errors.stop_loss=[]),e.has_take_profit||(e.validation_errors.take_profit=[])})),(0,F.reaction)((function(){return[e.contract_type]}),(function(){"multiplier"===e.contract_type?Object.assign(e.validation_rules,oc()):(delete e.validation_rules.stop_loss,delete e.validation_rules.take_profit)})),e}return e=v,r=[{key:"is_symbol_in_active_symbols",get:function(){var t=this;return this.active_symbols.some((function(e){return e.symbol===t.symbol&&1===e.exchange_is_open}))}},{key:"setSkipPrePostLifecycle",value:function(t){!!t!=!!this.should_skip_prepost_lifecycle&&(this.should_skip_prepost_lifecycle=t)}},{key:"setTradeStatus",value:function(t){this.is_trade_enabled=t}},{key:"refresh",value:function(){this.forgetAllProposal(),this.proposal_info={},this.purchase_info={},this.proposal_requests={}}},{key:"loadActiveSymbols",value:(h=Uu(regeneratorRuntime.mark((function t(){var e,r,o,n,i,a=this,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(s.length>0&&void 0!==s[0])||s[0],o=!(s.length>1&&void 0!==s[1])||s[1],this.should_show_active_symbols_loading=o,t.next=5,this.setActiveSymbols();case 5:if(!r){t.next=8;break}return t.next=8,this.setDefaultSymbol();case 8:return t.next=10,p.WS.storage.contractsFor(this.symbol);case 10:if(n=t.sent,!["InvalidSymbol","InputValidationFailed"].includes(null===(e=n.error)||void 0===e?void 0:e.code)){t.next=17;break}return t.next=14,(0,Pe.jt)(this.active_symbols);case 14:return i=t.sent,t.next=17,this.processNewValuesAsync({symbol:i});case 17:(0,F.runInAction)((function(){a.should_show_active_symbols_loading=!1}));case 18:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"setDefaultSymbol",value:(m=Uu(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.is_symbol_in_active_symbols){t.next=7;break}return this.is_trade_enabled=!1,t.next=4,(0,Pe.jt)(this.active_symbols);case 4:return e=t.sent,t.next=7,this.processNewValuesAsync({symbol:e});case 7:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"setActiveSymbols",value:(y=Uu(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.WS.authorized.activeSymbols();case 2:if(e=t.sent,r=e.active_symbols,!e.error){t.next=10;break}return this.root_store.common.showError({message:(0,_.localize)("Trading is unavailable at this time.")}),t.abrupt("return");case 10:if(r&&r.length){t.next=30;break}return t.next=13,p.WS.wait("get_settings");case 13:if(!["gb","im"].includes(this.root_store.client.residence)||!this.root_store.client.is_logged_in||localStorage.getItem("hide_close_mx_account_notification")){t.next=17;break}this.root_store.common.setError(!0,{type:"mx_removal"}),t.next=30;break;case 17:if(!(["gb","im"].includes(this.root_store.client.residence)&&this.root_store.client.is_logged_in&&localStorage.getItem("hide_close_mx_account_notification"))){t.next=22;break}return(0,Pe.$p)(this.root_store.common.showError),t.abrupt("return");case 22:if("maltainvest"===this.root_store.client.landing_company_shortcode){t.next=27;break}return(0,Pe.c)(this.root_store.common.showError,this.root_store.client.is_logged_in),t.abrupt("return");case 27:if("maltainvest"!==this.root_store.client.landing_company_shortcode){t.next=30;break}return(0,p.showDigitalOptionsUnavailableError)(this.root_store.common.showError,{text:(0,_.localize)("We’re working to have this available for you soon. If you have another account, switch to that account to continue trading. You may add a DMT5 Financial."),title:(0,_.localize)("DTrader is not available for this account"),link:(0,_.localize)("Go to DMT5 dashboard")}),t.abrupt("return");case 30:return t.next=32,this.processNewValuesAsync({active_symbols:r});case 32:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"setContractTypes",value:(f=Uu(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.symbol||!this.is_symbol_in_active_symbols){t.next=4;break}return t.next=3,$s(this.symbol);case 3:(0,F.runInAction)((function(){var t=Xs.Z.getContractCategories();e.processNewValuesAsync(Lu(Lu({},t),Xs.Z.getContractType(t.contract_types_list,e.contract_type))),e.processNewValuesAsync(Xs.Z.getContractValues(e))}));case 4:this.root_store.common.setSelectedContractType(this.contract_type);case 5:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"prepareTradeStore",value:(d=Uu(regeneratorRuntime.mark((function t(){var e,r=this,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=!(o.length>0&&void 0!==o[0])||o[0],this.initial_barriers={barrier_1:this.barrier_1,barrier_2:this.barrier_2},t.next=4,(0,F.when)((function(){return!r.root_store.client.is_populating_account_list}));case 4:return t.next=6,p.WS.wait("website_status");case 6:return t.next=8,(0,F.runInAction)(Uu(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.processNewValuesAsync({currency:r.root_store.client.currency||r.root_store.client.default_currency},!0,null,!1);case 2:case"end":return t.stop()}}),t)}))));case 8:return t.next=10,this.loadActiveSymbols(e);case 10:return t.next=12,this.setContractTypes();case 12:return t.next=14,this.processNewValuesAsync({is_market_closed:(0,Pe.pp)(this.active_symbols,this.symbol)},!0,null,!1);case 14:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"onChangeMultiple",value:(u=Uu(regeneratorRuntime.mark((function t(e){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object.keys(e).forEach((function(t){if(!(t in r))throw new Error("Invalid Argument: ".concat(t))})),t.next=3,this.processNewValuesAsync(Lu({},e),!0);case 3:this.validateAllProperties();case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"onChange",value:(l=Uu(regeneratorRuntime.mark((function t(e){var r,o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target,o=r.name,n=r.value,"symbol"!==o||!n){t.next=7;break}this.setChartStatus(!0),this.setMarketStatus(!1),this.is_trade_enabled=!1,t.next=17;break;case 7:if("currency"!==o){t.next=11;break}this.root_store.client.is_logged_in||this.root_store.client.selectCurrency(n),t.next=17;break;case 11:if("expiry_date"!==o){t.next=15;break}this.expiry_time=null,t.next=17;break;case 15:if(o in this){t.next=17;break}throw new Error("Invalid Argument: ".concat(o));case 17:return t.next=19,this.processNewValuesAsync(Iu({},o,n),!0,"contract_type"===o?{contract_type:this.contract_type}:{},!0);case 19:this.validateAllProperties(),this.root_store.common.setSelectedContractType(this.contract_type);case 21:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"setPreviousSymbol",value:function(t){this.previous_symbol!==t&&(this.previous_symbol=t)}},{key:"setAllowEqual",value:function(t){this.is_equal=t}},{key:"setIsTradeParamsExpanded",value:function(t){this.is_trade_params_expanded=t}},{key:"resetPreviousSymbol",value:(c=Uu(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setMarketStatus((0,Pe.pp)(this.active_symbols,this.previous_symbol)),t.next=3,$s(this.previous_symbol);case 3:return t.next=5,this.updateSymbol(this.symbol);case 5:this.setChartStatus(!1),(0,F.runInAction)((function(){e.previous_symbol=""}));case 7:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"updateBarrierColor",value:function(t){this.main_barrier&&this.main_barrier.updateBarrierColor(t)}},{key:"onHoverPurchase",value:function(t,e){this.is_purchase_enabled&&this.main_barrier&&!this.is_multiplier?this.main_barrier.updateBarrierShade(t,e):t||!this.main_barrier||this.is_multiplier||this.main_barrier.updateBarrierShade(!1,e),this.hovered_contract_type=t?e:null,Qr({barriers:this.barriers,is_over:t,contract_type:e,contract_info:this.proposal_info[e]})}},{key:"setPurchaseSpotBarrier",value:function(t,e){var r="PURCHASE_SPOT_BARRIER";if(t){var o=this.barriers.find((function(t){return t.key===r}));o?o.high!==+e.contract_info.entry_spot&&o.onChange({high:e.contract_info.entry_spot}):((o=new $r(e.contract_info.entry_spot)).key=r,o.draggable=!1,o.hideOffscreenBarrier=!0,o.isSingleBarrier=!0,o.updateBarrierColor(this.root_store.ui.is_dark_mode_on),this.barriers.push(o))}else Gr(this.barriers,r)}},{key:"updateLimitOrderBarriers",value:function(t,e){var r=e.contract_info,o=this.barriers;Qr({barriers:o,contract_info:r,contract_type:r.contract_type,is_over:t})}},{key:"clearLimitOrderBarriers",value:function(){this.hovered_contract_type=null;var t=this.barriers;Qr({barriers:t,is_over:!1})}},{key:"barrier_pipsize",get:function(){return(0,Au.l)(this.barrier_1)}},{key:"main_barrier_flattened",get:function(){return(0,b.A)(this.contract_type)?null:(0,F.toJS)(this.main_barrier)}},{key:"barriers_flattened",get:function(){return this.barriers&&(0,F.toJS)(this.barriers)}},{key:"processPurchase",value:function(t,e,r){var o=this;if(this.is_purchase_enabled&&t){this.is_purchase_enabled=!1,this.is_purchasing_contract=!0;var n="t"===this.duration_unit;Zs(t,e).then((0,F.action)((function(e){if(!o.is_trade_component_mounted)return o.enablePurchase(),void(o.is_purchasing_contract=!1);var i,a,s=+o.last_digit;if(e.error)o.disablePurchaseButtons(),"InvalidToken"!==e.error.code&&(o.root_store.common.setServicesError(Lu({type:e.msg_type},e.error)),(0,p.isMobile)()&&"buy"===(null===(i=o.root_store.common)||void 0===i||null===(a=i.services_error)||void 0===a?void 0:a.type)&&setTimeout((function(){o.clearPurchaseInfo(),o.requestProposal()}),3500));else if(e.buy){if(o.proposal_info[r]&&o.proposal_info[r].id!==t)throw new Error("Proposal ID does not match.");var c=Lu(Lu(Lu({},o.proposal_requests[r]),o.proposal_info[r]),{},{buy_price:e.buy.buy_price}),l=e.buy,u=l.contract_id,d=l.longcode,f=l.start_time;if(u){var _=e.buy.shortcode,y=(0,p.extractInfoFromShortcode)(_),m=y.category,h=y.underlying,g=(0,b.H)(m.toUpperCase()),v=m.toUpperCase();return o.root_store.modules.contract_trade.addContract({contract_id:u,start_time:f,longcode:d,underlying:h,barrier:g?s:null,contract_type:v,is_tick_contract:n}),o.root_store.modules.portfolio.onBuyResponse({contract_id:u,longcode:d,contract_type:v}),((0,p.isDesktop)()||(0,p.isMobile)()&&o.is_multiplier)&&o.root_store.ui.openPositionsDrawer(),o.proposal_info={},o.forgetAllProposal(),o.purchase_info=e,o.proposal_requests={},o.debouncedProposal(),o.clearLimitOrderBarriers(),o.pushPurchaseDataToGtm(c),void(o.is_purchasing_contract=!1)}}o.forgetAllProposal(),o.purchase_info=e,o.enablePurchase(),o.is_purchasing_contract=!1})))}}},{key:"enablePurchase",value:function(){this.root_store.client.is_unwelcome||(this.is_purchase_enabled=!0)}},{key:"updateStore",value:function(t){var e=this;return Object.keys((0,p.cloneObject)(t)).forEach((function(r){"root_store"===r||["validation_rules","validation_errors","currency"].indexOf(r)>-1||(JSON.stringify(e[r])===JSON.stringify(t[r])?delete t[r]:("symbol"===r&&(e.is_purchase_enabled=!1,e.is_trade_enabled=!1),t.start_date&&"string"==typeof t.start_date&&(t.start_date=parseInt(t.start_date)),e[r]=t[r],"barrier_2"===r&&t.barrier_1&&(e.barrier_1=t.barrier_1)))})),t}},{key:"processNewValuesAsync",value:(s=Uu(regeneratorRuntime.mark((function t(){var e,r,o,n,i,a,s,c,l,u,d=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=d.length>0&&void 0!==d[0]?d[0]:{},r=d.length>1&&void 0!==d[1]&&d[1],o=d.length>2&&void 0!==d[2]?d[2]:{},n=!(d.length>3&&void 0!==d[3])||d[3],e.contract_type&&"rise_fall"===e.contract_type&&this.is_equal&&(e.contract_type="rise_fall_equal"),/\bduration\b/.test(Object.keys(e))&&"string"==typeof e.duration&&(e.duration=+e.duration),n&&(this.forgetAllProposal(),this.proposal_requests={}),r&&/\bcurrency\b/.test(Object.keys(e))&&(i=(null==o?void 0:o.currency)||this.currency,a=e.currency!==i,s=(0,p.isCryptocurrency)(e.currency)||(0,p.isCryptocurrency)(e.currency)!==(0,p.isCryptocurrency)(i),a&&s&&(e.amount=e.amount||(0,p.getMinPayout)(e.currency)),this.currency=e.currency),!Object.keys(e).includes("symbol")){t.next=14;break}return this.setPreviousSymbol(this.symbol),t.next=12,$s(e.symbol);case 12:this.setMarketStatus((0,Pe.pp)(this.active_symbols,e.symbol)),c=Xs.Z.getContractCategories().has_only_forward_starting_contracts;case 14:if(this.root_store.ui.setHasOnlyForwardingContracts(c),!c){t.next=17;break}return t.abrupt("return");case 17:if(l=this.updateStore((0,p.cloneObject)(e)),!r&&!/\b(symbol|contract_types_list)\b/.test(Object.keys(l))){t.next=29;break}return this.updateStore({is_purchase_enabled:!1,proposal_info:{}}),e.contract_type&&this.root_store.ui.is_advanced_duration&&(0,b.A)(e.contract_type)&&(this.barrier_1="",this.barrier_2="",this.expiry_type="duration",this.root_store.ui.is_advanced_duration=!1),t.next=23,ju(this,l);case 23:(u=t.sent).is_trade_enabled=!0,this.updateStore(Lu(Lu({},u),this.is_initial_barrier_applied?{}:this.initial_barriers)),this.is_initial_barrier_applied=!0,/\bcontract_type\b/.test(Object.keys(l))&&this.validateAllProperties(),this.debouncedProposal();case 29:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"is_synthetics_available",get:function(){var t;return!(null===(t=this.active_symbols)||void 0===t||!t.find((function(t){return"synthetic_index"===t.market})))}},{key:"show_digits_stats",get:function(){return(0,b.A)(this.contract_type)}},{key:"setMobileDigitView",value:function(t){this.is_mobile_digit_view_selected=t}},{key:"pushPurchaseDataToGtm",value:function(t){var e={event:"buy_contract",bom_ui:"new",contract:{amount:t.amount,barrier1:t.barrier,barrier2:t.barrier2,basis:t.basis,buy_price:t.buy_price,contract_type:t.contract_type,currency:t.currency,date_expiry:t.date_expiry,date_start:t.date_start,duration:t.duration,duration_unit:t.duration_unit,payout:t.payout,symbol:t.symbol},settings:{theme:this.root_store.ui.is_dark_mode_on?"dark":"light",positions_drawer:this.root_store.ui.is_positions_drawer_on?"open":"closed",chart:{toolbar_position:this.root_store.ui.is_chart_layout_default?"bottom":"left",chart_asset_info:this.root_store.ui.is_chart_asset_info_visible?"visible":"hidden",chart_type:this.root_store.modules.contract_trade.chart_type,granularity:this.root_store.modules.contract_trade.granularity}}};this.root_store.gtm.pushDataLayer(e)}},{key:"clearPurchaseInfo",value:function(){this.purchase_info={},this.proposal_requests={},this.proposal_info={}}},{key:"requestProposal",value:function(){var t=this,e=(0,Tu.RX)(this);if(Object.values(this.validation_errors).some((function(t){return t.length})))return this.proposal_info={},this.purchase_info={},void this.forgetAllProposal();(0,p.isEmptyObject)(e)||(this.proposal_requests=e,this.purchase_info={},Object.keys(this.proposal_requests).forEach((function(e){p.WS.subscribeProposal(t.proposal_requests[e],t.onProposalResponse)}))),this.root_store.ui.resetPurchaseStates()}},{key:"forgetAllProposal",value:function(){Object.keys(this.proposal_requests).length>0&&p.WS.forgetAll("proposal")}},{key:"setMarketStatus",value:function(t){this.is_market_closed=t}},{key:"onProposalResponse",value:function(t){var e,r=t.echo_req.contract_type,o=(0,p.getPropertyValue)(this.proposal_info,r)||{},n=(0,p.getPropertyValue)(o,"obj_contract_basis")||{},i=null===(e=t.proposal)||void 0===e?void 0:e.date_expiry;if(!t.error&&i&&this.is_crypto_multiplier&&(this.expiration=i),this.proposal_info=Lu(Lu({},this.proposal_info),{},Iu({},r,(0,Tu._N)(this,t,n))),this.is_multiplier&&this.proposal_info&&this.proposal_info.MULTUP){var a,s=this.proposal_info.MULTUP,c=s.commission,l=s.cancellation,u=s.limit_order;c&&(this.commission=c),l&&(this.cancellation_price=l.ask_price),this.stop_out=null==u||null===(a=u.stop_out)||void 0===a?void 0:a.order_amount}if(this.main_barrier&&"NONE_SINGLE"!==this.main_barrier.shade||this.setMainBarrier(t.echo_req),this.hovered_contract_type===r&&(this.addTickByProposal(t),Qr({barriers:this.barriers,contract_info:this.proposal_info[this.hovered_contract_type],contract_type:r,is_over:!0})),t.error){var d=(0,Tu.yr)(t);if(d&&this.setValidationErrorMessages(d,[t.error.message]),this.is_multiplier){var f=t.error,_=f.message,y=f.details,b=(_||"").match(/\((\d+\.*\d*)\)/);"stop_loss"===(null==y?void 0:y.field)&&null!=b&&b[1]&&(this.commission=b[1])}if("AlreadySubscribed"===t.error.code)return this.refresh(),void(this.is_trade_component_mounted&&this.debouncedProposal())}else this.validateAllProperties();this.is_purchasing_contract||this.enablePurchase()}},{key:"onChartBarrierChange",value:function(t,e){this.processNewValuesAsync({barrier_1:t,barrier_2:e},!0)}},{key:"onAllowEqualsChange",value:function(){this.processNewValuesAsync({contract_type:parseInt(this.is_equal)?"rise_fall_equal":"rise_fall"},!0)}},{key:"updateSymbol",value:function(t){t&&this.onChange({target:{name:"symbol",value:t}})}},{key:"changeDurationValidationRules",value:function(){if("endtime"!==this.expiry_type){if(this.validation_rules.duration){var t=this.validation_rules.duration.rules.findIndex((function(t){return"number"===t[0]})),e=this.duration_min_max[this.contract_expiry_type]||!1;if(e){var r={min:(0,nc.ln)(+e.min,this.duration_unit),max:(0,nc.ln)(+e.max,this.duration_unit)};t>-1?this.validation_rules.duration.rules[t][1]=r:this.validation_rules.duration.rules.push(["number",r]),this.validateProperty("duration",this.duration)}}}else this.validation_errors.duration=[]}},{key:"accountSwitcherListener",value:(a=Uu(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadActiveSymbols(!0,!1);case 2:return this.resetErrorServices(),t.next=5,this.setContractTypes();case 5:return(0,F.runInAction)(Uu(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.processNewValuesAsync({currency:e.root_store.client.currency||e.root_store.client.default_currency},!0,{currency:e.currency},!1);case 1:case"end":return t.stop()}}),t)})))),t.abrupt("return",Promise.resolve());case 7:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"preSwitchAccountListener",value:function(){return this.clearContracts(),this.is_trade_enabled=!1,Promise.resolve()}},{key:"logoutListener",value:(i=Uu(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clearContracts(),this.refresh(),this.resetErrorServices(),t.next=5,this.loadActiveSymbols();case 5:return t.next=7,this.setContractTypes();case 7:this.debouncedProposal();case 8:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"clientInitListener",value:function(){return this.initAccountCurrency(this.root_store.client.currency||this.root_store.client.default_currency),Promise.resolve()}},{key:"networkStatusChangeListener",value:function(t){this.setTradeStatus(t)}},{key:"themeChangeListener",value:function(t){this.updateBarrierColor(t)}},{key:"resetErrorServices",value:function(){this.root_store.ui.toggleServicesErrorModal(!1)}},{key:"onMount",value:function(){var t=this;this.is_trade_component_mounted&&this.should_skip_prepost_lifecycle||(this.onPreSwitchAccount(this.preSwitchAccountListener),this.onSwitchAccount(this.accountSwitcherListener),this.onLogout(this.logoutListener),this.onClientInit(this.clientInitListener),this.onNetworkStatusChange(this.networkStatusChangeListener),this.onThemeChange(this.themeChangeListener),this.setChartStatus(!0),(0,F.runInAction)(Uu(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.is_trade_component_mounted=!0,t.prepareTradeStore();case 2:case"end":return e.stop()}}),e)})))),this.manageMXRemovalNotification())}},{key:"manageMXRemovalNotification",value:function(){var t=this,e=this.root_store.client.client_notifications,r=JSON.parse(localStorage.getItem("notification_messages")),o=this.root_store.client.country_standpoint.is_isle_of_man,n=this.root_store.client.country_standpoint.has_iom_account,i=this.root_store.client.is_logged_in;if(this.root_store.ui.unmarkNotificationMessage({key:"close_mx_account"}),null!==r&&n&&i){var a=Object.fromEntries(Object.entries(r).map((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Mu(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mu(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2);return[e[0],e[1].filter((function(t){return"close_mx_account"!==t}))]})));localStorage.setItem("notification_messages",JSON.stringify(a)),this.root_store.ui.addNotificationMessage(e(this.root_store.ui,{},o).close_mx_account),(0,F.reaction)((function(){return 0===t.root_store.ui.notification_messages.length}),(function(){var r=t.root_store.client.has_iom_account,n=1===parseInt(localStorage.getItem("hide_close_mx_account_notification"));r&&!n&&t.root_store.ui.addNotificationMessage(e(t.root_store.ui,{},o).close_mx_account)}))}}},{key:"setChartStatus",value:function(t){this.is_chart_loading=t}},{key:"initAccountCurrency",value:(n=Uu(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currency!==e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.processNewValuesAsync({currency:e},!0,{currency:this.currency},!1);case 4:this.refresh(),this.debouncedProposal();case 6:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"onUnmount",value:function(){this.should_skip_prepost_lifecycle||(this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout(),this.disposeClientInit(),this.disposeNetworkStatusChange(),this.disposeThemeChange(),this.is_trade_component_mounted=!1,this.root_store.modules.contract_trade.onUnmount(),this.refresh(),this.resetErrorServices(),this.root_store.ui.is_notifications_visible&&this.root_store.ui.toggleNotificationsModal(),this.prev_chart_layout&&(this.prev_chart_layout.is_used=!1))}},{key:"chart_layout",get:function(){var t=null;return this.prev_chart_layout&&!1===this.prev_chart_layout.is_used&&(t=this.prev_chart_layout),t}},{key:"is_crypto_multiplier",get:function(){return"multiplier"===this.contract_type&&/^cry/.test(this.symbol)}},{key:"exportLayout",value:function(t){var e=this;delete t.previousMaxTicks,this.prev_chart_layout=t,this.prev_chart_layout.isDone=function(){e.prev_chart_layout.is_used=!0,e.setChartStatus(!1)}}},{key:"chartStateChange",value:function(t,e){"MARKET_STATE_CHANGE"===t&&e&&"isClosed"in e&&this.is_trade_component_mounted&&e.isClosed!==this.is_market_closed&&this.prepareTradeStore(!1)}},{key:"has_alternative_source",get:function(){return this.is_multiplier&&!!this.hovered_contract_type}},{key:"is_multiplier",get:function(){return"multiplier"===this.contract_type}},{key:"getFirstOpenMarket",value:(o=Uu(regeneratorRuntime.mark((function t(e){var r,o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(r=this.active_symbols)||void 0===r||!r.length){t.next=2;break}return t.abrupt("return",(0,Pe.Uf)(this.active_symbols,e));case 2:return t.next=4,p.WS.authorized.activeSymbols();case 4:if(o=t.sent,n=o.active_symbols,!o.error){t.next=10;break}return this.root_store.common.showError({message:(0,_.localize)("Trading is unavailable at this time.")}),t.abrupt("return",void 0);case 10:return t.abrupt("return",(0,Pe.Uf)(n,e));case 11:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})}],r&&Bu(e.prototype,r),v}(zo.Z),Ol=qu(wl.prototype,"is_trade_component_mounted",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Sl=qu(wl.prototype,"is_purchase_enabled",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kl=qu(wl.prototype,"is_trade_enabled",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Pl=qu(wl.prototype,"is_equal",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),El=qu(wl.prototype,"has_equals_only",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Cl=qu(wl.prototype,"symbol",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xl=qu(wl.prototype,"is_market_closed",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),jl=qu(wl.prototype,"previous_symbol",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Dl=qu(wl.prototype,"active_symbols",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Tl=qu(wl.prototype,"form_components",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Al=qu(wl.prototype,"contract_expiry_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),zl=qu(wl.prototype,"contract_start_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ml=qu(wl.prototype,"contract_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Rl=qu(wl.prototype,"contract_types_list",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ll=qu(wl.prototype,"trade_types",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Il=qu(wl.prototype,"amount",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),Nl=qu(wl.prototype,"basis",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ul=qu(wl.prototype,"basis_list",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fl=qu(wl.prototype,"currency",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Bl=qu(wl.prototype,"duration",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Hl=qu(wl.prototype,"duration_unit",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Wl=qu(wl.prototype,"duration_units_list",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vl=qu(wl.prototype,"duration_min_max",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Gl=qu(wl.prototype,"expiry_date",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ql=qu(wl.prototype,"expiry_time",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Yl=qu(wl.prototype,"expiry_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"duration"}}),Zl=qu(wl.prototype,"barrier_1",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Xl=qu(wl.prototype,"barrier_2",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Jl=qu(wl.prototype,"barrier_count",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$l=qu(wl.prototype,"main_barrier",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Kl=qu(wl.prototype,"barriers",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ql=qu(wl.prototype,"start_date",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Number(0)}}),tu=qu(wl.prototype,"start_dates_list",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),eu=qu(wl.prototype,"start_time",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ru=qu(wl.prototype,"sessions",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ou=qu(wl.prototype,"market_open_times",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nu=qu(wl.prototype,"market_close_times",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),iu=qu(wl.prototype,"last_digit",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),au=qu(wl.prototype,"is_mobile_digit_view_selected",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),su=qu(wl.prototype,"proposal_info",[Sc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),cu=qu(wl.prototype,"purchase_info",[kc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),lu=qu(wl.prototype,"is_chart_loading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=qu(wl.prototype,"should_show_active_symbols_loading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pu=qu(wl.prototype,"multiplier",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=qu(wl.prototype,"multiplier_range_list",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fu=qu(wl.prototype,"stop_loss",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_u=qu(wl.prototype,"take_profit",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu=qu(wl.prototype,"has_stop_loss",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bu=qu(wl.prototype,"has_take_profit",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),mu=qu(wl.prototype,"has_cancellation",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hu=qu(wl.prototype,"commission",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=qu(wl.prototype,"cancellation_price",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=qu(wl.prototype,"stop_out",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wu=qu(wl.prototype,"expiration",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ou=qu(wl.prototype,"hovered_contract_type",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=qu(wl.prototype,"cancellation_duration",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"60m"}}),ku=qu(wl.prototype,"cancellation_range_list",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Pu=qu(wl.prototype,"is_trade_params_expanded",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Eu=qu(wl.prototype,"should_skip_prepost_lifecycle",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qu(wl.prototype,"is_symbol_in_active_symbols",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"is_symbol_in_active_symbols"),wl.prototype),qu(wl.prototype,"setSkipPrePostLifecycle",[Pc],Object.getOwnPropertyDescriptor(wl.prototype,"setSkipPrePostLifecycle"),wl.prototype),qu(wl.prototype,"setTradeStatus",[Ec],Object.getOwnPropertyDescriptor(wl.prototype,"setTradeStatus"),wl.prototype),qu(wl.prototype,"refresh",[Cc],Object.getOwnPropertyDescriptor(wl.prototype,"refresh"),wl.prototype),Cu=qu(wl.prototype,"clearContracts",[xc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var t=this;return function(){t.root_store.modules.contract_trade.contracts=[]}}}),qu(wl.prototype,"loadActiveSymbols",[jc],Object.getOwnPropertyDescriptor(wl.prototype,"loadActiveSymbols"),wl.prototype),qu(wl.prototype,"setDefaultSymbol",[Dc],Object.getOwnPropertyDescriptor(wl.prototype,"setDefaultSymbol"),wl.prototype),qu(wl.prototype,"setActiveSymbols",[Tc],Object.getOwnPropertyDescriptor(wl.prototype,"setActiveSymbols"),wl.prototype),qu(wl.prototype,"setContractTypes",[Ac],Object.getOwnPropertyDescriptor(wl.prototype,"setContractTypes"),wl.prototype),qu(wl.prototype,"prepareTradeStore",[zc],Object.getOwnPropertyDescriptor(wl.prototype,"prepareTradeStore"),wl.prototype),qu(wl.prototype,"onChangeMultiple",[Mc],Object.getOwnPropertyDescriptor(wl.prototype,"onChangeMultiple"),wl.prototype),qu(wl.prototype,"onChange",[Rc],Object.getOwnPropertyDescriptor(wl.prototype,"onChange"),wl.prototype),qu(wl.prototype,"setPreviousSymbol",[Lc],Object.getOwnPropertyDescriptor(wl.prototype,"setPreviousSymbol"),wl.prototype),qu(wl.prototype,"setAllowEqual",[Ic],Object.getOwnPropertyDescriptor(wl.prototype,"setAllowEqual"),wl.prototype),qu(wl.prototype,"setIsTradeParamsExpanded",[Nc],Object.getOwnPropertyDescriptor(wl.prototype,"setIsTradeParamsExpanded"),wl.prototype),qu(wl.prototype,"resetPreviousSymbol",[Uc],Object.getOwnPropertyDescriptor(wl.prototype,"resetPreviousSymbol"),wl.prototype),qu(wl.prototype,"updateBarrierColor",[Fc],Object.getOwnPropertyDescriptor(wl.prototype,"updateBarrierColor"),wl.prototype),qu(wl.prototype,"onHoverPurchase",[Bc],Object.getOwnPropertyDescriptor(wl.prototype,"onHoverPurchase"),wl.prototype),qu(wl.prototype,"setPurchaseSpotBarrier",[Hc],Object.getOwnPropertyDescriptor(wl.prototype,"setPurchaseSpotBarrier"),wl.prototype),qu(wl.prototype,"updateLimitOrderBarriers",[Wc],Object.getOwnPropertyDescriptor(wl.prototype,"updateLimitOrderBarriers"),wl.prototype),qu(wl.prototype,"clearLimitOrderBarriers",[Vc],Object.getOwnPropertyDescriptor(wl.prototype,"clearLimitOrderBarriers"),wl.prototype),qu(wl.prototype,"barrier_pipsize",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"barrier_pipsize"),wl.prototype),qu(wl.prototype,"main_barrier_flattened",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"main_barrier_flattened"),wl.prototype),qu(wl.prototype,"barriers_flattened",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"barriers_flattened"),wl.prototype),xu=qu(wl.prototype,"onPurchase",[Gc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return da()(this.processPurchase,300)}}),qu(wl.prototype,"processPurchase",[qc],Object.getOwnPropertyDescriptor(wl.prototype,"processPurchase"),wl.prototype),qu(wl.prototype,"enablePurchase",[Yc],Object.getOwnPropertyDescriptor(wl.prototype,"enablePurchase"),wl.prototype),qu(wl.prototype,"updateStore",[Zc],Object.getOwnPropertyDescriptor(wl.prototype,"updateStore"),wl.prototype),qu(wl.prototype,"is_synthetics_available",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"is_synthetics_available"),wl.prototype),qu(wl.prototype,"show_digits_stats",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"show_digits_stats"),wl.prototype),qu(wl.prototype,"setMobileDigitView",[Xc],Object.getOwnPropertyDescriptor(wl.prototype,"setMobileDigitView"),wl.prototype),qu(wl.prototype,"pushPurchaseDataToGtm",[Jc],Object.getOwnPropertyDescriptor(wl.prototype,"pushPurchaseDataToGtm"),wl.prototype),qu(wl.prototype,"clearPurchaseInfo",[$c],Object.getOwnPropertyDescriptor(wl.prototype,"clearPurchaseInfo"),wl.prototype),qu(wl.prototype,"requestProposal",[Kc],Object.getOwnPropertyDescriptor(wl.prototype,"requestProposal"),wl.prototype),qu(wl.prototype,"forgetAllProposal",[Qc],Object.getOwnPropertyDescriptor(wl.prototype,"forgetAllProposal"),wl.prototype),qu(wl.prototype,"setMarketStatus",[tl],Object.getOwnPropertyDescriptor(wl.prototype,"setMarketStatus"),wl.prototype),qu(wl.prototype,"onProposalResponse",[el],Object.getOwnPropertyDescriptor(wl.prototype,"onProposalResponse"),wl.prototype),qu(wl.prototype,"onChartBarrierChange",[rl],Object.getOwnPropertyDescriptor(wl.prototype,"onChartBarrierChange"),wl.prototype),qu(wl.prototype,"onAllowEqualsChange",[ol],Object.getOwnPropertyDescriptor(wl.prototype,"onAllowEqualsChange"),wl.prototype),qu(wl.prototype,"updateSymbol",[nl],Object.getOwnPropertyDescriptor(wl.prototype,"updateSymbol"),wl.prototype),qu(wl.prototype,"changeDurationValidationRules",[il],Object.getOwnPropertyDescriptor(wl.prototype,"changeDurationValidationRules"),wl.prototype),qu(wl.prototype,"accountSwitcherListener",[al],Object.getOwnPropertyDescriptor(wl.prototype,"accountSwitcherListener"),wl.prototype),qu(wl.prototype,"preSwitchAccountListener",[sl],Object.getOwnPropertyDescriptor(wl.prototype,"preSwitchAccountListener"),wl.prototype),qu(wl.prototype,"logoutListener",[cl],Object.getOwnPropertyDescriptor(wl.prototype,"logoutListener"),wl.prototype),qu(wl.prototype,"clientInitListener",[ll],Object.getOwnPropertyDescriptor(wl.prototype,"clientInitListener"),wl.prototype),qu(wl.prototype,"networkStatusChangeListener",[ul],Object.getOwnPropertyDescriptor(wl.prototype,"networkStatusChangeListener"),wl.prototype),qu(wl.prototype,"themeChangeListener",[pl],Object.getOwnPropertyDescriptor(wl.prototype,"themeChangeListener"),wl.prototype),qu(wl.prototype,"resetErrorServices",[dl],Object.getOwnPropertyDescriptor(wl.prototype,"resetErrorServices"),wl.prototype),qu(wl.prototype,"onMount",[fl],Object.getOwnPropertyDescriptor(wl.prototype,"onMount"),wl.prototype),qu(wl.prototype,"manageMXRemovalNotification",[_l],Object.getOwnPropertyDescriptor(wl.prototype,"manageMXRemovalNotification"),wl.prototype),qu(wl.prototype,"setChartStatus",[yl],Object.getOwnPropertyDescriptor(wl.prototype,"setChartStatus"),wl.prototype),qu(wl.prototype,"initAccountCurrency",[bl],Object.getOwnPropertyDescriptor(wl.prototype,"initAccountCurrency"),wl.prototype),qu(wl.prototype,"onUnmount",[ml],Object.getOwnPropertyDescriptor(wl.prototype,"onUnmount"),wl.prototype),qu(wl.prototype,"exportLayout",[hl],Object.getOwnPropertyDescriptor(wl.prototype,"exportLayout"),wl.prototype),qu(wl.prototype,"chartStateChange",[gl],Object.getOwnPropertyDescriptor(wl.prototype,"chartStateChange"),wl.prototype),qu(wl.prototype,"has_alternative_source",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"has_alternative_source"),wl.prototype),qu(wl.prototype,"is_multiplier",[F.computed],Object.getOwnPropertyDescriptor(wl.prototype,"is_multiplier"),wl.prototype),qu(wl.prototype,"getFirstOpenMarket",[vl],Object.getOwnPropertyDescriptor(wl.prototype,"getFirstOpenMarket"),wl.prototype),wl),Ju=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cashier=r.modules.cashier,this.contract_replay=new ti({root_store:e}),this.contract_trade=new Fi({root_store:e}),this.cfd=new Bi.default({root_store:e}),this.portfolio=new ua({root_store:e}),this.profit_table=new ks({root_store:e}),this.statement=new Bs({root_store:e}),this.trade=new Xu({root_store:e})},$u=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.client=e.client,this.common=e.common,this.modules=new Ju(this,e),this.ui=e.ui,this.gtm=e.gtm,this.rudderstack=e.rudderstack,this.pushwoosh=e.pushwoosh};(0,F.configure)({enforceActions:"observed"});function Ku(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var Qu=s()({loader:function(){return r.e("trade-modals").then(r.bind(r,"./App/Containers/Modals/index.js"))},loading:function(){return null}}),tp=function(t){var e=t.passthrough,r=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ku(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ku(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.useState(function(t,e){return Yu||(Ws().init(t.common),(0,p.setWebsocket)(e),Yu=new $u(t))}(e.root_store,e.WS)),1)[0];return i.useEffect((function(){return function(){return r.ui.setPromptHandler(!1)}}),[]),i.createElement(m.z1,{store:r},i.createElement(i.Fragment,null,i.createElement(Se,null),i.createElement(Qu,null),i.createElement(Qe.S,null),i.createElement(Ye,{store:r}),i.createElement(Xe,null),i.createElement(Ke,{store:r})))};tp.propTypes={passthrough:n().shape({root_store:n().object,WS:n().object})};const ep=tp},"./Constants/contract.js":(t,e,r)=>{"use strict";r.d(e,{gk:()=>c,lA:()=>l,n2:()=>u,NC:()=>p,FT:()=>d,h8:()=>f,ng:()=>_});var o=r("react"),n=r("@deriv/translations");function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(){return{APPLY:(0,n.localize)("Apply"),STAKE:(0,n.localize)("Stake:"),CLOSE:(0,n.localize)("Close"),CANCEL:(0,n.localize)("Cancel"),CURRENT_STAKE:(0,n.localize)("Current stake:"),DEAL_CANCEL_FEE:(0,n.localize)("Deal cancel. fee:"),TAKE_PROFIT:(0,n.localize)("Take profit:"),BUY_PRICE:(0,n.localize)("Buy price:"),STOP_LOSS:(0,n.localize)("Stop loss:"),TOTAL_PROFIT_LOSS:(0,n.localize)("Total profit/loss:"),PROFIT_LOSS:(0,n.localize)("Profit/Loss:"),POTENTIAL_PROFIT_LOSS:(0,n.localize)("Potential profit/loss:"),INDICATIVE_PRICE:(0,n.localize)("Indicative price:"),PAYOUT:(0,n.localize)("Sell price:"),PURCHASE_PRICE:(0,n.localize)("Buy price:"),POTENTIAL_PAYOUT:(0,n.localize)("Payout limit:"),TICK:(0,n.localize)("Tick "),WON:(0,n.localize)("Won"),LOST:(0,n.localize)("Lost"),DAYS:(0,n.localize)("days"),DAY:(0,n.localize)("day"),SELL:(0,n.localize)("Sell"),INCREMENT_VALUE:(0,n.localize)("Increment value"),DECREMENT_VALUE:(0,n.localize)("Decrement value"),TAKE_PROFIT_LOSS_NOT_AVAILABLE:(0,n.localize)("Take profit and/or stop loss are not available while deal cancellation is active."),DONT_SHOW_THIS_AGAIN:(0,n.localize)("Don't show this again"),RESALE_NOT_OFFERED:(0,n.localize)("Resale not offered"),NOT_AVAILABLE:(0,n.localize)("N/A")}},l=function(){return{FRXAUDCAD:(0,n.localize)("AUD/CAD"),FRXAUDCHF:(0,n.localize)("AUD/CHF"),FRXAUDJPY:(0,n.localize)("AUD/JPY"),FRXAUDNZD:(0,n.localize)("AUD/NZD"),FRXAUDPLN:(0,n.localize)("AUD/PLN"),FRXAUDUSD:(0,n.localize)("AUD/USD"),FRXBROUSD:(0,n.localize)("Oil/USD"),FRXEURAUD:(0,n.localize)("EUR/AUD"),FRXEURCAD:(0,n.localize)("EUR/CAD"),FRXEURCHF:(0,n.localize)("EUR/CHF"),FRXEURGBP:(0,n.localize)("EUR/GBP"),FRXEURJPY:(0,n.localize)("EUR/JPY"),FRXEURNZD:(0,n.localize)("EUR/NZD"),FRXEURUSD:(0,n.localize)("EUR/USD"),FRXGBPAUD:(0,n.localize)("GBP/AUD"),FRXGBPCAD:(0,n.localize)("GBP/CAD"),FRXGBPCHF:(0,n.localize)("GBP/CHF"),FRXGBPJPY:(0,n.localize)("GBP/JPY"),FRXGBPNOK:(0,n.localize)("GBP/NOK"),FRXGBPUSD:(0,n.localize)("GBP/USD"),FRXNZDJPY:(0,n.localize)("NZD/JPY"),FRXNZDUSD:(0,n.localize)("NZD/USD"),FRXUSDCAD:(0,n.localize)("USD/CAD"),FRXUSDCHF:(0,n.localize)("USD/CHF"),FRXUSDJPY:(0,n.localize)("USD/JPY"),FRXUSDNOK:(0,n.localize)("USD/NOK"),FRXUSDPLN:(0,n.localize)("USD/PLN"),FRXUSDSEK:(0,n.localize)("USD/SEK"),FRXXAGUSD:(0,n.localize)("Silver/USD"),FRXXAUUSD:(0,n.localize)("Gold/USD"),FRXXPDUSD:(0,n.localize)("Palladium/USD"),FRXXPTUSD:(0,n.localize)("Platinum/USD"),OTC_AEX:(0,n.localize)("Dutch Index"),OTC_AS51:(0,n.localize)("Australian Index"),OTC_DJI:(0,n.localize)("Wall Street Index"),OTC_FCHI:(0,n.localize)("French Index"),OTC_FTSE:(0,n.localize)("UK Index"),OTC_GDAXI:(0,n.localize)("German Index"),OTC_HSI:(0,n.localize)("Hong Kong Index"),OTC_IBEX35:(0,n.localize)("Spanish Index"),OTC_N225:(0,n.localize)("Japanese Index"),OTC_NDX:(0,n.localize)("US Tech Index"),OTC_SPC:(0,n.localize)("US Index"),OTC_SSMI:(0,n.localize)("Swiss Index"),OTC_SX5E:(0,n.localize)("Euro 50 Index"),R_10:(0,n.localize)("Volatility 10 Index"),R_25:(0,n.localize)("Volatility 25 Index"),R_50:(0,n.localize)("Volatility 50 Index"),R_75:(0,n.localize)("Volatility 75 Index"),R_100:(0,n.localize)("Volatility 100 Index"),BOOM300N:(0,n.localize)("Boom 300 Index"),BOOM500:(0,n.localize)("Boom 500 Index"),BOOM1000:(0,n.localize)("Boom 1000 Index"),CRASH300N:(0,n.localize)("Crash 300 Index"),CRASH500:(0,n.localize)("Crash 500 Index"),CRASH1000:(0,n.localize)("Crash 1000 Index"),RDBEAR:(0,n.localize)("Bear Market Index"),RDBULL:(0,n.localize)("Bull Market Index"),STPRNG:(0,n.localize)("Step Index"),WLDAUD:(0,n.localize)("AUD Index"),WLDEUR:(0,n.localize)("EUR Index"),WLDGBP:(0,n.localize)("GBP Index"),WLDXAU:(0,n.localize)("Gold Index"),WLDUSD:(0,n.localize)("USD Index"),"1HZ10V":(0,n.localize)("Volatility 10 (1s) Index"),"1HZ100V":(0,n.localize)("Volatility 100 (1s) Index"),"1HZ200V":(0,n.localize)("Volatility 200 (1s) Index"),"1HZ300V":(0,n.localize)("Volatility 300 (1s) Index"),JD10:(0,n.localize)("Jump 10 Index"),JD25:(0,n.localize)("Jump 25 Index"),JD50:(0,n.localize)("Jump 50 Index"),JD75:(0,n.localize)("Jump 75 Index"),JD100:(0,n.localize)("Jump 100 Index"),JD150:(0,n.localize)("Jump 150 Index"),JD200:(0,n.localize)("Jump 200 Index"),CRYBCHUSD:(0,n.localize)("BCH/USD"),CRYBNBUSD:(0,n.localize)("BNB/USD"),CRYBTCLTC:(0,n.localize)("BTC/LTC"),CRYIOTUSD:(0,n.localize)("IOT/USD"),CRYNEOUSD:(0,n.localize)("NEO/USD"),CRYOMGUSD:(0,n.localize)("OMG/USD"),CRYTRXUSD:(0,n.localize)("TRX/USD"),CRYBTCETH:(0,n.localize)("BTC/ETH"),CRYZECUSD:(0,n.localize)("ZEC/USD"),CRYXMRUSD:(0,n.localize)("ZMR/USD"),CRYXMLUSD:(0,n.localize)("XLM/USD"),CRYXRPUSD:(0,n.localize)("XRP/USD"),CRYBTCUSD:(0,n.localize)("BTC/USD"),CRYDSHUSD:(0,n.localize)("DSH/USD"),CRYETHUSD:(0,n.localize)("ETH/USD"),CRYEOSUSD:(0,n.localize)("EOS/USD"),CRYLTCUSD:(0,n.localize)("LTC/USD")}},u=function(){return{EXPIRYMISS:{name:o.createElement(n.Localize,{i18n_default_text:"Ends Outside"}),position:"top"},EXPIRYRANGE:{name:o.createElement(n.Localize,{i18n_default_text:"Ends Between"}),position:"bottom"},RANGE:{name:o.createElement(n.Localize,{i18n_default_text:"Stays Between"}),position:"top"},UPORDOWN:{name:o.createElement(n.Localize,{i18n_default_text:"Goes Outside"}),position:"bottom"},RESETCALL:{name:o.createElement(n.Localize,{i18n_default_text:"Reset Call"}),position:"top"},RESETPUT:{name:o.createElement(n.Localize,{i18n_default_text:"Reset Put"}),position:"bottom"},TICKHIGH:{name:o.createElement(n.Localize,{i18n_default_text:"High Tick"}),position:"top"},TICKLOW:{name:o.createElement(n.Localize,{i18n_default_text:"Low Tick"}),position:"bottom"},ASIANU:{name:o.createElement(n.Localize,{i18n_default_text:"Asian Up"}),position:"top"},ASIAND:{name:o.createElement(n.Localize,{i18n_default_text:"Asian Down"}),position:"bottom"},LBFLOATCALL:{name:o.createElement(n.Localize,{i18n_default_text:"Close-to-Low"}),position:"top"},LBFLOATPUT:{name:o.createElement(n.Localize,{i18n_default_text:"High-to-Close"}),position:"top"},LBHIGHLOW:{name:o.createElement(n.Localize,{i18n_default_text:"High-to-Low"}),position:"top"},CALLSPREAD:{name:o.createElement(n.Localize,{i18n_default_text:"Spread Up"}),position:"top"},PUTSPREAD:{name:o.createElement(n.Localize,{i18n_default_text:"Spread Down"}),position:"bottom"},RUNHIGH:{name:o.createElement(n.Localize,{i18n_default_text:"Only Ups"}),position:"top"},RUNLOW:{name:o.createElement(n.Localize,{i18n_default_text:"Only Downs"}),position:"bottom"}}},p=function(t){return{CALL:{name:t?o.createElement(n.Localize,{i18n_default_text:"Higher"}):o.createElement(n.Localize,{i18n_default_text:"Rise"}),position:"top"},PUT:{name:t?o.createElement(n.Localize,{i18n_default_text:"Lower"}):o.createElement(n.Localize,{i18n_default_text:"Fall"}),position:"bottom"},CALLE:{name:o.createElement(n.Localize,{i18n_default_text:"Rise"}),position:"top"},PUTE:{name:o.createElement(n.Localize,{i18n_default_text:"Fall"}),position:"bottom"},DIGITMATCH:{name:o.createElement(n.Localize,{i18n_default_text:"Matches"}),position:"top"},DIGITDIFF:{name:o.createElement(n.Localize,{i18n_default_text:"Differs"}),position:"bottom"},DIGITEVEN:{name:o.createElement(n.Localize,{i18n_default_text:"Even"}),position:"top"},DIGITODD:{name:o.createElement(n.Localize,{i18n_default_text:"Odd"}),position:"bottom"},DIGITOVER:{name:o.createElement(n.Localize,{i18n_default_text:"Over"}),position:"top"},DIGITUNDER:{name:o.createElement(n.Localize,{i18n_default_text:"Under"}),position:"bottom"},ONETOUCH:{name:o.createElement(n.Localize,{i18n_default_text:"Touch"}),position:"top"},NOTOUCH:{name:o.createElement(n.Localize,{i18n_default_text:"No Touch"}),position:"bottom"},MULTUP:{name:o.createElement(n.Localize,{i18n_default_text:"Up"}),position:"top"},MULTDOWN:{name:o.createElement(n.Localize,{i18n_default_text:"Down"}),position:"bottom"}}},d=function(t){return a(a({},p(t)),u())},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return d(e)[t]?d(e)[t.toUpperCase()].name:""},_=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return d(e)[t]?d(e)[t.toUpperCase()].position:"top"}},"./Constants/index.js":(t,e,r)=>{"use strict";r.d(e,{FT:()=>o.FT,lA:()=>o.lA,NC:()=>o.NC,n2:()=>o.n2});var o=r("./Constants/contract.js")},"./Modules/Contract/Components/Digits/index.js":(t,e,r)=>{"use strict";r.d(e,{Z:()=>U});var o=r("../../../node_modules/classnames/index.js"),n=r.n(o),i=r("../../../node_modules/prop-types/index.js"),a=r.n(i),s=r("react"),c=r("mobx"),l=r("@deriv/components"),u=r("@deriv/shared"),p=r("@deriv/translations"),d=r("./Stores/Modules/Contract/Helpers/logic.js"),f=r("./App/Components/Animations/index.js"),_=r("./Constants/index.js"),y=function(t){var e=t.current_spot,r=t.is_selected_winning,o=t.is_lost,i=t.is_won;return s.createElement(s.Fragment,null,s.createElement(l.Text,{size:"xs",align:"center",weight:"bold",className:"digits__digit-spot-value"},e.slice(0,-1)),s.createElement("span",{className:n()("digits__digit-spot-last",{"digits__digit-spot-last--selected-win":r,"digits__digit-spot-last--win":i,"digits__digit-spot-last--loss":o})},e.slice(-1)))};y.propTypes={current_spot:a().string,is_lost:a().bool,is_won:a().bool};const b=y;var m=r("mobx-react"),h=function(t){var e=t.is_latest,r=t.is_lost,o=t.is_selected,i=t.is_won,a=t.percentage,c=t.value,l=a&&!isNaN(a)?parseFloat(a).toFixed(1):null;return s.createElement(s.Fragment,null,s.createElement("span",{className:n()("digits__digit-value",{"digits__digit-value--latest":e,"digits__digit-value--selected":o,"digits__digit-value--win":i&&e,"digits__digit-value--loss":r&&e})},s.createElement("i",{className:n()("digits__digit-display-value",{"digits__digit-display-value--no-stats":!l})},c),!!l&&s.createElement("i",{className:"digits__digit-display-percentage"},l,"%")))};h.propTypes={is_latest:a().bool,is_lost:a().bool,is_selected:a().bool,is_trade_page:a().bool,is_won:a().bool,value:a().number};const g=h;var v=function(t){var e=t.is_max,r=t.is_min,o=t.is_selected,i=t.percentage,a=(i-10)/4;a=((a=Math.min(Math.max(a,-1),1))+1)/2*.85+.15;var c=339.292,l=(20*i-102)/3/100;return l=Math.max(Math.min(l,.66),.06),s.createElement("div",{className:n()("digits__pie-container",{"digits__pie-container--selected":o})},s.createElement("svg",{className:"digits__pie-progress",width:"120",height:"120",viewBox:"0 0 120 120"},s.createElement("circle",{className:"progress__bg",cx:"60",cy:"60",r:"54",fill:"none",stroke:"#E8EEFC",strokeWidth:"12"}),i&&s.createElement("circle",{className:n()("progress__value",{"progress__value--is-max":e,"progress__value--is-min":r}),cx:"60",cy:"60",r:"54",fill:"none",strokeOpacity:e||r?1:a,strokeWidth:"12",strokeDasharray:[c*l,c*(1-l)],strokeDashoffset:c*((l+1)/2)})))};v.propTypes={is_max:a().bool,is_min:a().bool,percentage:a().number};const w=v;var O=function(t){var e=t.barrier,r=t.is_digit_contract,o=t.has_entry_spot,i=t.is_lost,a=t.is_max,c=t.is_min,p=t.is_won,d=t.onSelect,_=t.latest_digit,y=t.selected_digit,m=t.status,h=t.stats,v=t.value,O=t.onLastDigitSpot,S=_.digit,k=_.spot,P=v===S,E=v===e,C=S===e,x=h?100*h/1e3:null;s.useEffect((function(){O&&O({spot:k,is_lost:i,is_selected_winning:C,is_latest:P,is_won:p})}),[_,k,e,v,i,C,P,p,O]);var j=(0,u.isMobile)()&&"function"==typeof d&&!m,D=(0,u.isMobile)()&&v===y&&!m;return s.createElement("div",{className:n()("digits__digit",{"digits__digit--latest":P,"digits__digit--win":p&&P,"digits__digit--loss":i&&P,"digits__digit--is-selectable":j,"digits__digit--is-selected":D}),onClick:function(){j&&d(v)}},s.createElement(w,{is_min:c,is_max:a,is_selected:E,percentage:x}),s.createElement(l.DesktopWrapper,null,s.createElement(f.s,{is_visible:!!(r&&P&&k&&m&&o),className:"digits__digit-spot",keyname:"digits__digit-spot"},s.createElement(b,{current_spot:k,is_lost:i,is_selected_winning:C,is_visible:!(!P||!k),is_won:p}))),s.createElement(g,{is_latest:P,is_lost:i,is_selected:E,is_won:p,percentage:x,value:v}))};O.propTypes={barrier:a().number,has_entry_spot:a().bool,is_lost:a().bool,is_won:a().bool,latest_digit:a().object,value:a().number};const S=(0,m.observer)(O);var k=function(t){var e=t.is_lost,r=t.is_trade_page,o=t.is_won,i=t.position;return s.createElement(s.Fragment,null,!!i&&s.createElement("span",{className:"digits__pointer",style:{transform:"translate3d(calc(".concat(i.left,"px), ").concat(i.top,"px, 0px)")}},s.createElement(l.Icon,{icon:"IcProfit",className:n()("digits__icon",{"digits__icon--win":o&&!r,"digits__icon--loss":e&&!r}),color:o?"green":"red",custom_color:o||e?void 0:"var(--brand-orange)"})))};k.propTypes={is_lost:a().bool,is_won:a().bool,position:a().object};const P=k;function E(t){return function(t){if(Array.isArray(t))return j(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||x(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||x(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){if(t){if("string"==typeof t)return j(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(t,e):void 0}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var D=Array.from(Array(10).keys()),T=function(t){var e=t.barrier,r=t.contract_type,o=t.digits,i=t.digits_info,a=t.dimension,c=t.is_digit_contract,l=t.has_entry_spot,p=t.is_ended,d=t.is_trade_page,f=t.onDigitChange,_=t.onLastDigitSpot,y=t.selected_digit,b=t.status,m=t.tick,h=t.trade_type,g=C(s.useState({0:{left:6,top:0},1:{left:6+1*a,top:0},2:{left:6+2*a,top:0},3:{left:6+3*a,top:0},4:{left:6+4*a,top:0},5:{left:6+5*a,top:0},6:{left:6+6*a,top:0},7:{left:6+7*a,top:0},8:{left:6+8*a,top:0},9:{left:6+9*a,top:0}}),1)[0],v=C(s.useState({0:{left:6,top:-60},1:{left:6+1*a,top:-60},2:{left:6+2*a,top:-60},3:{left:6+3*a,top:-60},4:{left:6+4*a,top:-60},5:{left:6+0*a,top:8},6:{left:6+1*a,top:8},7:{left:6+2*a,top:8},8:{left:6+3*a,top:8},9:{left:6+4*a,top:8}}),1)[0],w=function(t){k()&&t!==y&&"function"==typeof f&&f({target:{name:"last_digit",value:t}})},O=function(){return(0,u.isMobile)()?v:g},k=function(){return!!(0,u.isMobile)()&&"even_odd"!==h},x=Object.keys(i).sort().map((function(t){return i[t]})).slice(-1)[0]||{},j=p&&"won"===b&&c,T=p&&"lost"===b&&c,A=o?Math.min.apply(Math,E(o)):null,z=o?Math.max.apply(Math,E(o)):null,M=m?+m.pip_size:null,R=m&&m.ask?m.ask.toFixed(M):null,L=R?+R.split("").pop():null,I=m?O()[L]:O()[x.digit],N=j||T?x:{digit:L,spot:R};return s.createElement("div",{className:n()("digits",{"digits--trade":d})},D.map((function(t){return s.createElement(S,{barrier:(n=t,i={DIGITMATCH:function(t){return t===e},DIGITDIFF:function(t){return t!==e&&!isNaN(e)},DIGITOVER:function(t){return t>e},DIGITUNDER:function(t){return t<e},DIGITODD:function(t){return t%2},DIGITEVEN:function(t){return!(t%2)}},r&&i[r]&&i[r](n)?n:null),has_entry_spot:l,is_digit_contract:c,is_lost:T,is_trade_page:d,is_won:j,key:t,is_max:o?o[t]===z:null,is_min:o?o[t]===A:null,stats:o?o[t]:null,status:b,latest_digit:d?N:x,value:t,onLastDigitSpot:_,onSelect:k()?w:null,selected_digit:!!k()&&y});var n,i})),s.createElement(P,{is_lost:T,is_trade_page:d,is_won:j,position:I}))};T.propTypes={barrier:a().number,contract_type:a().string,digits_info:a().object,is_ended:a().bool,status:a().string,trade_type:a().string,onDigitChange:a().func,selected_digit:a().number};const A=(0,m.observer)(T);var z=["contract_info","digits_array","digits_info","display_status","is_digit_contract","is_ended","is_trade_page","onDigitChange","selected_digit","trade_type","onChangeStatus"];function M(){return M=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},M.apply(this,arguments)}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var I=function(t){var e=t.contract_info,r=t.digits_array,o=t.digits_info,n=t.display_status,i=t.is_digit_contract,a=t.is_ended,l=t.is_trade_page,p=t.onDigitChange,f=t.selected_digit,_=t.trade_type,y=t.onChangeStatus,b=function(t,e){if(null==t)return{};var r,o,n=function(t,e){if(null==t)return{};var r,o,n={},i=Object.keys(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(t,z),m=e.date_start,h=b.tick,g=!l||!!h,v=!!l&&(0,d.xF)(e,h),w=!v&&g?n:null;if(m&&!v){h=null;var O=e.tick_stream;if(O&&O.length){var S=(0,c.toJS)(O.slice(-1)[0]);h={ask:S.tick,bid:S.tick,epoch:S.epoch,pip_size:S.tick_display_value.split(".")[1].length,current_tick:O.length}}}return s.useEffect((function(){y&&y({status:w,current_tick:h?h.current_tick:null})}),[h,l,n,y,w]),s.createElement(A,{dimension:(0,u.isMobile)()?64:52,has_entry_spot:!!e.entry_tick,barrier:!v&&g?+e.barrier:null,contract_type:!v&&g?e.contract_type:null,digits:r,digits_info:!v&&g?o:{},is_digit_contract:i,is_ended:a,is_trade_page:l,status:w,tick:h,trade_type:_,onDigitChange:p,selected_digit:f,onLastDigitSpot:b.onLastDigitSpot})},N=s.memo((function(t){var e,r=R(s.useState(),2),o=r[0],i=r[1],a=R(s.useState(),2),c=a[0],d=a[1],y=R(s.useState(),2),m=y[0],h=y[1],g=R(s.useState(),2),v=g[0],w=g[1],O=R(s.useState(),2),S=O[0],k=O[1],P=R(s.useState(),2),E=P[0],C=P[1],x=R(s.useState(),2),j=x[0],D=x[1],T=(0,u.useIsMounted)(),A=t.contract_info,z=t.digits_array,L=t.is_digit_contract,N=t.is_trade_page,U=t.underlying;return s.createElement(s.Fragment,null,s.createElement(l.DesktopWrapper,null,s.createElement(f.o,{is_visible:(z||L)&&T(),className:"digits__container",keyname:"digits",type:"bottom"},N&&s.createElement("div",{className:"digits__tooltip-container"},s.createElement(l.Popover,{alignment:"top",classNameBubble:"digits__tooltip-bubble",icon:"info",id:"dt_last_digits_info_tooltip",margin:4,message:(e=N?U:A.underlying,(0,p.localize)("Last digit stats for latest 1000 ticks for {{underlying_name}}",{underlying_name:(0,_.lA)()[e.toUpperCase()]}))})),s.createElement(I,t))),s.createElement(l.MobileWrapper,null,s.createElement("div",{className:"digits__container"},s.createElement(f.s,{is_visible:!!(L&&o&&m&&A.entry_tick),className:n()("digits__digit-spot",{"digits__digit-spot--is-trading":N}),keyname:"digits__digit-spot"},N&&s.createElement(l.Text,{size:"xs",align:"center",className:"digits__digit-spot-value"},s.createElement(p.Localize,{i18n_default_text:"Tick {{current_tick}} - ",values:{current_tick:c}})),s.createElement(b,{current_spot:m,is_lost:j,is_selected_winning:v,is_visible:!(!S||!m),is_won:E})),s.createElement(I,M({},t,{onChangeStatus:function(t){i(t.status),d(t.current_tick)},onLastDigitSpot:function(t){h(t.spot),D(t.is_lost),w(t.is_selected_winning),k(t.is_latest),C(t.is_won)}})))))}));N.displayName="Digits",N.propTypes={contract_info:a().object,digits_info:a().object,display_status:a().string,is_digit_contract:a().bool,is_ended:a().bool,is_trade_page:a().bool,trade_type:a().string,onDigitChange:a().func,selected_digit:a().number};const U=N},"./Modules/Page404/index.js":(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});var o=r("react"),n=r("@deriv/components"),i=r("@deriv/shared"),a=r("@deriv/translations");const s=function(){return o.createElement(n.PageError,{header:(0,a.localize)("We couldn’t find that page"),messages:[(0,a.localize)("You may have followed a broken link, or the page has moved to a new address."),(0,a.localize)("Error code: {{error_code}} page not found",{error_code:404})],redirect_urls:[i.routes.trade],redirect_labels:[(0,a.localize)("Return to trade")],classNameImage:"page-404__image",image_url:(0,i.getUrlBase)("/public/images/common/404.png")})}},"./Modules/Reports/Helpers/market-underlying.js":(t,e,r)=>{"use strict";r.d(e,{cS:()=>i,lA:()=>a,ti:()=>s,yu:()=>c});var o=r("./Constants/index.js"),n=r("@deriv/translations"),i=function(t){var e={category:"",underlying:""},r=new RegExp("^([A-Z]+)_((1HZ[0-9-V]+)|((CRASH|BOOM)[0-9\\d]+[A-Z]?)|(OTC_[A-Z0-9]+)|R_[\\d]{2,3}|[A-Z]+)").exec(t);return null!==r&&(e.category=r[1].toLowerCase(),e.underlying=r[2]),e},a=function(t){return t?(0,o.lA)()[t.toUpperCase()]:null},s=function(t){return t?(0,o.FT)()[t.toUpperCase()].name:null},c=function(t,e){if(/^MULTUP|MULTDOWN/.test(e))return"";var r=new RegExp("ticks|tick|seconds|minutes|minute|hour|hours").exec(t);if(null!==r){var o=r[0],i=o[0].toUpperCase()+o.slice(1);return i.endsWith("s")?i:"".concat(i,"s")}return(0,n.localize)("Days")}},"./Modules/SmartChart/Components/bottom-widgets.jsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});var o=r("../../../node_modules/prop-types/index.js"),n=r.n(o),i=r("react"),a=function(t){var e=t.Digits;return i.createElement("div",{className:"bottom-widgets"},e)};a.propTypes={Digits:n().node};const s=a},"./Modules/SmartChart/Components/top-widgets.jsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>y});var o=r("../../../node_modules/prop-types/index.js"),n=r.n(o),i=r("react"),a=r("react-dom"),s=r.n(a),c=r("@deriv/components"),l=r("@deriv/translations"),u=r("@deriv/shared"),p=r("./Stores/connect.js"),d=r("./Modules/SmartChart/index.js"),f=(0,p.$j)((function(t){var e=t.modules;return{granularity:e.contract_trade.granularity,markers_array:e.contract_trade.markers_array}}))((function(t){var e=t.markers_array,r=t.granularity,o=e[e.length-1];if(!o||!o.contract_info.tick_stream)return null;if((0,u.isEnded)(o.contract_info)||0!==r)return null;var n=o.contract_info,a=n.contract_type,s=n.tick_stream,p=n.tick_count,d=(0,u.isDigitContract)(a)?s.length:Math.max(s.length-1,0);return i.createElement(c.Text,{weight:"bold",className:"recent-trade-info"},(0,l.localize)("Tick")," ",d,"/",p)})),_=function(t){var e=t.InfoBox,r=t.is_mobile,o=t.is_title_enabled,n=void 0===o||o,a=t.onSymbolChange,l=t.y_axis_width,u=t.theme,p=t.open_market,_=t.open,y=t.is_digits_widget_active,b=i.createElement(d.oP,{open_market:p,open:_,enabled:n,onChange:a,searchInputClassName:"data-hj-whitelist",isNestedList:r,portalNodeId:r?"deriv_app":void 0}),m=s().createPortal(i.createElement("div",{className:"smartcharts-".concat(u)},i.createElement("div",{className:"top-widgets-portal",style:{width:"calc(100% - ".concat(l?l+5:0,"px)")}},b,!y&&i.createElement(f,null))),document.getElementById("app_contents"));return i.createElement(i.Fragment,null,e,i.createElement(c.MobileWrapper,null,m),i.createElement(c.DesktopWrapper,null,b))};_.propTypes={InfoBox:n().node,is_mobile:n().bool,is_title_enabled:n().bool,onSymbolChange:n().func};const y=_},"./Modules/SmartChart/index.js":(t,e,r)=>{"use strict";r.d(e,{Xb:()=>s,oP:()=>c,oY:()=>l,NU:()=>u,mB:()=>p,as:()=>d,kO:()=>f,av:()=>_,KW:()=>y,If:()=>b});var o=r("react"),n=r("@deriv/shared"),i=Promise.resolve().then(r.t.bind(r,"@deriv/deriv-charts",23));i.then((function(t){(0,t.setSmartChartsPublicPath)((0,n.getUrlBase)("/js/smartcharts/"))}));var a=function(t){return function(){return i.then((function(e){return{default:e[t]}}))}},s=o.lazy(a("SmartChart")),c=o.lazy(a("ChartTitle")),l=(a("ChartSize"),o.lazy(a("ChartMode"))),u=o.lazy(a("DrawTools")),p=o.lazy(a("Share")),d=o.lazy(a("StudyLegend")),f=o.lazy(a("Views")),_=o.lazy(a("ToolbarWidget")),y=o.lazy(a("FastMarker")),b=o.lazy(a("RawMarker"))},"./Modules/Trading/Containers/toast-popup.jsx":(t,e,r)=>{"use strict";r.d(e,{a:()=>y,S:()=>m});var o=r("../../../node_modules/classnames/index.js"),n=r.n(o),i=r("../../../node_modules/prop-types/index.js"),a=r.n(i),s=r("react"),c=r("react-dom"),l=r.n(c),u=r("@deriv/components"),p=r("./Stores/connect.js"),d=["portal_id","children","className"];function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function _(){return _=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},_.apply(this,arguments)}var y=function(t){var e=t.portal_id,r=void 0===e?"popup_root":e,o=t.children,i=t.className,a=function(t,e){if(null==t)return{};var r,o,n=function(t,e){if(null==t)return{};var r,o,n={},i=Object.keys(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(t,d);return document.getElementById(r)?l().createPortal(s.createElement(u.Toast,_({className:n()("dc-toast-popup",i)},a),o),document.getElementById(r)):null},b=function(t){var e=t.status,r=t.portal_id,o=t.message,i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(s.useState(!1),2),a=i[0],c=i[1];return document.getElementById(r)&&o?(a||"online"===e?a&&"online"===e&&setTimeout((function(){c(!1)}),1500):c(!0),l().createPortal(s.createElement(u.MobileWrapper,null,s.createElement(u.Toast,{className:n()({"dc-toast--blinker":"blinker"===e}),is_open:a,timeout:0,type:"error"},o)),document.getElementById(r))):null};b.propTypes={portal_id:a().string,status:a().string,message:a().string};var m=(0,p.$j)((function(t){return{network_status:t.common.network_status}}))((function(t){var e=t.network_status;return s.createElement(b,{portal_id:"popup_root",message:e.tooltip,status:e.class})}))},"./Modules/Trading/Helpers/digits.js":(t,e,r)=>{"use strict";r.d(e,{A:()=>i,H:()=>a});var o=["even_odd","match_diff","over_under"],n=["DIGITDIFF","DIGITMATCH","DIGITOVER","DIGITUNDER","DIGITEVEN","DIGITODD"],i=function(t){return o.includes(t)},a=function(t){return n.includes(t)}},"./Stores/Modules/CFD/Helpers/cfd-config.js":(t,e,r)=>{"use strict";r.d(e,{D:()=>n,o:()=>i});var o=r("@deriv/translations"),n=function(){var t={account_type:"",leverage:500,short_title:(0,o.localize)("Synthetic")},e={account_type:"financial",leverage:1e3,short_title:(0,o.localize)("Financial")};return{demo:{synthetic:{dxtrade_account_type:t.account_type,leverage:t.leverage,title:(0,o.localize)("Demo Synthetic"),short_title:t.short_title},financial:{dxtrade_account_type:e.account_type,leverage:e.leverage,title:(0,o.localize)("Demo Financial"),short_title:e.short_title}},real:{synthetic:{dxtrade_account_type:t.account_type,leverage:t.leverage,title:(0,o.localize)("Synthetic"),short_title:t.short_title},financial:{dxtrade_account_type:e.account_type,leverage:e.leverage,title:(0,o.localize)("Financial"),short_title:e.short_title}}}},i=function(t){var e={account_type:"",leverage:500,short_title:(0,o.localize)("Synthetic")},r={account_type:"financial",leverage:1e3,short_title:t?(0,o.localize)("CFDs"):(0,o.localize)("Financial")},n={account_type:"financial_stp",leverage:100,short_title:(0,o.localize)("Financial STP")};return{demo:{synthetic:{mt5_account_type:e.account_type,leverage:e.leverage,title:(0,o.localize)("Demo Synthetic"),short_title:e.short_title},financial:{mt5_account_type:r.account_type,leverage:r.leverage,title:t?(0,o.localize)("Demo CFDs"):(0,o.localize)("Demo Financial"),short_title:r.short_title},financial_stp:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,o.localize)("Demo Financial STP"),short_title:n.short_title}},real:{synthetic:{mt5_account_type:e.account_type,leverage:e.leverage,title:(0,o.localize)("Synthetic"),short_title:e.short_title},financial:{mt5_account_type:r.account_type,leverage:r.leverage,title:t?(0,o.localize)("CFDs"):(0,o.localize)("Financial"),short_title:r.short_title},financial_stp:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,o.localize)("Financial STP"),short_title:n.short_title}}}}},"./Stores/Modules/CFD/cfd-store.js":(t,e,r)=>{"use strict";r.d(e,{default:()=>dt});var o,n,i,a,s,c,l,u,p,d,f,_,y,b,m,h,g,v,w,O,S,k,P,E,C,x,j,D,T,A,z,M,R,L,I,N,U,F,B,H,W,V,G,q,Y,Z=r("mobx"),X=r("@deriv/shared"),J=r("./Stores/base-store.js"),$=r("./Stores/Modules/CFD/Helpers/cfd-config.js");function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Q(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function tt(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){Q(i,o,n,a,s,"next",t)}function s(t){Q(i,o,n,a,s,"throw",t)}a(void 0)}))}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function rt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function ot(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(r),!0).forEach((function(e){nt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function nt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function it(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function at(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function st(t,e){return st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},st(t,e)}function ct(t,e){return!e||"object"!==K(e)&&"function"!=typeof e?lt(t):e}function lt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ut(t){return ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ut(t)}function pt(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var dt=(o=Z.action.bound,n=Z.action.bound,i=Z.action.bound,a=Z.action.bound,s=Z.action.bound,c=Z.action.bound,l=Z.action.bound,u=Z.action.bound,p=Z.action.bound,d=Z.action.bound,f=Z.action.bound,_=Z.action.bound,y=Z.action.bound,b=Z.action.bound,m=Z.action.bound,h=Z.action.bound,g=Z.action.bound,v=Z.action.bound,w=Z.action.bound,O=Z.action.bound,S=Z.action.bound,k=Z.action.bound,P=Z.action.bound,E=Z.action.bound,C=Z.action.bound,x=Z.action.bound,j=Z.action.bound,D=Z.action.bound,T=Z.action.bound,A=Z.action.bound,z=Z.action.bound,M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(d,t);var e,r,o,n,i,a,s,c,l,u,p=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=ut(t);if(e){var n=ut(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return ct(this,r)}}(d);function d(t){var e,r=t.root_store;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),it(e=p.call(this,{root_store:r}),"is_compare_accounts_visible",R,lt(e)),it(e,"account_type",L,lt(e)),it(e,"new_account_response",I,lt(e)),it(e,"map_type",N,lt(e)),it(e,"has_cfd_error",U,lt(e)),it(e,"error_message",F,lt(e)),it(e,"is_cfd_success_dialog_enabled",B,lt(e)),it(e,"is_mt5_financial_stp_modal_open",H,lt(e)),it(e,"is_cfd_password_modal_enabled",W,lt(e)),it(e,"is_cfd_reset_password_modal_enabled",V,lt(e)),it(e,"is_cfd_pending_dialog_open",G,lt(e)),it(e,"current_account",q,lt(e)),it(e,"error_type",Y,lt(e)),e}return e=d,r=[{key:"has_cfd_account",get:function(){return this.current_list.length>0}},{key:"account_title",get:function(){return this.account_type.category?(0,$.o)(this.root_store.client.is_eu)[this.account_type.category][this.account_type.type].title:""}},{key:"current_list",get:function(){var t=[];return this.root_store.client.mt5_login_list.forEach((function(e){t[(0,X.getAccountListKey)(e,X.CFD_PLATFORMS.MT5)]=ot({},e)})),this.root_store.client.dxtrade_accounts_list.forEach((function(e){t[(0,X.getAccountListKey)(e,X.CFD_PLATFORMS.DXTRADE)]=ot({},e)})),t}},{key:"mt5_companies",get:function(){return(0,$.o)(this.root_store.client.is_eu)}},{key:"dxtrade_companies",get:function(){return(0,$.D)()}},{key:"onMount",value:function(){this.checkShouldOpenAccount(),this.onRealAccountSignupEnd(this.realAccountSignupEndListener),this.root_store.ui.is_cfd_page=!0}},{key:"onUnmount",value:function(){this.disposeRealAccountSignupEnd(),this.root_store.ui.is_cfd_page=!1}},{key:"checkShouldOpenAccount",value:function(){var t=sessionStorage.getItem("open_cfd_account_type");if(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return et(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.split("."),3),r=e[0],o=e[1],n=e[2];this.createCFDAccount({category:r,type:o,set_password:n}),sessionStorage.removeItem("open_cfd_account_type")}}},{key:"realAccountSignupEndListener",value:function(){var t=JSON.parse(sessionStorage.getItem("post_real_account_signup"));return t&&t.category&&t.type&&(sessionStorage.removeItem("post_real_account_signup"),this.enableCFDPasswordModal()),Promise.resolve()}},{key:"resetFormErrors",value:function(){this.error_message="",this.error_type=void 0,this.has_cfd_error=!1}},{key:"clearCFDError",value:function(){this.resetFormErrors(),this.is_cfd_password_modal_enabled=!1}},{key:"createCFDAccount",value:function(t){var e=t.category,r=t.type,o=t.set_password;this.clearCFDError(),this.setAccountType({category:e,type:r}),"real"===e?this.realCFDSignup(o):this.demoCFDSignup()}},{key:"demoCFDSignup",value:function(){this.enableCFDPasswordModal()}},{key:"disableCFDPasswordModal",value:function(){this.is_cfd_password_modal_enabled=!1}},{key:"enableCFDPasswordModal",value:function(){this.is_cfd_password_modal_enabled=!0}},{key:"getName",value:function(){var t=(this.root_store.client.account_settings&&this.root_store.client.account_settings).first_name,e=this.mt5_companies[this.account_type.category][this.account_type.type].title;return t?[t,e].join(" "):e}},{key:"openMT5Account",value:function(t){var e=this.getName(),r=this.mt5_companies[this.account_type.category][this.account_type.type].leverage,o=(0,X.getAccountTypeFields)(this.account_type);return X.WS.mt5NewAccount(ot(ot({mainPassword:t.password,email:this.root_store.client.email_address,leverage:r,name:e},t.server?{server:t.server}:{}),o))}},{key:"openCFDAccount",value:function(t){return X.WS.tradingPlatformNewAccount({password:t.password,platform:t.platform,account_type:this.account_type.category,market_type:this.account_type.type})}},{key:"beginRealSignupForMt5",value:function(){sessionStorage.setItem("post_real_account_signup",JSON.stringify(this.account_type)),this.root_store.ui.openRealAccountSignup()}},{key:"realCFDSignup",value:function(t){switch(this.account_type.type){case"financial":case"synthetic":this.enableCFDPasswordModal();break;case"financial_stp":this.root_store.client.fetchResidenceList(),this.root_store.client.fetchStatesList(),this.root_store.client.fetchAccountSettings(),t?this.enableCFDPasswordModal():this.enableMt5FinancialStpModal();break;default:throw new Error("Cannot determine mt5 account signup.")}}},{key:"enableMt5FinancialStpModal",value:function(){"real"===this.account_type.category&&"financial_stp"===this.account_type.type&&(this.is_mt5_financial_stp_modal_open=!0)}},{key:"setAccountType",value:function(t){this.account_type=t}},{key:"setCurrentAccount",value:function(t,e){this.current_account=ot(ot({},e),t)}},{key:"setError",value:function(t,e){var r;this.has_cfd_error=t,this.error_message=e?e.message:"",this.error_type=null!==(r=null==e?void 0:e.code)&&void 0!==r?r:void 0}},{key:"setCFDNewAccount",value:function(t){this.new_account_response=t}},{key:"setCFDSuccessDialog",value:function(t){this.is_cfd_success_dialog_enabled=!!t}},{key:"storeProofOfAddress",value:function(t,e,r){var o=this,n=r.setStatus;return new Promise((function(r,i){n({msg:""}),o.setState({is_btn_loading:!0}),X.WS.setSettings(e).then((function(e){e.error?(n({msg:e.error.message}),i(e)):(o.root_store.fetchAccountSettings(),t.current.upload().then((function(t){t.warning?(n({msg:t.message}),i(t)):X.WS.authorized.storage.getAccountStatus().then((function(t){var e=t.error,o=t.get_account_status;e&&i(e);var n=o.authentication.identity,a=!(n&&"none"===n.status);r({identity:n,has_poi:a})}))})))}))}))}},{key:"getAccountStatus",value:(u=tt(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e===X.CFD_PLATFORMS.MT5&&this.root_store.client.is_mt5_password_not_set||e===X.CFD_PLATFORMS.DXTRADE&&this.root_store.client.is_dxtrade_password_not_set)){t.next=4;break}return t.next=4,X.WS.getAccountStatus();case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"creatMT5Password",value:(l=tt(regeneratorRuntime.mark((function t(e,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.WS.tradingPlatformPasswordChange({new_password:e.password,platform:X.CFD_PLATFORMS.MT5});case 2:if(!(o=t.sent).error){t.next=9;break}return this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1}),t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"submitMt5Password",value:(c=tt(regeneratorRuntime.mark((function t(e,r){var o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.root_store.client.is_mt5_password_not_set){t.next=6;break}return t.next=3,this.creatMT5Password(e,r);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return");case 6:return this.resetFormErrors(),t.next=9,this.openMT5Account(e);case 9:if((o=t.sent).error){t.next=30;break}return r.setStatus({success:!0}),r.setSubmitting(!1),this.setError(!1),this.setCFDSuccessDialog(!0),t.next=17,this.getAccountStatus(X.CFD_PLATFORMS.MT5);case 17:return t.next=19,X.WS.authorized.mt5LoginList();case 19:return n=t.sent,this.root_store.client.responseMt5LoginList(n),X.WS.transferBetweenAccounts(),t.t0=this.root_store.client,t.next=25,X.WS.tradingServers();case 25:t.t1=t.sent,t.t0.responseTradingServers.call(t.t0,t.t1),this.setCFDNewAccount(o.mt5_new_account),t.next=36;break;case 30:return t.next=32,this.getAccountStatus(X.CFD_PLATFORMS.MT5);case 32:this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1});case 36:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"createCFDPassword",value:(s=tt(regeneratorRuntime.mark((function t(e,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.WS.tradingPlatformPasswordChange({new_password:e.password,platform:X.CFD_PLATFORMS.DXTRADE});case 2:if(!(o=t.sent).error){t.next=9;break}return this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1}),t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"submitCFDPassword",value:(a=tt(regeneratorRuntime.mark((function t(e,r){var o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.root_store.client.is_dxtrade_password_not_set){t.next=6;break}return t.next=3,this.createCFDPassword(e,r);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,this.openCFDAccount(e);case 8:if((o=t.sent).error){t.next=24;break}return r.setStatus({success:!0}),r.setSubmitting(!1),this.setError(!1),this.setCFDSuccessDialog(!0),t.next=16,this.getAccountStatus(X.CFD_PLATFORMS.DXTRADE);case 16:return t.next=18,X.WS.tradingPlatformAccountsList(e.platform);case 18:n=t.sent,this.root_store.client.responseTradingPlatformAccountsList(n),X.WS.transferBetweenAccounts(),this.setCFDNewAccount(o.trading_platform_new_account),t.next=30;break;case 24:return t.next=26,this.getAccountStatus(X.CFD_PLATFORMS.DXTRADE);case 26:this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1});case 30:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"toggleCompareAccountsModal",value:function(){this.is_compare_accounts_visible=!this.is_compare_accounts_visible}},{key:"disableMt5FinancialStpModal",value:function(){this.is_mt5_financial_stp_modal_open=!1}},{key:"topUpVirtual",value:(i=tt(regeneratorRuntime.mark((function t(e){var r,o,n,i,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.root_store.ui.setTopUpInProgress(!0),t.t0=e,t.next=t.t0===X.CFD_PLATFORMS.DXTRADE?4:t.t0===X.CFD_PLATFORMS.MT5?8:12;break;case 4:return t.next=6,X.WS.authorized.send({trading_platform_deposit:1,platform:X.CFD_PLATFORMS.DXTRADE,to_account:this.current_account.account_id});case 6:return r=t.sent,t.abrupt("break",14);case 8:return t.next=10,X.WS.authorized.mt5Deposit({to_mt5:this.current_account.login});case 10:return r=t.sent,t.abrupt("break",14);case 12:return r.error="Invalid platform",t.abrupt("break",14);case 14:if(r.error){t.next=31;break}t.t1=e,t.next=t.t1===X.CFD_PLATFORMS.DXTRADE?18:t.t1===X.CFD_PLATFORMS.MT5?22:26;break;case 18:return t.next=20,X.WS.authorized.tradingPlatformAccountsList(X.CFD_PLATFORMS.DXTRADE).then(this.root_store.client.responseTradingPlatformAccountsList);case 20:return o=null===(n=this.root_store.client.dxtrade_accounts_list.find((function(t){return t.account_id===a.current_account.account_id})))||void 0===n?void 0:n.balance,t.abrupt("break",27);case 22:return t.next=24,X.WS.authorized.mt5LoginList().then(this.root_store.client.responseMt5LoginList);case 24:return o=null===(i=this.root_store.client.mt5_login_list.find((function(t){return t.login===a.current_account.login})))||void 0===i?void 0:i.balance,t.abrupt("break",27);case 26:return t.abrupt("break",27);case 27:(0,Z.runInAction)((function(){a.root_store.ui.is_top_up_virtual_open=!1,a.current_account.balance=o})),setTimeout((function(){(0,Z.runInAction)((function(){a.root_store.ui.is_top_up_virtual_success=!0}))}),250),t.next=32;break;case 31:console.error(r);case 32:this.root_store.ui.setTopUpInProgress(!1);case 33:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"closeCFDPendingDialog",value:function(){this.is_cfd_pending_dialog_open=!1}},{key:"openPendingDialog",value:function(){var t=this;setTimeout((0,Z.runInAction)((function(){t.is_cfd_pending_dialog_open=!0})),300)}},{key:"sendVerifyEmail",value:function(){return X.WS.verifyEmail(this.root_store.client.email,"trading_platform_investor_password_reset")}},{key:"setCFDPasswordResetModal",value:function(t){this.is_cfd_reset_password_modal_enabled=!!t}}],o=[{key:"changePassword",value:(n=tt(regeneratorRuntime.mark((function t(e){var r,o,n,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.login,i=e.old_password,a=e.new_password,"investor"!==e.password_type){t.next=7;break}return t.next=4,X.WS.authorized.tradingPlatformInvestorPasswordChange({account_id:n,old_password:i,new_password:a,platform:X.CFD_PLATFORMS.MT5});case 4:s=t.sent,t.next=10;break;case 7:return t.next=9,X.WS.authorized.tradingPlatformPasswordChange({account_id:n,old_password:i,new_password:a,platform:X.CFD_PLATFORMS.MT5});case 9:s=t.sent;case 10:return t.abrupt("return",null===(r=s)||void 0===r||null===(o=r.error)||void 0===o?void 0:o.message);case 11:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})}],r&&at(e.prototype,r),o&&at(e,o),d}(J.Z),R=pt(M.prototype,"is_compare_accounts_visible",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=pt(M.prototype,"account_type",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{category:void 0,type:void 0}}}),I=pt(M.prototype,"new_account_response",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),N=pt(M.prototype,"map_type",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),U=pt(M.prototype,"has_cfd_error",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),F=pt(M.prototype,"error_message",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),B=pt(M.prototype,"is_cfd_success_dialog_enabled",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=pt(M.prototype,"is_mt5_financial_stp_modal_open",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),W=pt(M.prototype,"is_cfd_password_modal_enabled",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V=pt(M.prototype,"is_cfd_reset_password_modal_enabled",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),G=pt(M.prototype,"is_cfd_pending_dialog_open",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q=pt(M.prototype,"current_account",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),Y=pt(M.prototype,"error_type",[Z.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),pt(M.prototype,"has_cfd_account",[Z.computed],Object.getOwnPropertyDescriptor(M.prototype,"has_cfd_account"),M.prototype),pt(M.prototype,"account_title",[Z.computed],Object.getOwnPropertyDescriptor(M.prototype,"account_title"),M.prototype),pt(M.prototype,"current_list",[Z.computed],Object.getOwnPropertyDescriptor(M.prototype,"current_list"),M.prototype),pt(M.prototype,"onMount",[o],Object.getOwnPropertyDescriptor(M.prototype,"onMount"),M.prototype),pt(M.prototype,"onUnmount",[n],Object.getOwnPropertyDescriptor(M.prototype,"onUnmount"),M.prototype),pt(M.prototype,"realAccountSignupEndListener",[i],Object.getOwnPropertyDescriptor(M.prototype,"realAccountSignupEndListener"),M.prototype),pt(M.prototype,"resetFormErrors",[a],Object.getOwnPropertyDescriptor(M.prototype,"resetFormErrors"),M.prototype),pt(M.prototype,"clearCFDError",[s],Object.getOwnPropertyDescriptor(M.prototype,"clearCFDError"),M.prototype),pt(M.prototype,"createCFDAccount",[c],Object.getOwnPropertyDescriptor(M.prototype,"createCFDAccount"),M.prototype),pt(M.prototype,"disableCFDPasswordModal",[l],Object.getOwnPropertyDescriptor(M.prototype,"disableCFDPasswordModal"),M.prototype),pt(M.prototype,"enableCFDPasswordModal",[u],Object.getOwnPropertyDescriptor(M.prototype,"enableCFDPasswordModal"),M.prototype),pt(M.prototype,"getName",[p],Object.getOwnPropertyDescriptor(M.prototype,"getName"),M.prototype),pt(M.prototype,"openMT5Account",[d],Object.getOwnPropertyDescriptor(M.prototype,"openMT5Account"),M.prototype),pt(M.prototype,"openCFDAccount",[f],Object.getOwnPropertyDescriptor(M.prototype,"openCFDAccount"),M.prototype),pt(M.prototype,"beginRealSignupForMt5",[_],Object.getOwnPropertyDescriptor(M.prototype,"beginRealSignupForMt5"),M.prototype),pt(M.prototype,"enableMt5FinancialStpModal",[y],Object.getOwnPropertyDescriptor(M.prototype,"enableMt5FinancialStpModal"),M.prototype),pt(M.prototype,"setAccountType",[b],Object.getOwnPropertyDescriptor(M.prototype,"setAccountType"),M.prototype),pt(M.prototype,"setCurrentAccount",[m],Object.getOwnPropertyDescriptor(M.prototype,"setCurrentAccount"),M.prototype),pt(M.prototype,"setError",[h],Object.getOwnPropertyDescriptor(M.prototype,"setError"),M.prototype),pt(M.prototype,"setCFDNewAccount",[g],Object.getOwnPropertyDescriptor(M.prototype,"setCFDNewAccount"),M.prototype),pt(M.prototype,"setCFDSuccessDialog",[v],Object.getOwnPropertyDescriptor(M.prototype,"setCFDSuccessDialog"),M.prototype),pt(M.prototype,"storeProofOfAddress",[w],Object.getOwnPropertyDescriptor(M.prototype,"storeProofOfAddress"),M.prototype),pt(M.prototype,"getAccountStatus",[O],Object.getOwnPropertyDescriptor(M.prototype,"getAccountStatus"),M.prototype),pt(M.prototype,"creatMT5Password",[S],Object.getOwnPropertyDescriptor(M.prototype,"creatMT5Password"),M.prototype),pt(M.prototype,"submitMt5Password",[k],Object.getOwnPropertyDescriptor(M.prototype,"submitMt5Password"),M.prototype),pt(M.prototype,"createCFDPassword",[P],Object.getOwnPropertyDescriptor(M.prototype,"createCFDPassword"),M.prototype),pt(M.prototype,"submitCFDPassword",[E],Object.getOwnPropertyDescriptor(M.prototype,"submitCFDPassword"),M.prototype),pt(M.prototype,"toggleCompareAccountsModal",[C],Object.getOwnPropertyDescriptor(M.prototype,"toggleCompareAccountsModal"),M.prototype),pt(M.prototype,"disableMt5FinancialStpModal",[x],Object.getOwnPropertyDescriptor(M.prototype,"disableMt5FinancialStpModal"),M.prototype),pt(M.prototype,"topUpVirtual",[j],Object.getOwnPropertyDescriptor(M.prototype,"topUpVirtual"),M.prototype),pt(M.prototype,"closeCFDPendingDialog",[D],Object.getOwnPropertyDescriptor(M.prototype,"closeCFDPendingDialog"),M.prototype),pt(M.prototype,"openPendingDialog",[T],Object.getOwnPropertyDescriptor(M.prototype,"openPendingDialog"),M.prototype),pt(M.prototype,"sendVerifyEmail",[A],Object.getOwnPropertyDescriptor(M.prototype,"sendVerifyEmail"),M.prototype),pt(M.prototype,"setCFDPasswordResetModal",[z],Object.getOwnPropertyDescriptor(M.prototype,"setCFDPasswordResetModal"),M.prototype),M)},"./Stores/Modules/Contract/Helpers/contract-type.js":(t,e,r)=>{"use strict";r.d(e,{a:()=>o});var o=function(t){return"rise_fall"===t||"rise_fall_equal"===t||"high_low"===t}},"./Stores/Modules/Contract/Helpers/logic.js":(t,e,r)=>{"use strict";r.d(e,{f6:()=>c,aG:()=>p,xF:()=>_,FD:()=>y,$B:()=>b,z9:()=>m,NQ:()=>h,f:()=>g,W9:()=>v});var o=r("../../../node_modules/moment/moment.js"),n=r.n(o),i=r("@deriv/shared"),a=r("./_common/base/server_time.js"),s=r.n(a),c=function(t){if((0,i.isEmptyObject)(t))return null;var e=t.date_start,r=h(t),o=d(e,r||null),n=p(e,r||null);return{chart_type:t.tick_count?"mountain":n,granularity:t.tick_count?0:o,end_epoch:r,start_epoch:e,scroll_to_epoch:t.purchase_time}},l=[[1,0],[2,120],[6,600],[24,900],[120,3600],[720,14400]],u=function(t){return t||s().get().unix()},p=function(t,e){return n().duration(n().unix(u(e)).diff(n().unix(t))).asHours()<=1?"mountain":"candle"},d=function(t,e){return f(u(e)-t)},f=function(t){return(l.find((function(e){return t<=3600*e[0]}))||[null,86400])[1]},_=function(t,e){if((0,i.isEmptyObject)(e)||(0,i.isEmptyObject)(t))return!1;var r=h(t);return!(!r||!e.epoch)&&n().duration(n().unix(e.epoch).diff(n().unix(r))).asSeconds()>=2},y=function(t){return!!(t.cancellation&&h(t)<t.cancellation.date_expiry)},b=function(t){return"cancelled"===t.status},m=function(t){return!!(t.cancellation.date_expiry<s().get().unix())},h=function(t){var e=t.exit_tick_time,r=t.date_expiry,o=t.is_expired,n=t.is_path_dependent,a=t.sell_time,s=t.status,c=t.tick_count;if(o&&"open"!==s||(0,i.isUserSold)(t)||b(t))return(0,i.isUserSold)(t)?a>r?r:a:!c&&a>r||r>e&&!+n?r:e},g=function(t){return t.contract_info.buy_price},v=function(t){var e=t.contract_update,r=t.limit_order,o=(0,i.getLimitOrderAmount)(r||e),n=o.stop_loss,a=o.take_profit;return{contract_update_stop_loss:n?Math.abs(n).toString():"",contract_update_take_profit:a?a.toString():"",has_contract_update_stop_loss:!!n,has_contract_update_take_profit:!!a}}},"./Stores/Modules/Contract/Helpers/multiplier.js":(t,e,r)=>{"use strict";r.d(e,{Lf:()=>a,Qu:()=>s,tP:()=>c});var o=r("./Stores/connect.js");function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=function(t){var e=!t.has_cancellation;(0,t.onChangeMultiple)(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({has_cancellation:e},e?{has_stop_loss:!1,has_take_profit:!1}:{cancellation_price:void 0}))},s=function(t){var e=t.event;(0,t.onChangeMultiple)({has_cancellation:!0,has_take_profit:!1,has_stop_loss:!1,cancellation_duration:e.target.value})},c=(0,o.$j)((function(t,e){!function(t){if(null==t)throw new TypeError("Cannot destructure undefined")}(t);var r=e.contract,o=void 0===r?{}:r;return{validation_errors:o.validation_errors,contract_update_take_profit:o.contract_update_take_profit,contract_update_stop_loss:o.contract_update_stop_loss,has_contract_update_take_profit:o.has_contract_update_take_profit,has_contract_update_stop_loss:o.has_contract_update_stop_loss}}))},"./Stores/Modules/Portfolio/Helpers/details.js":(t,e,r)=>{"use strict";r.d(e,{uZ:()=>a,BX:()=>s,H3:()=>c,Cc:()=>l});var o=r("@deriv/shared"),n=r("@deriv/translations"),i=function(t){return t%1!=0},a=function(){return{d:{name_plural:(0,n.localize)("days"),name_singular:(0,n.localize)("day")},h:{name_plural:(0,n.localize)("hours"),name_singular:(0,n.localize)("hour")},m:{name_plural:(0,n.localize)("minutes"),name_singular:(0,n.localize)("minute")},s:{name:(0,n.localize)("seconds")}}},s=function(t){var e=a(),r=t.asMilliseconds()/1e3;if(r){if(r>=864e5)return r/864e5<=2?e.d.name_singular:e.d.name_plural;if(r>=36e5&&r<864e5)return i(r/36e5)?"":36e5===r?e.h.name_singular:e.h.name_plural;if(r>=6e4&&r<36e5)return i(r/6e4)?"":6e4===r?e.m.name_singular:e.m.name_plural;if(r>=1e3&&r<6e4)return e.s.name}return e.s.name},c=function(t){return(0,o.getDiffDuration)((0,o.epochToMoment)(t.date_start||t.purchase_time),(0,o.epochToMoment)(t.date_expiry))},l=function(t){return t.tick_count?t.tick_count:function(t){var e=t.asMilliseconds()/1e3;if(e>=864e5){var r=e/864e5;return Math.floor(r)}if(e>=36e5&&e<864e5){var n=i(e/36e5),a=i(e/6e4)?"HH[h] mm[m] ss[s]":"HH[h] mm[m]";return n?(0,o.formatMilliseconds)(e,a):Math.floor(e/36e5)}return e>=6e4&&e<36e5?i(e/6e4)?(0,o.formatMilliseconds)(e,"mm[m] ss[s]"):Math.floor(e/6e4):Math.floor(e/1e3)}(c(t))}},"./Stores/Modules/Trading/Constants/contract.js":(t,e,r)=>{"use strict";r.d(e,{jK:()=>c,r2:()=>l,GF:()=>u,f:()=>p});var o=r("@deriv/translations"),n=r("@deriv/shared");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var c=function(){return{payout:(0,o.localize)("Payout"),stake:(0,o.localize)("Stake"),multiplier:(0,o.localize)("Multiplier")}},l=function(t){return{rise_fall:{title:(0,o.localize)("Rise/Fall"),trade_types:["CALL","PUT"],basis:["stake","payout"],components:["start_date"],barrier_count:0},rise_fall_equal:{title:(0,o.localize)("Rise/Fall"),trade_types:["CALLE","PUTE"],basis:["stake","payout"],components:["start_date"],barrier_count:0},high_low:{title:(0,o.localize)("Higher/Lower"),trade_types:["CALL","PUT"],basis:["stake","payout"],components:["barrier"],barrier_count:1},touch:{title:(0,o.localize)("Touch/No Touch"),trade_types:["ONETOUCH","NOTOUCH"],basis:["stake","payout"],components:["barrier"]},end:{title:(0,o.localize)("Ends In/Ends Out"),trade_types:["EXPIRYMISS","EXPIRYRANGE"],basis:["stake","payout"],components:["barrier"]},stay:{title:(0,o.localize)("Stays In/Goes Out"),trade_types:["RANGE","UPORDOWN"],basis:["stake","payout"],components:["barrier"]},asian:{title:(0,o.localize)("Asian Up/Asian Down"),trade_types:["ASIANU","ASIAND"],basis:["stake","payout"],components:[]},match_diff:{title:(0,o.localize)("Matches/Differs"),trade_types:["DIGITMATCH","DIGITDIFF"],basis:["stake","payout"],components:["last_digit"]},even_odd:{title:(0,o.localize)("Even/Odd"),trade_types:["DIGITODD","DIGITEVEN"],basis:["stake","payout"],components:[]},over_under:{title:(0,o.localize)("Over/Under"),trade_types:["DIGITOVER","DIGITUNDER"],basis:["stake","payout"],components:["last_digit"]},lb_call:{title:(0,o.localize)("Close-to-Low"),trade_types:["LBFLOATCALL"],basis:["multiplier"],components:[]},lb_put:{title:(0,o.localize)("High-to-Close"),trade_types:["LBFLOATPUT"],basis:["multiplier"],components:[]},lb_high_low:{title:(0,o.localize)("High-to-Low"),trade_types:["LBHIGHLOW"],basis:["multiplier"],components:[]},tick_high_low:{title:(0,o.localize)("High Tick/Low Tick"),trade_types:["TICKHIGH","TICKLOW"],basis:[],components:[]},run_high_low:{title:(0,o.localize)("Only Ups/Only Downs"),trade_types:["RUNHIGH","RUNLOW"],basis:[],components:[]},reset:{title:(0,o.localize)("Reset Up/Reset Down"),trade_types:["RESETCALL","RESETPUT"],basis:[],components:[]},callputspread:{title:(0,o.localize)("Spread Up/Spread Down"),trade_types:["CALLSPREAD","PUTSPREAD"],basis:[],components:[]},multiplier:{title:(0,o.localize)("Multipliers"),trade_types:["MULTUP","MULTDOWN"],basis:["stake"],components:["take_profit","stop_loss"].concat(a((0,n.shouldShowCancellation)(t)?["cancellation"]:[]),a((0,n.shouldShowExpiration)(t)?["expiration"]:[])),config:{hide_duration:!0}}}},u=function(){var t;return i(t={},(0,o.localize)("Multipliers"),["multiplier"]),i(t,(0,o.localize)("Ups & Downs"),["rise_fall","rise_fall_equal","run_high_low","reset","asian","callputspread"]),i(t,(0,o.localize)("Highs & Lows"),["high_low","touch","tick_high_low"]),i(t,(0,o.localize)("Ins & Outs"),["end","stay"]),i(t,(0,o.localize)("Look Backs"),["lb_high_low","lb_put","lb_call"]),i(t,(0,o.localize)("Digits"),["match_diff","even_odd","over_under"]),t},p=["callputspread","run_high_low","reset","asian","tick_high_low","end","stay","lb_call","lb_put","lb_high_low"]},"./Stores/Modules/Trading/Helpers/active-symbols.js":(t,e,r)=>{"use strict";r.d(e,{c:()=>c,$p:()=>l,pp:()=>u,jt:()=>p,Uf:()=>b,rh:()=>g});var o=r("mobx"),n=r("@deriv/shared"),i=r("@deriv/translations");function a(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function s(t){a(i,o,n,s,c,"next",t)}function c(t){a(i,o,n,s,c,"throw",t)}s(void 0)}))}}var c=(0,o.flow)(regeneratorRuntime.mark((function t(e,r){var o,a,s,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.WS.wait("website_status");case 2:return o=t.sent,t.next=5,n.WS.residenceList();case 5:a=t.sent,s=o.website_status.clients_country,c=(a.residence_list.find((function(t){return t.value===s}))||{}).text,l=c?(0,i.localize)("Sorry, this app is unavailable in {{clients_country}}.",{clients_country:c}):(0,i.localize)("Sorry, this app is unavailable in your current location."),e({message:(0,i.localize)("If you have an account, log in to continue."),header:l,redirect_label:(0,i.localize)("Log in"),redirectOnClick:function(){return(0,n.redirectToLogin)(r,(0,i.getLanguage)())},should_show_refresh:!1});case 10:case"end":return t.stop()}}),t)}))),l=(0,o.flow)(regeneratorRuntime.mark((function t(e){var r,o,a,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.WS.wait("website_status");case 2:return r=t.sent,t.next=5,n.WS.residenceList();case 5:o=t.sent,a=r.website_status.clients_country,s=(o.residence_list.find((function(t){return t.value===a}))||{}).text,c=s?(0,i.localize)("Sorry, trading is unavailable in {{clients_country}}.",{clients_country:s}):(0,i.localize)("Sorry, trading is unavailable in your current location."),e({message:null,header:c,redirect_label:null,redirectOnClick:function(){return{}},should_show_refresh:!1});case 10:case"end":return t.stop()}}),t)}))),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return!!t.length&&!!t.filter((function(t){return t.symbol===e}))[0]&&!t.filter((function(t){return t.symbol===e}))[0].exchange_is_open},p=function(){var t=s(regeneratorRuntime.mark((function t(){var e,r,o,n=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=n.length>0&&void 0!==n[0]?n[0]:[]).length){t.next=3;break}return t.abrupt("return","");case 3:return t.next=5,d(e);case 5:if(!(r=t.sent)){t.next=8;break}return t.abrupt("return",r);case 8:return t.next=10,f(e);case 10:return o=t.sent,t.abrupt("return",o);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){var t=s(regeneratorRuntime.mark((function t(e){var r,o,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=n.LocalStore.get("cq-favorites")){t.next=4;break}return t.abrupt("return",void 0);case 4:if(o=JSON.parse(r)["chartTitle&Comparison"],!(i=o.map((function(t){return e.find((function(e){return e.symbol===t}))})))){t.next=14;break}if(!(a=i.filter((function(t){return t})).find(m))){t.next=14;break}return t.next=11,h(a);case 11:if(!t.sent){t.next=14;break}return t.abrupt("return",a.symbol);case 14:return t.abrupt("return",void 0);case 17:return t.prev=17,t.t0=t.catch(0),t.abrupt("return",void 0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=s(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e,"1HZ100V");case 2:if(t.t1=t.sent,t.t1){t.next=7;break}return t.next=6,y(e,/random_index/);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=12;break}return t.next=11,y(e,/major_pairs/);case 11:t.t0=t.sent;case 12:if(!(r=t.t0)){t.next=15;break}return t.abrupt("return",r.symbol);case 15:return t.abrupt("return",e.find((function(t){return"major_pairs"===t.submarket})).symbol);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_=function(){var t=s(regeneratorRuntime.mark((function t(e,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.find((function(t){return t.symbol===r&&m(t)})),t.next=3,h(o);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return",o);case 6:return t.abrupt("return",void 0);case 7:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),y=function(){var t=s(regeneratorRuntime.mark((function t(e,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.find((function(t){return r.test(t.submarket)&&m(t)})),t.next=3,h(o);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return",o);case 6:return t.abrupt("return",void 0);case 7:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),b=function(){var t=s(regeneratorRuntime.mark((function t(e,r){var o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.shift(),n=e.find((function(t){return o===t.market&&m(t)})),t.next=4,h(n);case 4:if(!t.sent){t.next=9;break}return t.abrupt("return",{category:n.market,subcategory:n.submarket});case 9:if(!(r.length>0)){t.next=11;break}return t.abrupt("return",b(e,r));case 11:return t.abrupt("return",void 0);case 12:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),m=function(t){return 1===t.exchange_is_open},h=function(){var t=s(regeneratorRuntime.mark((function t(e){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.WS.storage.contractsFor(null==e?void 0:e.symbol);case 2:return o=t.sent,t.abrupt("return",!["InvalidSymbol","InputValidationFailed"].includes(null===(r=o.error)||void 0===r?void 0:r.code));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return(t.find((function(t){return t.symbol.toUpperCase()===e.toUpperCase()}))||{display_name:""}).display_name}},"./Stores/Modules/Trading/Helpers/barrier.js":(t,e,r)=>{"use strict";function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{t:()=>n,l:()=>i});var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{count:t.barriers};if(t.barriers){var r={};return["barrier","low_barrier","high_barrier"].forEach((function(e){e in t&&(r[e]=t[e])})),Object.assign(e||{},o({},t.expiry_type,r))}},i=function(t){return Math.floor(t)===t||t.length<1||t%1==0||isNaN(t)?0:t.toString().split(".")[1].length||0}},"./Stores/Modules/Trading/Helpers/contract-type.js":(t,e,r)=>{"use strict";r.d(e,{Z:()=>J});var o,n,i,a,s,c,l,u,p,d,f,_,y,b,m,h,g,v,w,O,S,k,P,E,C,x,j,D,T=r("@deriv/shared"),A=r("./_common/base/server_time.js"),z=r.n(A),M=r("@deriv/translations"),R=r("./Stores/Modules/Portfolio/Helpers/details.js"),L=r("./Stores/Modules/Trading/Helpers/barrier.js"),I=r("./Stores/Modules/Trading/Helpers/duration.js"),N=r("./Stores/Modules/Trading/Helpers/start-date.js"),U=r("./Stores/Modules/Trading/Constants/contract.js");function F(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function B(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){F(i,o,n,a,s,"next",t)}function s(t){F(i,o,n,a,s,"throw",t)}a(void 0)}))}}function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,i=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return i}}(t,e)||V(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t){return function(t){if(Array.isArray(t))return G(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||V(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,e){if(t){if("string"==typeof t)return G(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(t,e):void 0}}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Y(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?q(Object(r),!0).forEach((function(e){Z(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}const J=(n={},i={},a={},s={},c=!1,l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[t.contract_type]=t.contract_display,e},u=function(t,e){return-1!==t.indexOf(e)?e:t[0]},p=function(t){return o&&{form_components:["duration","amount"].concat(W(o[t].components)).filter((function(e){return!("duration"===e&&o[t].config&&o[t].config.hide_duration)}))}},d=function(t,e){return{duration_units_list:(0,T.getPropertyValue)(n,[t,"config","durations","units_display",e])||[]}},f=function(t,e,r){var o=(0,T.getPropertyValue)(n,[e,"config","durations","units_display",r])||[],i=[];return o.forEach((function(t){i.push(t.value)})),{duration_unit:u(i,t)}},_=function(t,e,r){var o=(0,T.getPropertyValue)(n,[t,"config","durations","min_max",e])||{};return r&&(o=o[r]||{}),{duration_min_max:o}},y=function(t){return{contract_start_type:t===Number(0)?"spot":"forward"}},b=function(t,e){var r,o=(0,T.getPropertyValue)(n,[t,"config"]),i=[];return null!=o&&o.has_spot&&i.push({text:(0,M.localize)("Now"),value:Number(0)}),null!=o&&o.forward_starting_dates&&i.push.apply(i,W(o.forward_starting_dates)),{start_date:i.find((function(t){return t.value===e}))?e:null===(r=i[0])||void 0===r?void 0:r.value,start_dates_list:i}},m=W(Array(24).keys()).map((function(t){return"0".concat(t).slice(-2)})),h=W(Array(12).keys()).map((function(t){return"0".concat(5*t).slice(-2)})),g=function(t,e,r){return t&&!(0,N.Y)(t,e)&&(e.minute(h.find((function(r){return(0,N.Y)(t,e.minute(r))}))||e.format("mm")),(0,N.Y)(t,e)||(e.minute(0),e.hour(m.find((function(o){return(0,N.Y)(t,e.hour(o),r,!0)}))||e.format("HH")),e.minute(h.find((function(r){return(0,N.Y)(t,e.minute(r))}))||e.format("mm")))),e.format("HH:mm")},v=function(t,e){var r=H((0,T.isTimeValid)(e)?e.split(":"):[0,0],2),o=r[0],n=r[1];return(0,T.toMoment)(t||z().get()).hour(o).minute(n)},w=function(){var t=B(regeneratorRuntime.mark((function t(e){var r,o,n,i,s,c,l,u,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p.length>1&&void 0!==p[1]?p[1]:null,e){t.next=3;break}return t.abrupt("return",[]);case 3:if(e in a){t.next=8;break}return t.next=6,T.WS.tradingTimes(e);case 6:if(o=t.sent,(0,T.getPropertyValue)(o,["trading_times","markets"]))for(n=0;n<o.trading_times.markets.length;n++)if(i=o.trading_times.markets[n].submarkets)for(s=0;s<i.length;s++)if(c=i[s].symbols)for(l=0;l<c.length;l++)u=c[l],a[o.echo_req.trading_times]||(a[o.echo_req.trading_times]={}),a[o.echo_req.trading_times][u.symbol]=u.events;case 8:return t.abrupt("return",a[e][r]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=B(regeneratorRuntime.mark((function t(e){var r,o,n,i,a,c,l,u,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p.length>1&&void 0!==p[1]?p[1]:null,e){t.next=3;break}return t.abrupt("return",[]);case 3:if(e in s){t.next=8;break}return t.next=6,T.WS.tradingTimes(e);case 6:if(o=t.sent,(0,T.getPropertyValue)(o,["trading_times","markets"]))for(n=0;n<o.trading_times.markets.length;n++)if(i=o.trading_times.markets[n].submarkets)for(a=0;a<i.length;a++)if(c=i[a].symbols)for(l=0;l<c.length;l++)u=c[l],s[o.echo_req.trading_times]||(s[o.echo_req.trading_times]={}),s[o.echo_req.trading_times][u.symbol]={open:u.times.open,close:u.times.close};case 8:return t.abrupt("return",r?s[e][r]:s[e]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(t){return t.minute(5*Math.ceil(t.minute()/5))},P=function(t){return{trade_types:(0,T.getPropertyValue)(n,[t,"config","trade_types"])}},C=function(t,e){var r=(0,T.getPropertyValue)(n,[t,"basis"])||[],o=(0,U.jK)();return{basis_list:r.reduce((function(t,e){return[].concat(W(t),[{text:o[e],value:e}])}),[]),basis:u(r,e)}},x=function(t,e){var r=(0,T.getPropertyValue)(n,[t,"config","multiplier_range"])||[];return{multiplier_range_list:r.map((function(t){return{text:"x".concat(t),value:t}})),multiplier:u(r,e)}},j=function(t,e,r){var o=(0,T.getPropertyValue)(n,[t,"config","cancellation_range"])||[],i=new RegExp("^([0-9]+)|([a-zA-Z]+)$","g"),a=(0,T.shouldShowCancellation)(r);return Y({cancellation_duration:u(o,e),cancellation_range_list:o.map((function(t){return{text:"".concat((e=t,r=H(e.match(i),2),o=r[0],n=r[1],a=(0,R.uZ)(),"".concat(o," ").concat(a[n].name_plural))),value:t};var e,r,o,n,a}))},a?{}:{has_cancellation:!1})},D=function(t){var e,r=null===(e=/^(.*)_equal$/.exec(t))||void 0===e?void 0:e[1];return r&&!n[r]?{is_equal:1,has_equals_only:!0}:{}},{buildContractTypesConfig:function(t){return T.WS.storage.contractsFor(t).then((function(e){var r=(0,T.getPropertyValue)(e,["contracts_for"]);if(c=r&&!e.contracts_for.available.find((function(t){return"forward"!==t.start_type})),r&&!c){var a=(0,U.GF)();o=(0,U.r2)(t),n={},i=(0,T.cloneObject)(a),e.contracts_for.available.forEach((function(t){var e=Object.keys(o).find((function(e){return-1!==o[e].trade_types.indexOf(t.contract_type)&&(void 0===o[e].barrier_count||+o[e].barrier_count===t.barriers)}));if(e){if(!n[e]){var r=i[Object.keys(i).find((function(t){return-1!==i[t].indexOf(e)}))];if(!r)return;r[r.indexOf(e)]={value:e,text:o[e].title},n[e]=(0,T.cloneObject)(o[e])}var a=n[e].config||{};a.has_spot=a.has_spot||"spot"===t.start_type,a.durations=!a.hide_duration&&(0,I.oR)(t,a.durations),a.trade_types=l(t,a.trade_types),a.barriers=(0,L.t)(t,a.barriers),a.forward_starting_dates=(0,N.H)(t,a.forward_starting_dates),a.multiplier_range=t.multiplier_range,a.cancellation_range=t.cancellation_range,n[e].config=a}})),Object.keys(i).forEach((function(t){i[t]=i[t].filter((function(t){return"object"===X(t)})),0===i[t].length&&delete i[t]}))}}))},getBarriers:E=function(t,e){var r=(0,T.getPropertyValue)(n,[t,"config","barriers"])||{},o=r[e]||{},i=o.barrier||o.high_barrier||"",a=o.low_barrier||"";return{barrier_count:r.count||0,barrier_1:i.toString(),barrier_2:a.toString()}},getContractType:function(t,e){var r=Object.keys(t||{}).reduce((function(e,r){return[].concat(W(e),W(t[r].map((function(t){return t.value}))))}),[]).filter((function(t){return-1===U.f.indexOf(t)})).sort((function(t,e){return"multiplier"===t||"multiplier"===e?-1:0}));return{contract_type:u(r,e)}},getContractValues:function(t){var e=t.contract_expiry_type,r=t.contract_type,o=t.basis,n=t.duration_unit,i=t.expiry_type,a=t.multiplier,s=t.start_date,c=t.cancellation_duration,l=t.symbol;if(!r)return{};var u=p(r),m=C(r,o),h=P(r),g=b(r,s),v=y(g.start_date),w=E(r,e),O=f(n,r,v.contract_start_type),k=d(r,v.contract_start_type),T=_(r,v.contract_start_type),A=x(r,a),z=j(r,c,l),M=S(k,i),R=D(r);return Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y(Y({},u),m),h),g),v),w),O),k),T),M),A),z),R)},getDurationMinMax:_,getDurationUnit:f,getDurationUnitsList:d,getFullContractTypes:function(){return n},getExpiryDate:function(t,e,r,o){var n=null;if("endtime"===r){var i=(0,T.toMoment)(o),a=(0,T.toMoment)(e);n=(0,I.o5)(t)?(a.isBefore(i,"day")||o&&a.isAfter(i.clone().add(1,"day"))?i:a).format("YYYY-MM-DD"):(a.isSameOrBefore(i,"day")?i.clone().add(1,"day"):a).format("YYYY-MM-DD")}return{expiry_date:n}},getExpiryTime:function(t,e,r,o,n,i,a){var s=null;if("endtime"===r){var c="23:59:59";if(o&&o.length&&"--"!==o[0]&&(c=o.slice(-1)[0]),!i&&z().get().isBefore(v(t),"day"))s=c;else{var l=i?v(i,a):z().get(),u=v(t,e);s=u.format("HH:mm");var p=[{open:l.clone().add(5,"minute"),close:(0,T.minDate)(l.clone().add(24,"hour"),v(t,c))}];if((0,N.Y)(p,u)||(s=g(p,u.clone(),l.clone())),u.isSameOrBefore(l)||u.diff(l,"minute")<5){var d=23===l.get("hours")&&l.get("minute")>=55,f=n&&!(0,N.Y)(n,l.clone().add(5,"minutes"));s=l.clone().add(d||f?0:5,"minutes"),s=k(s).format("HH:mm")}"00:00"===s&&l.isBefore(u,"day")&&(s=l.clone().subtract(5,"minute").format("HH:mm"))}}return{expiry_time:s}},getExpiryType:S=function(t,e){if(t){if(!e&&t.length>0||1===t.length&&"t"===t[0].value)return{expiry_type:"duration"};if(0===t.length)return{expiry_type:null}}return{expiry_type:e}},getSessions:function(t,e){return{sessions:((((0,T.getPropertyValue)(n,[t,"config"])||{}).forward_starting_dates||[]).find((function(t){return t.value===e}))||{}).sessions}},getStartTime:function(t,e,r){return{start_time:e?g(t,v(e,r)):null}},getStartType:y,getTradingEvents:w,getTradingTimes:O,getContractCategories:function(){return{contract_types_list:i,has_only_forward_starting_contracts:c}}})},"./Stores/Modules/Trading/Helpers/duration.js":(t,e,r)=>{"use strict";r.d(e,{oR:()=>c,QJ:()=>p,ln:()=>d,o5:()=>f,I7:()=>_,P7:()=>y});var o=r("@deriv/translations"),n=r("@deriv/shared");function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var s=function(){return{t:{display:(0,o.localize)("Ticks"),order:1},s:{display:(0,o.localize)("Seconds"),order:2,to_second:1},m:{display:(0,o.localize)("Minutes"),order:3,to_second:60},h:{display:(0,o.localize)("Hours"),order:4,to_second:3600},d:{display:(0,o.localize)("Days"),order:5,to_second:86400}}},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{min_max:{},units_display:{}};e.min_max[t.start_type]=e.min_max[t.start_type]||{},e.units_display[t.start_type]=e.units_display[t.start_type]||[];var r=u(t.min_contract_duration),o=u(t.max_contract_duration);e.min_max[t.start_type][t.expiry_type]={min:l(r.duration,r.unit,"s"),max:l(o.duration,o.unit,"s")};var n=[];e.units_display[t.start_type].forEach((function(t){n.push(t.value)}));var a=s();return/^tick|daily$/.test(t.expiry_type)?-1===n.indexOf(r.unit)&&n.push(r.unit):Object.keys(a).forEach((function(t){"d"!==t&&-1===n.indexOf(t)&&a[t].order>=a[r.unit].order&&a[t].order<=a[o.unit].order&&n.push(t)})),e.units_display[t.start_type]=n.sort((function(t,e){return a[t].order>a[e].order?1:-1})).reduce((function(t,e){return[].concat(i(t),[{text:a[e].display,value:e}])}),[]),e},l=function(t,e,r){if(!t||!e||!r||isNaN(parseInt(t)))return null;var o=s();return e!==r&&"to_second"in o[e]?t*o[e].to_second/o[r].to_second:t},u=function(t){var e=t.toString().match(/[a-zA-Z]+|[0-9]+/g);return{duration:+e[0],unit:e[1]}},p=function(t){var e=t.duration_unit,r=t.expiry_date,o=t.expiry_type,i=t.duration_units_list,a=t.root_store.common.server_time,s="duration"===o&&"d"===e,c="endtime"===o&&((0,n.toMoment)(r).isAfter((0,n.toMoment)(a),"day")||!f(i)),l="daily";return s||c||(l="t"===e?"tick":"intraday"),l},d=function(t,e){if(!(t>=0&&e&&Number.isInteger(t)))return null;if("m"===e){var r=t/60;return r>=1?Math.floor(r):1}if("h"===e){var o=t/3600;return o>=1?Math.floor(o):1}if("d"===e){var n=t/86400;return n>=1?Math.floor(n):1}return t},f=function(t){return t.some((function(t){return-1!==["m","h"].indexOf(t.value)}))},_=function(t,e){return/^R_/.test(t)&&"endtime"===e?(0,n.toMoment)(null).format("DD MMM YYYY"):null},y=function(t,e,r){if(!t[e])return[];var o=d(+t[e].max,r);return[d(+t[e].min,r),o]}},"./Stores/Modules/Trading/Helpers/proposal.js":(t,e,r)=>{"use strict";r.d(e,{yr:()=>c,_N:()=>l,RX:()=>u});var o=r("@deriv/shared");function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s={barrier:"barrier_1",barrier2:"barrier_2",date_expiry:"expiry_date"},c=function(t){var e=(0,o.getPropertyValue)(t,["error","details","field"]);if(!e)return null;var r,n=s[e]||e,i=document.getElementsByName(n)[0];return i&&(r=i)&&(0!==r.offsetWidth||0!==r.offsetHeight)?n:null},l=function(t,e,r){var n,i,a,s=e.proposal||{},l=s.payout-s.ask_price||0,u=100*l/(s.ask_price||1),p=s.display_value,d=t.basis_list.find((function(e){return e.value!==t.basis}))||{},f="Stake"===d.text?p:s[d.value],_=f>r.value;r.value&&f!==r.value||(_=null);var y={text:d.text||"",value:f||""};return{commission:s.commission,cancellation:s.cancellation,id:s.id||"",has_error:!!e.error,has_error_details:!!c(e),error_code:null==e||null===(n=e.error)||void 0===n?void 0:n.code,error_field:null==e||null===(i=e.error)||void 0===i||null===(a=i.details)||void 0===a?void 0:a.field,has_increased:_,limit_order:s.limit_order,message:s.longcode||e.error.message,obj_contract_basis:y,payout:s.payout,profit:l.toFixed((0,o.getDecimalPlaces)(t.currency)),returns:"".concat(u.toFixed(2),"%"),stake:p}},u=function(t){var e={};return Object.keys(t.trade_types).forEach((function(r){var o=p(t,r);e[r]=o})),e},p=function(t,e){var r={},n={};if("endtime"===t.expiry_type){var a=(0,o.toMoment)(t.expiry_date);r.date_expiry=(0,o.convertToUnix)(a.unix(),t.expiry_time)}return"multiplier"===t.contract_type&&function(t,e){e.multiplier=t.multiplier,e.cancellation=t.has_cancellation?t.cancellation_duration:void 0,e.limit_order=t.has_take_profit||t.has_stop_loss?{}:void 0,t.has_take_profit&&t.take_profit&&(e.limit_order.take_profit=+t.take_profit||0),t.has_stop_loss&&t.stop_loss&&(e.limit_order.stop_loss=+t.stop_loss||0)}(t,n),i(i(i(i(i({proposal:1,subscribe:1,amount:parseFloat(t.amount)||0,basis:t.basis,contract_type:e,currency:t.currency,symbol:t.symbol},t.start_date&&{date_start:(0,o.convertToUnix)(t.start_date,t.start_time)}),"duration"===t.expiry_type?{duration:parseInt(t.duration),duration_unit:t.duration_unit}:r),(t.barrier_count>0||-1!==t.form_components.indexOf("last_digit"))&&{barrier:t.barrier_1||t.last_digit}),2===t.barrier_count&&{barrier2:t.barrier_2}),n)}},"./Stores/Modules/Trading/Helpers/start-date.js":(t,e,r)=>{"use strict";r.d(e,{H:()=>a,Y:()=>c});var o=r("./_common/base/server_time.js"),n=r.n(o),i=r("@deriv/shared"),a=function(t,e){var r=[];return(t.forward_starting_options||[]).length&&t.forward_starting_options.forEach((function(t){var e=r.find((function(e){return e.value===parseInt(t.date)})),o={open:(0,i.toMoment)(t.open),close:(0,i.toMoment)(t.close)};e?e.sessions.push(o):r.push({text:(0,i.toMoment)(t.date).format("ddd - DD MMM, YYYY"),value:parseInt(t.date),sessions:[o]})})),r.length?r:e},s=function(t,e,r){var o=(0,i.toMoment)(e);return r&&o.minute(0).second(0),t.isBefore(o)&&o.unix()!==t.unix()},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,i.toMoment)(n().get()),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,i.toMoment)(n().get()),o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!(s(e,n().get(),o)||s(e,r,o)||t.length&&!t.find((function(t){return e.isBetween(t.open,t.close,o?"hour":null,"[]")})))}},"./Stores/base-store.js":(t,e,r)=>{"use strict";r.d(e,{Z:()=>H});var o=r("mobx"),n=r("@deriv/shared"),i=r("./_common/utility.js");function a(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}const s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errors={}}var e,r;return e=t,(r=[{key:"add",value:function(t,e){this.has(t)||(this.errors[t]=[]),-1===this.errors[t].indexOf(e)&&this.errors[t].push(e)}},{key:"all",value:function(){return this.errors}},{key:"first",value:function(t){return this.has(t)?this.errors[t][0]:null}},{key:"get",value:function(t){return this.has(t)?this.errors[t]:[]}},{key:"has",value:function(t){return Object.prototype.hasOwnProperty.call(this.errors,t)}}])&&a(e.prototype,r),t}();function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}const u=function(){function t(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c(this,t),this.input=e,this.rules=r,this.store=o,this.errors=new s,this.error_count=0}var e,r,o;return e=t,o=[{key:"getRuleObject",value:function(t){var e="string"==typeof t,r={name:e?t:t[0],options:e?{}:t[1]||{}};return r.validator="custom"===r.name?t[1].func:(0,n.getPreBuildDVRs)()[r.name].func,r}}],(r=[{key:"addFailure",value:function(t,e,r){var o=r||e.options.message||(0,n.getPreBuildDVRs)()[e.name].message();"length"===e.name?o=(0,i.template)(o,[e.options.min===e.options.max?e.options.min:"".concat(e.options.min,"-").concat(e.options.max)]):"min"===e.name?o=(0,i.template)(o,[e.options.min]):"not_equal"===e.name&&(o=(0,i.template)(o,[e.options.name1,e.options.name2])),this.errors.add(t,o),this.error_count++}},{key:"check",value:function(){var e=this;return Object.keys(this.input).forEach((function(r){Object.prototype.hasOwnProperty.call(e.rules,r)&&e.rules[r].forEach((function(o){var n=t.getRuleObject(o);if((n.validator||"function"==typeof n.validator)&&(!n.options.condition||n.options.condition(e.store))&&(""!==e.input[r]||"req"===n.name)){var i,a;if("number"===n.name){var s=n.validator(e.input[r],n.options,e.store,e.input);i=s.is_ok,a=s.message}else i=n.validator(e.input[r],n.options,e.store,e.input);i||e.addFailure(r,n,a)}}))})),!this.error_count}},{key:"isPassed",value:function(){return this.check()}}])&&l(e.prototype,r),o&&l(e,o),t}();var p,d,f,_,y,b,m,h,g,v,w,O,S,k,P,E,C,x,j,D,T,A;function z(t,e,r,o,n,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(o,n)}function M(t){return function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function a(t){z(i,o,n,a,s,"next",t)}function s(t){z(i,o,n,a,s,"throw",t)}a(void 0)}))}}function R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R(Object(r),!0).forEach((function(e){I(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function I(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N(t,e,r,o){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function B(t,e,r,o,n){var i={};return Object.keys(o).forEach((function(t){i[t]=o[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(t,e,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var H=(p=o.action.bound,d=o.action.bound,f=o.action.bound,_=o.action.bound,y=o.action.bound,b=o.action.bound,m=o.action.bound,h=o.action.bound,g=o.action.bound,v=o.action.bound,w=o.action.bound,O=o.action.bound,S=o.action.bound,k=o.action.bound,P=o.action.bound,E=o.action.bound,A=T=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};U(this,t),N(this,"validation_errors",x,this),N(this,"validation_rules",j,this),this.preSwitchAccountDisposer=null,this.pre_switch_account_listener=null,this.switchAccountDisposer=null,this.switch_account_listener=null,this.logoutDisposer=null,this.logout_listener=null,this.clientInitDisposer=null,this.client_init_listener=null,this.networkStatusChangeDisposer=null,this.network_status_change_listener=null,this.themeChangeDisposer=null,this.theme_change_listener=null,this.realAccountSignupEndedDisposer=null,this.real_account_signup_ended_listener=null,N(this,"partial_fetch_time",D,this);var r=e.root_store,o=e.local_storage_properties,n=e.session_storage_properties,i=e.validation_rules,a=e.store_name;Object.defineProperty(this,"root_store",{enumerable:!1,writable:!0}),Object.defineProperty(this,"local_storage_properties",{enumerable:!1,writable:!0}),Object.defineProperty(this,"session_storage_properties",{enumerable:!1,writable:!0});var s=o&&o.length||n&&n.length;if(s){if(!a)throw new Error("store_name is required for local/session storage");Object.defineProperty(this,"store_name",{value:a,enumerable:!1,writable:!1})}this.root_store=r,this.local_storage_properties=o||[],this.session_storage_properties=n||[],this.setValidationRules(i),this.setupReactionForLocalStorage(),this.setupReactionForSessionStorage(),this.retrieveFromStorage()}var e,r;return e=t,r=[{key:"getSnapshot",value:function(t){var e=(0,o.toJS)(this);return(0,n.isEmptyObject)(this.root_store)||(e.root_store=this.root_store),t&&t.length&&(e=t.reduce((function(t,r){return Object.assign(t,I({},r,e[r]))}),{})),e}},{key:"setupReactionForLocalStorage",value:function(){var e=this;this.local_storage_properties.length&&(0,o.reaction)((function(){return e.local_storage_properties.map((function(t){return e[t]}))}),(function(){return e.saveToStorage(e.local_storage_properties,t.STORAGES.LOCAL_STORAGE)}))}},{key:"setupReactionForSessionStorage",value:function(){var e=this;this.session_storage_properties.length&&(0,o.reaction)((function(){return e.session_storage_properties.map((function(t){return e[t]}))}),(function(){return e.saveToStorage(e.session_storage_properties,t.STORAGES.SESSION_STORAGE)}))}},{key:"saveToStorage",value:function(e,r){var o=JSON.stringify(this.getSnapshot(e),(function(t,e){if(null!==e)return e}));r===t.STORAGES.LOCAL_STORAGE?localStorage.setItem(this.store_name,o):r===t.STORAGES.SESSION_STORAGE&&sessionStorage.setItem(this.store_name,o)}},{key:"retrieveFromStorage",value:function(){var t=this,e=JSON.parse(localStorage.getItem(this.store_name,{})),r=JSON.parse(sessionStorage.getItem(this.store_name,{})),o=L(L({},e),r);Object.keys(o).forEach((function(e){return t[e]=o[e]}))}},{key:"setValidationErrorMessages",value:function(t,e){var r=this;this.validation_errors[t]&&!r.validation_errors[t].filter((function(t){return!e.includes(t)})).concat(e.filter((function(e){return!r.validation_errors[t].includes(e)}))).length||(this.validation_errors[t]=e)}},{key:"setValidationRules",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(r){t.addRule(r,e[r])}))}},{key:"addRule",value:function(t,e){var r=this;this.validation_rules[t]=e,(0,o.intercept)(this,t,(function(e){return r.validateProperty(t,e.newValue),e}))}},{key:"validateProperty",value:function(t,e){var r=this,o=this.validation_rules[t].trigger,n=I({},t,void 0!==e?e:this[t]),i=I({},t,this.validation_rules[t].rules||[]);o&&Object.hasOwnProperty.call(this,o)&&(n[o]=this[o],i[o]=this.validation_rules[o].rules||[]);var a=new u(n,i,this);a.isPassed(),Object.keys(n).forEach((function(t){r.setValidationErrorMessages(t,a.errors.get(t))}))}},{key:"validateAllProperties",value:function(){var t=this,e=Object.keys(this.validation_rules),r=Object.keys(this.validation_errors);e.forEach((function(e){t.validateProperty(e,t[e])})),r.forEach((function(r){e.includes(r)||delete t.validation_errors[r]}))}},{key:"onSwitchAccount",value:function(t){var e=this;t&&(this.switch_account_listener=t,this.switchAccountDisposer=(0,o.when)((function(){return e.root_store.client.switch_broadcast}),(function(){try{var t=e.switch_account_listener();if(!t||!t.then||"function"!=typeof t.then)throw new Error("Switching account listeners are required to return a promise.");t.then((function(){e.root_store.client.switchEndSignal(),e.onSwitchAccount(e.switch_account_listener)}))}catch(t){(0,n.isProduction)()||console.error(t)}})))}},{key:"onPreSwitchAccount",value:function(t){var e=this;t&&(this.pre_switch_account_listener=t,this.preSwitchAccountDisposer=(0,o.when)((function(){return e.root_store.client.pre_switch_broadcast}),(function(){try{var t=e.pre_switch_account_listener();if(!t||!t.then||"function"!=typeof t.then)throw new Error("Pre-switch account listeners are required to return a promise.");t.then((function(){e.root_store.client.setPreSwitchAccount(!1),e.onPreSwitchAccount(e.pre_switch_account_listener)}))}catch(t){(0,n.isProduction)()||console.error(t)}})))}},{key:"onLogout",value:function(t){var e=this;this.logoutDisposer=(0,o.when)((function(){return e.root_store.client.has_logged_out}),M(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(r=e.logout_listener())||!r.then||"function"!=typeof r.then){t.next=6;break}r.then((function(){e.root_store.client.setLogout(!1),e.onLogout(e.logout_listener)})),t.next=7;break;case 6:throw new Error("Logout listeners are required to return a promise.");case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,n.isProduction)()||console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),this.logout_listener=t}},{key:"onClientInit",value:function(t){var e=this;this.clientInitDisposer=(0,o.when)((function(){return e.root_store.client.initialized_broadcast}),M(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(r=e.client_init_listener())||!r.then||"function"!=typeof r.then){t.next=6;break}r.then((function(){e.root_store.client.setInitialized(!1),e.onClientInit(e.client_init_listener)})),t.next=7;break;case 6:throw new Error("Client init listeners are required to return a promise.");case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,n.isProduction)()||console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),this.client_init_listener=t}},{key:"onNetworkStatusChange",value:function(t){var e=this;this.networkStatusChangeDisposer=(0,o.reaction)((function(){return e.root_store.common.is_network_online}),(function(t){try{e.network_status_change_listener(t)}catch(t){(0,n.isProduction)()||console.error(t)}})),this.network_status_change_listener=t}},{key:"onThemeChange",value:function(t){var e=this;this.themeChangeDisposer=(0,o.reaction)((function(){return e.root_store.ui.is_dark_mode_on}),(function(t){try{e.theme_change_listener(t)}catch(t){(0,n.isProduction)()||console.error(t)}})),this.theme_change_listener=t}},{key:"onRealAccountSignupEnd",value:function(t){var e=this;this.realAccountSignupEndedDisposer=(0,o.when)((function(){return e.root_store.ui.has_real_account_signup_ended}),(function(){try{var t=e.real_account_signup_ended_listener();if(!t||!t.then||"function"!=typeof t.then)throw new Error("Real account signup listeners are required to return a promise.");t.then((function(){e.root_store.ui.setRealAccountSignupEnd(!1),e.onRealAccountSignupEnd(e.real_account_signup_ended_listener)}))}catch(t){(0,n.isProduction)()||console.error(t)}})),this.real_account_signup_ended_listener=t}},{key:"disposePreSwitchAccount",value:function(){"function"==typeof this.preSwitchAccountDisposer&&this.preSwitchAccountDisposer(),this.pre_switch_account_listener=null}},{key:"disposeSwitchAccount",value:function(){"function"==typeof this.switchAccountDisposer&&this.switchAccountDisposer(),this.switch_account_listener=null}},{key:"disposeLogout",value:function(){"function"==typeof this.logoutDisposer&&this.logoutDisposer(),this.logout_listener=null}},{key:"disposeClientInit",value:function(){"function"==typeof this.clientInitDisposer&&this.clientInitDisposer(),this.client_init_listener=null}},{key:"disposeNetworkStatusChange",value:function(){"function"==typeof this.networkStatusChangeDisposer&&this.networkStatusChangeDisposer(),this.network_status_change_listener=null}},{key:"disposeThemeChange",value:function(){"function"==typeof this.themeChangeDisposer&&this.themeChangeDisposer(),this.theme_change_listener=null}},{key:"disposeRealAccountSignupEnd",value:function(){"function"==typeof this.realAccountSignupEndedDisposer&&this.realAccountSignupEndedDisposer(),this.real_account_signup_ended_listener=null}},{key:"onUnmount",value:function(){this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout(),this.disposeClientInit(),this.disposeNetworkStatusChange(),this.disposeThemeChange(),this.disposeRealAccountSignupEnd()}},{key:"assertHasValidCache",value:function(t){if(this.root_store.client.loginid!==t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];r.forEach((function(t){return t()})),this.partial_fetch_time=!1}}}],r&&F(e.prototype,r),t}(),T.STORAGES=Object.freeze({LOCAL_STORAGE:Symbol("LOCAL_STORAGE"),SESSION_STORAGE:Symbol("SESSION_STORAGE")}),x=B((C=A).prototype,"validation_errors",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),j=B(C.prototype,"validation_rules",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),D=B(C.prototype,"partial_fetch_time",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),B(C.prototype,"retrieveFromStorage",[o.action],Object.getOwnPropertyDescriptor(C.prototype,"retrieveFromStorage"),C.prototype),B(C.prototype,"setValidationErrorMessages",[o.action],Object.getOwnPropertyDescriptor(C.prototype,"setValidationErrorMessages"),C.prototype),B(C.prototype,"setValidationRules",[o.action],Object.getOwnPropertyDescriptor(C.prototype,"setValidationRules"),C.prototype),B(C.prototype,"addRule",[o.action],Object.getOwnPropertyDescriptor(C.prototype,"addRule"),C.prototype),B(C.prototype,"validateProperty",[o.action],Object.getOwnPropertyDescriptor(C.prototype,"validateProperty"),C.prototype),B(C.prototype,"validateAllProperties",[o.action],Object.getOwnPropertyDescriptor(C.prototype,"validateAllProperties"),C.prototype),B(C.prototype,"onSwitchAccount",[p],Object.getOwnPropertyDescriptor(C.prototype,"onSwitchAccount"),C.prototype),B(C.prototype,"onPreSwitchAccount",[d],Object.getOwnPropertyDescriptor(C.prototype,"onPreSwitchAccount"),C.prototype),B(C.prototype,"onLogout",[f],Object.getOwnPropertyDescriptor(C.prototype,"onLogout"),C.prototype),B(C.prototype,"onClientInit",[_],Object.getOwnPropertyDescriptor(C.prototype,"onClientInit"),C.prototype),B(C.prototype,"onNetworkStatusChange",[y],Object.getOwnPropertyDescriptor(C.prototype,"onNetworkStatusChange"),C.prototype),B(C.prototype,"onThemeChange",[b],Object.getOwnPropertyDescriptor(C.prototype,"onThemeChange"),C.prototype),B(C.prototype,"onRealAccountSignupEnd",[m],Object.getOwnPropertyDescriptor(C.prototype,"onRealAccountSignupEnd"),C.prototype),B(C.prototype,"disposePreSwitchAccount",[h],Object.getOwnPropertyDescriptor(C.prototype,"disposePreSwitchAccount"),C.prototype),B(C.prototype,"disposeSwitchAccount",[g],Object.getOwnPropertyDescriptor(C.prototype,"disposeSwitchAccount"),C.prototype),B(C.prototype,"disposeLogout",[v],Object.getOwnPropertyDescriptor(C.prototype,"disposeLogout"),C.prototype),B(C.prototype,"disposeClientInit",[w],Object.getOwnPropertyDescriptor(C.prototype,"disposeClientInit"),C.prototype),B(C.prototype,"disposeNetworkStatusChange",[O],Object.getOwnPropertyDescriptor(C.prototype,"disposeNetworkStatusChange"),C.prototype),B(C.prototype,"disposeThemeChange",[S],Object.getOwnPropertyDescriptor(C.prototype,"disposeThemeChange"),C.prototype),B(C.prototype,"disposeRealAccountSignupEnd",[k],Object.getOwnPropertyDescriptor(C.prototype,"disposeRealAccountSignupEnd"),C.prototype),B(C.prototype,"onUnmount",[P],Object.getOwnPropertyDescriptor(C.prototype,"onUnmount"),C.prototype),B(C.prototype,"assertHasValidCache",[E],Object.getOwnPropertyDescriptor(C.prototype,"assertHasValidCache"),C.prototype),C)},"./Stores/connect.js":(t,e,r)=>{"use strict";r.d(e,{z1:()=>l,$j:()=>u});var o=r("mobx-react"),n=r("react");function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=n.createContext(null),l=function(t){var e=t.store,r=t.children;return n.createElement(c.Provider,{value:a(a({},e),{},{mobxStores:e})},r)},u=function(t){return function(e){return function(t,e){var r=function(r){var i=n.useContext(c),s=e;return function(t){return!("function"!=typeof t||!t.prototype||!t.prototype.isReactComponent)}(e)&&(s=function(t){return n.createElement(e,t)}),(0,o.useObserver)((function(){return s(a(a({},r),t(i,r)))}))};return r.displayName=e.name,r}(t,e)}}},"./_common/base/server_time.js":(t,e,r)=>{var o,n,i,a=r("./_common/utility.js").PromiseClass,s=(n=!1,i=new a,{init:function(t){n||(o=t,i.resolve(o.server_time),n=!0)},get:function(){return n&&o.server_time?o.server_time.clone():void 0},timePromise:function(){return n?Promise.resolve(o.server_time):i.promise}});t.exports=s},"./_common/utility.js":t=>{var e;t.exports={template:function(t,e){var r=e;return e&&!Array.isArray(e)&&(r=[e]),t.replace(/\[_(\d+)]/g,(function(t,e){return r[+e-1]}))},createElement:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement(t);return Object.keys(e).forEach((function(t){var o=e[t];"text"===t?r.textContent=o:"html"===t?r.html(o):r.setAttribute(t,o)})),r},getStaticHash:function(){return e=e||(document.querySelector('script[src*="main"]').getAttribute("src")||"").split(".")[1]},PromiseClass:function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.promise=new Promise((function(t,r){e.reject=r,e.resolve=t}))}}}}]);